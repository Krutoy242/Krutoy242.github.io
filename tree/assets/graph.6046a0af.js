import{S as mt,r as Tt,d as ct,t as At,i as zt,T as rt,a as ot,b as It,u as St,s as Dt,c as Et,o as Ct,w as $t,e as pt,f as Lt,g as jt,h as yt,j as Bt,_ as Rt,k as ut}from"./index.e7ebed76.js";import{_ as bt}from"./ItemDetailed.8000222f.js";import"./GearedNumber.05ad4a58.js";function Y(t){return typeof t=="string"?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],Tt)}function Pt(t){let e;for(;e=t.sourceEvent;)t=e;return t}function W(t,e){if(t=Pt(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var h=e.getBoundingClientRect();return[t.clientX-h.left-e.clientLeft,t.clientY-h.top-e.clientTop]}}return[t.pageX,t.pageY]}const Gt={passive:!1},tt={capture:!0,passive:!1};function at(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function Mt(t){var e=t.document.documentElement,n=Y(t).on("dragstart.drag",q,tt);"onselectstart"in e?n.on("selectstart.drag",q,tt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function kt(t,e){var n=t.document.documentElement,r=Y(t).on("dragstart.drag",null);e&&(r.on("click.drag",q,tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const et=t=>()=>t;function ht(t,{sourceEvent:e,subject:n,target:r,identifier:h,active:u,x:c,y:a,dx:d,dy:f,dispatch:v}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:h,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:v}})}ht.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Xt(t){return!t.ctrlKey&&!t.button}function Vt(){return this.parentNode}function Yt(t,e){return e==null?{x:t.x,y:t.y}:e}function Ut(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ot(){var t=Xt,e=Vt,n=Yt,r=Ut,h={},u=ct("start","drag","end"),c=0,a,d,f,v,N=0;function x(o){o.on("mousedown.drag",y).filter(r).on("touchstart.drag",m).on("touchmove.drag",s,Gt).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(o,z){if(!(v||!t.call(this,o,z))){var T=_(this,e.call(this,o,z),o,z,"mouse");!T||(Y(o.view).on("mousemove.drag",k,tt).on("mouseup.drag",p,tt),Mt(o.view),at(o),f=!1,a=o.clientX,d=o.clientY,T("start",o))}}function k(o){if(q(o),!f){var z=o.clientX-a,T=o.clientY-d;f=z*z+T*T>N}h.mouse("drag",o)}function p(o){Y(o.view).on("mousemove.drag mouseup.drag",null),kt(o.view,f),q(o),h.mouse("end",o)}function m(o,z){if(!!t.call(this,o,z)){var T=o.changedTouches,I=e.call(this,o,z),E=T.length,$,C;for($=0;$<E;++$)(C=_(this,I,o,z,T[$].identifier,T[$]))&&(at(o),C("start",o,T[$]))}}function s(o){var z=o.changedTouches,T=z.length,I,E;for(I=0;I<T;++I)(E=h[z[I].identifier])&&(q(o),E("drag",o,z[I]))}function w(o){var z=o.changedTouches,T=z.length,I,E;for(v&&clearTimeout(v),v=setTimeout(function(){v=null},500),I=0;I<T;++I)(E=h[z[I].identifier])&&(at(o),E("end",o,z[I]))}function _(o,z,T,I,E,$){var C=u.copy(),j=W($||T,z),P,R,i;if((i=n.call(o,new ht("beforestart",{sourceEvent:T,target:x,identifier:E,active:c,x:j[0],y:j[1],dx:0,dy:0,dispatch:C}),I))!=null)return P=i.x-j[0]||0,R=i.y-j[1]||0,function g(l,M,A){var S=j,D;switch(l){case"start":h[E]=g,D=c++;break;case"end":delete h[E],--c;case"drag":j=W(A||M,z),D=c;break}C.call(l,o,new ht(l,{sourceEvent:M,subject:i,target:x,identifier:E,active:D,x:j[0]+P,y:j[1]+R,dx:j[0]-S[0],dy:j[1]-S[1],dispatch:C}),I)}}return x.filter=function(o){return arguments.length?(t=typeof o=="function"?o:et(!!o),x):t},x.container=function(o){return arguments.length?(e=typeof o=="function"?o:et(o),x):e},x.subject=function(o){return arguments.length?(n=typeof o=="function"?o:et(o),x):n},x.touchable=function(o){return arguments.length?(r=typeof o=="function"?o:et(!!o),x):r},x.on=function(){var o=u.on.apply(u,arguments);return o===u?x:o},x.clickDistance=function(o){return arguments.length?(N=(o=+o)*o,x):Math.sqrt(N)},x}var Ft=1e-12;function dt(t){return((t=Math.exp(t))+1/t)/2}function Kt(t){return((t=Math.exp(t))-1/t)/2}function Qt(t){return((t=Math.exp(2*t))-1)/(t+1)}const Ht=function t(e,n,r){function h(u,c){var a=u[0],d=u[1],f=u[2],v=c[0],N=c[1],x=c[2],y=v-a,k=N-d,p=y*y+k*k,m,s;if(p<Ft)s=Math.log(x/f)/e,m=function(I){return[a+I*y,d+I*k,f*Math.exp(e*I*s)]};else{var w=Math.sqrt(p),_=(x*x-f*f+r*p)/(2*f*n*w),o=(x*x-f*f-r*p)/(2*x*n*w),z=Math.log(Math.sqrt(_*_+1)-_),T=Math.log(Math.sqrt(o*o+1)-o);s=(T-z)/e,m=function(I){var E=I*s,$=dt(z),C=f/(n*w)*($*Qt(e*E+z)-Kt(z));return[a+C*y,d+C*k,f*$/dt(e*E+z)]}}return m.duration=s*1e3*e/Math.SQRT2,m}return h.rho=function(u){var c=Math.max(.001,+u),a=c*c,d=a*a;return t(c,a,d)},h}(Math.SQRT2,2,4);function Wt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Nt(this.cover(e,n),e,n,t)}function Nt(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var h,u=t._root,c={data:r},a=t._x0,d=t._y0,f=t._x1,v=t._y1,N,x,y,k,p,m,s,w;if(!u)return t._root=c,t;for(;u.length;)if((p=e>=(N=(a+f)/2))?a=N:f=N,(m=n>=(x=(d+v)/2))?d=x:v=x,h=u,!(u=u[s=m<<1|p]))return h[s]=c,t;if(y=+t._x.call(null,u.data),k=+t._y.call(null,u.data),e===y&&n===k)return c.next=u,h?h[s]=c:t._root=c,t;do h=h?h[s]=new Array(4):t._root=new Array(4),(p=e>=(N=(a+f)/2))?a=N:f=N,(m=n>=(x=(d+v)/2))?d=x:v=x;while((s=m<<1|p)===(w=(k>=x)<<1|y>=N));return h[w]=u,h[s]=c,t}function Zt(t){var e,n,r=t.length,h,u,c=new Array(r),a=new Array(r),d=1/0,f=1/0,v=-1/0,N=-1/0;for(n=0;n<r;++n)isNaN(h=+this._x.call(null,e=t[n]))||isNaN(u=+this._y.call(null,e))||(c[n]=h,a[n]=u,h<d&&(d=h),h>v&&(v=h),u<f&&(f=u),u>N&&(N=u));if(d>v||f>N)return this;for(this.cover(d,f).cover(v,N),n=0;n<r;++n)Nt(this,c[n],a[n],t[n]);return this}function qt(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,h=this._x1,u=this._y1;if(isNaN(n))h=(n=Math.floor(t))+1,u=(r=Math.floor(e))+1;else{for(var c=h-n||1,a=this._root,d,f;n>t||t>=h||r>e||e>=u;)switch(f=(e<r)<<1|t<n,d=new Array(4),d[f]=a,a=d,c*=2,f){case 0:h=n+c,u=r+c;break;case 1:n=h-c,u=r+c;break;case 2:h=n+c,r=u-c;break;case 3:n=h-c,r=u-c;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=h,this._y1=u,this}function Jt(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function te(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function G(t,e,n,r,h){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=h}function ee(t,e,n){var r,h=this._x0,u=this._y0,c,a,d,f,v=this._x1,N=this._y1,x=[],y=this._root,k,p;for(y&&x.push(new G(y,h,u,v,N)),n==null?n=1/0:(h=t-n,u=e-n,v=t+n,N=e+n,n*=n);k=x.pop();)if(!(!(y=k.node)||(c=k.x0)>v||(a=k.y0)>N||(d=k.x1)<h||(f=k.y1)<u))if(y.length){var m=(c+d)/2,s=(a+f)/2;x.push(new G(y[3],m,s,d,f),new G(y[2],c,s,m,f),new G(y[1],m,a,d,s),new G(y[0],c,a,m,s)),(p=(e>=s)<<1|t>=m)&&(k=x[x.length-1],x[x.length-1]=x[x.length-1-p],x[x.length-1-p]=k)}else{var w=t-+this._x.call(null,y.data),_=e-+this._y.call(null,y.data),o=w*w+_*_;if(o<n){var z=Math.sqrt(n=o);h=t-z,u=e-z,v=t+z,N=e+z,r=y.data}}return r}function ne(t){if(isNaN(v=+this._x.call(null,t))||isNaN(N=+this._y.call(null,t)))return this;var e,n=this._root,r,h,u,c=this._x0,a=this._y0,d=this._x1,f=this._y1,v,N,x,y,k,p,m,s;if(!n)return this;if(n.length)for(;;){if((k=v>=(x=(c+d)/2))?c=x:d=x,(p=N>=(y=(a+f)/2))?a=y:f=y,e=n,!(n=n[m=p<<1|k]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,s=m)}for(;n.data!==t;)if(h=n,!(n=n.next))return this;return(u=n.next)&&delete n.next,h?(u?h.next=u:delete h.next,this):e?(u?e[m]=u:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[s]=n:this._root=n),this):(this._root=u,this)}function ie(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function re(){return this._root}function oe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ue(t){var e=[],n,r=this._root,h,u,c,a,d;for(r&&e.push(new G(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,u=n.x0,c=n.y0,a=n.x1,d=n.y1)&&r.length){var f=(u+a)/2,v=(c+d)/2;(h=r[3])&&e.push(new G(h,f,v,a,d)),(h=r[2])&&e.push(new G(h,u,v,f,d)),(h=r[1])&&e.push(new G(h,f,c,a,v)),(h=r[0])&&e.push(new G(h,u,c,f,v))}return this}function ae(t){var e=[],n=[],r;for(this._root&&e.push(new G(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var h=r.node;if(h.length){var u,c=r.x0,a=r.y0,d=r.x1,f=r.y1,v=(c+d)/2,N=(a+f)/2;(u=h[0])&&e.push(new G(u,c,a,v,N)),(u=h[1])&&e.push(new G(u,v,a,d,N)),(u=h[2])&&e.push(new G(u,c,N,v,f)),(u=h[3])&&e.push(new G(u,v,N,d,f))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function se(t){return t[0]}function he(t){return arguments.length?(this._x=t,this):this._x}function ce(t){return t[1]}function le(t){return arguments.length?(this._y=t,this):this._y}function lt(t,e,n){var r=new ft(e==null?se:e,n==null?ce:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ft(t,e,n,r,h,u){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=h,this._y1=u,this._root=void 0}function vt(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var V=lt.prototype=ft.prototype;V.copy=function(){var t=new ft(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=vt(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var h=0;h<4;++h)(r=e.source[h])&&(r.length?n.push({source:r,target:e.target[h]=new Array(4)}):e.target[h]=vt(r));return t};V.add=Wt;V.addAll=Zt;V.cover=qt;V.data=Jt;V.extent=te;V.find=ee;V.remove=ne;V.removeAll=ie;V.root=re;V.size=oe;V.visit=ue;V.visitAfter=ae;V.x=he;V.y=le;function X(t){return function(){return t}}function Z(t){return(t()-.5)*1e-6}function fe(t){return t.x+t.vx}function ge(t){return t.y+t.vy}function me(t){var e,n,r,h=1,u=1;typeof t!="function"&&(t=X(t==null?1:+t));function c(){for(var f,v=e.length,N,x,y,k,p,m,s=0;s<u;++s)for(N=lt(e,fe,ge).visitAfter(a),f=0;f<v;++f)x=e[f],p=n[x.index],m=p*p,y=x.x+x.vx,k=x.y+x.vy,N.visit(w);function w(_,o,z,T,I){var E=_.data,$=_.r,C=p+$;if(E){if(E.index>x.index){var j=y-E.x-E.vx,P=k-E.y-E.vy,R=j*j+P*P;R<C*C&&(j===0&&(j=Z(r),R+=j*j),P===0&&(P=Z(r),R+=P*P),R=(C-(R=Math.sqrt(R)))/R*h,x.vx+=(j*=R)*(C=($*=$)/(m+$)),x.vy+=(P*=R)*C,E.vx-=j*(C=1-C),E.vy-=P*C)}return}return o>y+C||T<y-C||z>k+C||I<k-C}}function a(f){if(f.data)return f.r=n[f.data.index];for(var v=f.r=0;v<4;++v)f[v]&&f[v].r>f.r&&(f.r=f[v].r)}function d(){if(!!e){var f,v=e.length,N;for(n=new Array(v),f=0;f<v;++f)N=e[f],n[N.index]=+t(N,f,e)}}return c.initialize=function(f,v){e=f,r=v,d()},c.iterations=function(f){return arguments.length?(u=+f,c):u},c.strength=function(f){return arguments.length?(h=+f,c):h},c.radius=function(f){return arguments.length?(t=typeof f=="function"?f:X(+f),d(),c):t},c}function pe(t){return t.index}function xt(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function ye(t){var e=pe,n=N,r,h=X(30),u,c,a,d,f,v=1;t==null&&(t=[]);function N(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function x(m){for(var s=0,w=t.length;s<v;++s)for(var _=0,o,z,T,I,E,$,C;_<w;++_)o=t[_],z=o.source,T=o.target,I=T.x+T.vx-z.x-z.vx||Z(f),E=T.y+T.vy-z.y-z.vy||Z(f),$=Math.sqrt(I*I+E*E),$=($-u[_])/$*m*r[_],I*=$,E*=$,T.vx-=I*(C=d[_]),T.vy-=E*C,z.vx+=I*(C=1-C),z.vy+=E*C}function y(){if(!!c){var m,s=c.length,w=t.length,_=new Map(c.map((z,T)=>[e(z,T,c),z])),o;for(m=0,a=new Array(s);m<w;++m)o=t[m],o.index=m,typeof o.source!="object"&&(o.source=xt(_,o.source)),typeof o.target!="object"&&(o.target=xt(_,o.target)),a[o.source.index]=(a[o.source.index]||0)+1,a[o.target.index]=(a[o.target.index]||0)+1;for(m=0,d=new Array(w);m<w;++m)o=t[m],d[m]=a[o.source.index]/(a[o.source.index]+a[o.target.index]);r=new Array(w),k(),u=new Array(w),p()}}function k(){if(!!c)for(var m=0,s=t.length;m<s;++m)r[m]=+n(t[m],m,t)}function p(){if(!!c)for(var m=0,s=t.length;m<s;++m)u[m]=+h(t[m],m,t)}return x.initialize=function(m,s){c=m,f=s,y()},x.links=function(m){return arguments.length?(t=m,y(),x):t},x.id=function(m){return arguments.length?(e=m,x):e},x.iterations=function(m){return arguments.length?(v=+m,x):v},x.strength=function(m){return arguments.length?(n=typeof m=="function"?m:X(+m),k(),x):n},x.distance=function(m){return arguments.length?(h=typeof m=="function"?m:X(+m),p(),x):h},x}const de=1664525,ve=1013904223,_t=4294967296;function xe(){let t=1;return()=>(t=(de*t+ve)%_t)/_t}function _e(t){return t.x}function we(t){return t.y}var ze=10,Me=Math.PI*(3-Math.sqrt(5));function ke(t){var e,n=1,r=.001,h=1-Math.pow(r,1/300),u=0,c=.6,a=new Map,d=At(N),f=ct("tick","end"),v=xe();t==null&&(t=[]);function N(){x(),f.call("tick",e),n<r&&(d.stop(),f.call("end",e))}function x(p){var m,s=t.length,w;p===void 0&&(p=1);for(var _=0;_<p;++_)for(n+=(u-n)*h,a.forEach(function(o){o(n)}),m=0;m<s;++m)w=t[m],w.fx==null?w.x+=w.vx*=c:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=c:(w.y=w.fy,w.vy=0);return e}function y(){for(var p=0,m=t.length,s;p<m;++p){if(s=t[p],s.index=p,s.fx!=null&&(s.x=s.fx),s.fy!=null&&(s.y=s.fy),isNaN(s.x)||isNaN(s.y)){var w=ze*Math.sqrt(.5+p),_=p*Me;s.x=w*Math.cos(_),s.y=w*Math.sin(_)}(isNaN(s.vx)||isNaN(s.vy))&&(s.vx=s.vy=0)}}function k(p){return p.initialize&&p.initialize(t,v),p}return y(),e={tick:x,restart:function(){return d.restart(N),e},stop:function(){return d.stop(),e},nodes:function(p){return arguments.length?(t=p,y(),a.forEach(k),e):t},alpha:function(p){return arguments.length?(n=+p,e):n},alphaMin:function(p){return arguments.length?(r=+p,e):r},alphaDecay:function(p){return arguments.length?(h=+p,e):+h},alphaTarget:function(p){return arguments.length?(u=+p,e):u},velocityDecay:function(p){return arguments.length?(c=1-p,e):1-c},randomSource:function(p){return arguments.length?(v=p,a.forEach(k),e):v},force:function(p,m){return arguments.length>1?(m==null?a.delete(p):a.set(p,k(m)),e):a.get(p)},find:function(p,m,s){var w=0,_=t.length,o,z,T,I,E;for(s==null?s=1/0:s*=s,w=0;w<_;++w)I=t[w],o=p-I.x,z=m-I.y,T=o*o+z*z,T<s&&(E=I,s=T);return E},on:function(p,m){return arguments.length>1?(f.on(p,m),e):f.on(p)}}}function Ne(){var t,e,n,r,h=X(-30),u,c=1,a=1/0,d=.81;function f(y){var k,p=t.length,m=lt(t,_e,we).visitAfter(N);for(r=y,k=0;k<p;++k)e=t[k],m.visit(x)}function v(){if(!!t){var y,k=t.length,p;for(u=new Array(k),y=0;y<k;++y)p=t[y],u[p.index]=+h(p,y,t)}}function N(y){var k=0,p,m,s=0,w,_,o;if(y.length){for(w=_=o=0;o<4;++o)(p=y[o])&&(m=Math.abs(p.value))&&(k+=p.value,s+=m,w+=m*p.x,_+=m*p.y);y.x=w/s,y.y=_/s}else{p=y,p.x=p.data.x,p.y=p.data.y;do k+=u[p.data.index];while(p=p.next)}y.value=k}function x(y,k,p,m){if(!y.value)return!0;var s=y.x-e.x,w=y.y-e.y,_=m-k,o=s*s+w*w;if(_*_/d<o)return o<a&&(s===0&&(s=Z(n),o+=s*s),w===0&&(w=Z(n),o+=w*w),o<c&&(o=Math.sqrt(c*o)),e.vx+=s*y.value*r/o,e.vy+=w*y.value*r/o),!0;if(y.length||o>=a)return;(y.data!==e||y.next)&&(s===0&&(s=Z(n),o+=s*s),w===0&&(w=Z(n),o+=w*w),o<c&&(o=Math.sqrt(c*o)));do y.data!==e&&(_=u[y.data.index]*r/o,e.vx+=s*_,e.vy+=w*_);while(y=y.next)}return f.initialize=function(y,k){t=y,n=k,v()},f.strength=function(y){return arguments.length?(h=typeof y=="function"?y:X(+y),v(),f):h},f.distanceMin=function(y){return arguments.length?(c=y*y,f):Math.sqrt(c)},f.distanceMax=function(y){return arguments.length?(a=y*y,f):Math.sqrt(a)},f.theta=function(y){return arguments.length?(d=y*y,f):Math.sqrt(d)},f}function Te(t){var e=X(.1),n,r,h;typeof t!="function"&&(t=X(t==null?0:+t));function u(a){for(var d=0,f=n.length,v;d<f;++d)v=n[d],v.vx+=(h[d]-v.x)*r[d]*a}function c(){if(!!n){var a,d=n.length;for(r=new Array(d),h=new Array(d),a=0;a<d;++a)r[a]=isNaN(h[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,c()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:X(+a),c(),u):e},u.x=function(a){return arguments.length?(t=typeof a=="function"?a:X(+a),c(),u):t},u}function Ae(t){var e=X(.1),n,r,h;typeof t!="function"&&(t=X(t==null?0:+t));function u(a){for(var d=0,f=n.length,v;d<f;++d)v=n[d],v.vy+=(h[d]-v.y)*r[d]*a}function c(){if(!!n){var a,d=n.length;for(r=new Array(d),h=new Array(d),a=0;a<d;++a)r[a]=isNaN(h[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,c()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:X(+a),c(),u):e},u.y=function(a){return arguments.length?(t=typeof a=="function"?a:X(+a),c(),u):t},u}const nt=t=>()=>t;function Ie(t,{sourceEvent:e,target:n,transform:r,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:h}})}function st(t){t.stopImmediatePropagation()}function J(t){t.preventDefault(),t.stopImmediatePropagation()}function Se(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function De(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function wt(){return this.__zoom||zt}function Ee(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ce(){return navigator.maxTouchPoints||"ontouchstart"in this}function $e(t,e,n){var r=t.invertX(e[0][0])-n[0][0],h=t.invertX(e[1][0])-n[1][0],u=t.invertY(e[0][1])-n[0][1],c=t.invertY(e[1][1])-n[1][1];return t.translate(h>r?(r+h)/2:Math.min(0,r)||Math.max(0,h),c>u?(u+c)/2:Math.min(0,u)||Math.max(0,c))}function Le(){var t=Se,e=De,n=$e,r=Ee,h=Ce,u=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],a=250,d=Ht,f=ct("start","zoom","end"),v,N,x,y=500,k=150,p=0,m=10;function s(i){i.property("__zoom",wt).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",C).filter(h).on("touchstart.zoom",j).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}s.transform=function(i,g,l,M){var A=i.selection?i.selection():i;A.property("__zoom",wt),i!==A?z(i,g,l,M):A.interrupt().each(function(){T(this,arguments).event(M).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},s.scaleBy=function(i,g,l,M){s.scaleTo(i,function(){var A=this.__zoom.k,S=typeof g=="function"?g.apply(this,arguments):g;return A*S},l,M)},s.scaleTo=function(i,g,l,M){s.transform(i,function(){var A=e.apply(this,arguments),S=this.__zoom,D=l==null?o(A):typeof l=="function"?l.apply(this,arguments):l,L=S.invert(D),B=typeof g=="function"?g.apply(this,arguments):g;return n(_(w(S,B),D,L),A,c)},l,M)},s.translateBy=function(i,g,l,M){s.transform(i,function(){return n(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof l=="function"?l.apply(this,arguments):l),e.apply(this,arguments),c)},null,M)},s.translateTo=function(i,g,l,M,A){s.transform(i,function(){var S=e.apply(this,arguments),D=this.__zoom,L=M==null?o(S):typeof M=="function"?M.apply(this,arguments):M;return n(zt.translate(L[0],L[1]).scale(D.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof l=="function"?-l.apply(this,arguments):-l),S,c)},M,A)};function w(i,g){return g=Math.max(u[0],Math.min(u[1],g)),g===i.k?i:new rt(g,i.x,i.y)}function _(i,g,l){var M=g[0]-l[0]*i.k,A=g[1]-l[1]*i.k;return M===i.x&&A===i.y?i:new rt(i.k,M,A)}function o(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function z(i,g,l,M){i.on("start.zoom",function(){T(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(M).end()}).tween("zoom",function(){var A=this,S=arguments,D=T(A,S).event(M),L=e.apply(A,S),B=l==null?o(L):typeof l=="function"?l.apply(A,S):l,F=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),b=A.__zoom,U=typeof g=="function"?g.apply(A,S):g,Q=d(b.invert(B).concat(F/b.k),U.invert(B).concat(F/U.k));return function(O){if(O===1)O=U;else{var H=Q(O),it=F/H[2];O=new rt(it,B[0]-H[0]*it,B[1]-H[1]*it)}D.zoom(null,O)}})}function T(i,g,l){return!l&&i.__zooming||new I(i,g)}function I(i,g){this.that=i,this.args=g,this.active=0,this.sourceEvent=null,this.extent=e.apply(i,g),this.taps=0}I.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,g){return this.mouse&&i!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var g=Y(this.that).datum();f.call(i,this.that,new Ie(i,{sourceEvent:this.sourceEvent,target:s,type:i,transform:this.that.__zoom,dispatch:f}),g)}};function E(i,...g){if(!t.apply(this,arguments))return;var l=T(this,g).event(i),M=this.__zoom,A=Math.max(u[0],Math.min(u[1],M.k*Math.pow(2,r.apply(this,arguments)))),S=W(i);if(l.wheel)(l.mouse[0][0]!==S[0]||l.mouse[0][1]!==S[1])&&(l.mouse[1]=M.invert(l.mouse[0]=S)),clearTimeout(l.wheel);else{if(M.k===A)return;l.mouse=[S,M.invert(S)],ot(this),l.start()}J(i),l.wheel=setTimeout(D,k),l.zoom("mouse",n(_(w(M,A),l.mouse[0],l.mouse[1]),l.extent,c));function D(){l.wheel=null,l.end()}}function $(i,...g){if(x||!t.apply(this,arguments))return;var l=i.currentTarget,M=T(this,g,!0).event(i),A=Y(i.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",F,!0),S=W(i,l),D=i.clientX,L=i.clientY;Mt(i.view),st(i),M.mouse=[S,this.__zoom.invert(S)],ot(this),M.start();function B(b){if(J(b),!M.moved){var U=b.clientX-D,Q=b.clientY-L;M.moved=U*U+Q*Q>p}M.event(b).zoom("mouse",n(_(M.that.__zoom,M.mouse[0]=W(b,l),M.mouse[1]),M.extent,c))}function F(b){A.on("mousemove.zoom mouseup.zoom",null),kt(b.view,M.moved),J(b),M.event(b).end()}}function C(i,...g){if(!!t.apply(this,arguments)){var l=this.__zoom,M=W(i.changedTouches?i.changedTouches[0]:i,this),A=l.invert(M),S=l.k*(i.shiftKey?.5:2),D=n(_(w(l,S),M,A),e.apply(this,g),c);J(i),a>0?Y(this).transition().duration(a).call(z,D,M,i):Y(this).call(s.transform,D,M,i)}}function j(i,...g){if(!!t.apply(this,arguments)){var l=i.touches,M=l.length,A=T(this,g,i.changedTouches.length===M).event(i),S,D,L,B;for(st(i),D=0;D<M;++D)L=l[D],B=W(L,this),B=[B,this.__zoom.invert(B),L.identifier],A.touch0?!A.touch1&&A.touch0[2]!==B[2]&&(A.touch1=B,A.taps=0):(A.touch0=B,S=!0,A.taps=1+!!v);v&&(v=clearTimeout(v)),S&&(A.taps<2&&(N=B[0],v=setTimeout(function(){v=null},y)),ot(this),A.start())}}function P(i,...g){if(!!this.__zooming){var l=T(this,g).event(i),M=i.changedTouches,A=M.length,S,D,L,B;for(J(i),S=0;S<A;++S)D=M[S],L=W(D,this),l.touch0&&l.touch0[2]===D.identifier?l.touch0[0]=L:l.touch1&&l.touch1[2]===D.identifier&&(l.touch1[0]=L);if(D=l.that.__zoom,l.touch1){var F=l.touch0[0],b=l.touch0[1],U=l.touch1[0],Q=l.touch1[1],O=(O=U[0]-F[0])*O+(O=U[1]-F[1])*O,H=(H=Q[0]-b[0])*H+(H=Q[1]-b[1])*H;D=w(D,Math.sqrt(O/H)),L=[(F[0]+U[0])/2,(F[1]+U[1])/2],B=[(b[0]+Q[0])/2,(b[1]+Q[1])/2]}else if(l.touch0)L=l.touch0[0],B=l.touch0[1];else return;l.zoom("touch",n(_(D,L,B),l.extent,c))}}function R(i,...g){if(!!this.__zooming){var l=T(this,g).event(i),M=i.changedTouches,A=M.length,S,D;for(st(i),x&&clearTimeout(x),x=setTimeout(function(){x=null},y),S=0;S<A;++S)D=M[S],l.touch0&&l.touch0[2]===D.identifier?delete l.touch0:l.touch1&&l.touch1[2]===D.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),l.taps===2&&(D=W(D,this),Math.hypot(N[0]-D[0],N[1]-D[1])<m)){var L=Y(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return s.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:nt(+i),s):r},s.filter=function(i){return arguments.length?(t=typeof i=="function"?i:nt(!!i),s):t},s.touchable=function(i){return arguments.length?(h=typeof i=="function"?i:nt(!!i),s):h},s.extent=function(i){return arguments.length?(e=typeof i=="function"?i:nt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),s):e},s.scaleExtent=function(i){return arguments.length?(u[0]=+i[0],u[1]=+i[1],s):[u[0],u[1]]},s.translateExtent=function(i){return arguments.length?(c[0][0]=+i[0][0],c[1][0]=+i[1][0],c[0][1]=+i[0][1],c[1][1]=+i[1][1],s):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},s.constrain=function(i){return arguments.length?(n=i,s):n},s.duration=function(i){return arguments.length?(a=+i,s):a},s.interpolate=function(i){return arguments.length?(d=i,s):d},s.on=function(){var i=f.on.apply(f,arguments);return i===f?s:i},s.clickDistance=function(i){return arguments.length?(p=(i=+i)*i,s):Math.sqrt(p)},s.tapDistance=function(i){return arguments.length?(m=+i,s):m},s}class gt{constructor(e,n,r){this.linkContainer=e,this.stylesCallbacks=n,this.currDeph=0,this.outputIndex=0,this.all=[],this.instant=!0,this.init(r)}ticked(){this.sel.attr("x1",e=>{var n,r;return(r=(n=e.source)==null?void 0:n.x)!=null?r:0}).attr("y1",e=>{var n,r;return(r=(n=e.source)==null?void 0:n.y)!=null?r:0}).attr("x2",e=>{var n,r;return(r=(n=e.target)==null?void 0:n.x)!=null?r:0}).attr("y2",e=>{var n,r;return(r=(n=e.target)==null?void 0:n.y)!=null?r:0})}mouseover(e){this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.highlite(e)}mouseout(){this.reset()}init(e){this.sel=this.linkContainer.attr("stroke","#555").attr("stroke-width",1).selectAll("line").data(e).join("line"),this.createBackRefs()}createBackRefs(){this.sel.each(function(e){e.d3node=Y(this)})}highlite(e){this.reset(),this.all=[...new Set([...e.mainInputs,...e.mainOutputs])],this.outputIndex=e.mainInputs.size,this.instant?this.all.forEach(n=>this.styleSingle(n)):(this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.timeoutID=setInterval(this.nextStep,5))}reset(){this.currDeph=0,clearInterval(this.timeoutID)}nextStep(){var n;const e=(n=this.all)==null?void 0:n[this.currDeph];if(!e){clearInterval(this.timeoutID);return}this.styleSingle(e)}styleSingle(e){const n=Number(this.currDeph>=this.outputIndex),r=this.stylesCallbacks[["inputLink","outputLink"][n]];r(e,this.currDeph),this.currDeph++}}class je extends gt{constructor(...e){super(...e),this.init([])}mouseover(e){this.init([...e.mainInputs,...e.mainOutputs]),this.highlite(e)}mouseout(){}}class Be extends gt{ticked(){this.sel.attr("d",e=>{var r,h,u,c;const n=Math.hypot((h=e.target.x)!=null?h:0-((r=e.source.x)!=null?r:0),(c=e.target.y)!=null?c:0-((u=e.source.y)!=null?u:0));return`
        M${e.source.x},${e.source.y}
        A${n},${n} 0 0,1 ${e.target.x},${e.target.y}
        `})}init(e){this.sel=this.linkContainer.attr("fill","none").selectAll("path").data(e).join("path").attr("stroke-width",1).attr("stroke","#555"),this.createBackRefs()}}function Re(t,e,n){var C,j,P,R;e.selectAll("*").remove();const r=e.append("g"),h=t,u=20,c=Math.floor(h.length/9),a=c-u,d=(j=(C=e.node())==null?void 0:C.getBoundingClientRect().width)!=null?j:400,f=(R=(P=e.node())==null?void 0:P.getBoundingClientRect().height)!=null?R:200,v=i=>{const g=t.map(A=>A[i]),l=Math.min(...g),M=Math.max(1,...g);return A=>(A-l)/M},N=v("complexity"),x=v("usability"),y=i=>i**.5,k=i=>y(y(i)),p=i=>y(N(i.complexity)),m=i=>y(x(i.usability)),s=i=>d/2+p(i)*a*20-m(i)*a*20,w=i=>{const g=(p(i)+m(i))/2*c+u,l=Math.max(u,Math.min(c,g));return isNaN(l)?10:l},_=r.append("g").selectAll("g").data(h).join(o,z);function o(i){return z(i.append("g").style("cursor",g=>g.isGhost?null:"pointer").attr("opacity",g=>g.isGhost?.1:null).call(g=>g.append("circle")).call(g=>g.append("image")))}function z(i){return i.select("circle").attr("r",w).attr("stroke-width",g=>m(g)*10+1).attr("stroke",g=>g.popularity>0?"#f90":"#fff").attr("fill",g=>g.inputsAmount===0?"rgba(67, 113, 165, 0.3)":g.outputsAmount===0?"rgba(0, 145, 7, 0.4)":"#111"),i.select("image").attr("x",g=>-w(g)*.9).attr("y",g=>-w(g)*.9).attr("height",g=>w(g)*2*.9).attr("width",g=>w(g)*2*.9).attr("xlink:href",g=>g.href).attr("image-rendering","pixelated"),i}_.each(function(i){i.d3node=Y(this)});const T=Le().scaleExtent([.01,10]).on("zoom",i=>{var g;r.attr("transform",i.transform),(g=n.zoom)==null||g.call(n,i)});e.call(T),_.on("click",(i,g)=>{var l;(l=n.click)==null||l.call(n,g,!1)}).on("contextmenu",(i,g)=>{var l;i.preventDefault(),(l=n.click)==null||l.call(n,g,!0)}).on("mouseover",(i,g)=>{var l;(l=n.mouseover)==null||l.call(n,g,i)}).on("mouseout",(i,g)=>{var l;return(l=n.mouseout)==null?void 0:l.call(n,g,i)}).call(Ot().on("start",I).on("drag",E).on("end",$));function I(i,g){var l;i.sourceEvent.stopPropagation(),i.active||(l=n.dragstarted)==null||l.call(n,g,i),g.fx=g.x,g.fy=g.y}function E(i,g){var l,M;(l=n.isGhost)!=null&&l.call(n,g,i)||((M=n.dragged)==null||M.call(n,g,i),g.fx=i.x,g.fy=i.y)}function $(i,g){var l;i.active||(l=n.dragended)==null||l.call(n,g,i),g.fx=null,g.fy=null}return{container:r,nodes:_,fNonlinear:y,fComp:p,fUsab:m,fX:s,fStroke:k,fSize:w,vizWidth:d,vizHeight:f,diffSize:a}}let K;function be(t,e,n={}){let r;const h={...n,dragstarted(_){var o;K==null||K.alphaTarget(.3).restart(),(o=n.dragstarted)==null||o.call(n,_)},dragended(_){var o;K==null||K.alphaTarget(0),(o=n.dragended)==null||o.call(n,_)},mouseover(_){var o;r.mouseover(_),r.ticked(),(o=n.mouseover)==null||o.call(n,_)},mouseout(_){var o;r.mouseout(),r.ticked(),(o=n.mouseout)==null||o.call(n,_)}},u=Re(e,t,h),{fX:c,fSize:a,fUsab:d,vizHeight:f,diffSize:v,fStroke:N}=u,x=u.container.insert("g",":first-child").attr("class","linksLayer");K==null||K.on("tick",null).stop();const y={showLinks:e.length<500,showCurvedLinks:e.length<100,useReuse:e.length>500},k=[];for(const _ of e)for(const o of _.mainInputs)k.push(o);K=ke(e).force("charge",Ne().strength(-2e3)).force("x",Te(c).strength(1)).force("y",Ae(f/2).strength(_=>d(_)+1)).force("collision",me().radius(a).strength(.75)).force("link",ye(k).distance(v/2).strength(1)).on("tick",w);function p(_,o,z){var T;(T=_.d3node)==null||T.attr("stroke-width",N(z)*3/(o+1)+1)}const m={defaultLink:_=>{var o;(o=_.d3node)==null||o.attr("stroke-width",1).attr("stroke","#555")},inputLink:(_,o)=>{var z;p(_,o,_.weight),(z=_.d3node)==null||z.attr("stroke","#7f7")},outputLink:(_,o)=>{var z;p(_,o,1/_.weight),(z=_.d3node)==null||z.attr("stroke","#38f")}},s=y.showLinks?y.showCurvedLinks?Be:gt:je;r=new s(x,m,k);function w(){r==null||r.ticked(),u.nodes.attr("transform",_=>`translate(${_.x},${_.y})`)}w()}const Pe={class:"relative"},Ge={key:0,class:"fixed"},Xe=Bt("svg",{id:"viz",class:"w-full h-full"},null,-1),Oe=It({__name:"graph",setup(t){const e=St(),{pickedItems:n}=Dt(e);let r=Et();Ct(h),$t(n,h);function h(){!n.value||be(Y("#viz"),n.value,{mouseover:u=>r.value=u,click:u=>e.pileTo(u)})}return(u,c)=>{var f,v;const a=bt,d=Rt;return ut(),pt("div",Pe,[r.value?(ut(),pt("div",Ge,[Lt(a,{item:r.value},null,8,["item"]),(f=r.value)!=null&&f.mainRecipe?(ut(),jt(d,{key:0,recipes:[(v=r.value)==null?void 0:v.mainRecipe]},null,8,["recipes"])):yt("",!0)])):yt("",!0),Xe])}}});export{Oe as default};
