var Ct=Object.defineProperty,$t=Object.defineProperties;var Lt=Object.getOwnPropertyDescriptors;var mt=Object.getOwnPropertySymbols;var Bt=Object.prototype.hasOwnProperty,Rt=Object.prototype.propertyIsEnumerable;var pt=(t,n,e)=>n in t?Ct(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,yt=(t,n)=>{for(var e in n||(n={}))Bt.call(n,e)&&pt(t,e,n[e]);if(mt)for(var e of mt(n))Rt.call(n,e)&&pt(t,e,n[e]);return t},dt=(t,n)=>$t(t,Lt(n));import{d as jt,u as bt,s as Pt,a as Gt,o as Xt,w as Vt,c as vt,b as Yt,e as Ot,f as xt,g as Ut,_ as Ft,h as rt}from"./index.a689f99f.js";import{S as wt,r as Ht,d as ct,t as Kt,T as ot,i as Tt,a as ut,_ as Qt}from"./transform.bed17a9c.js";import"./Item.409687a9.js";function Y(t){return typeof t=="string"?new wt([[document.querySelector(t)]],[document.documentElement]):new wt([[t]],Ht)}function Wt(t){let n;for(;n=t.sourceEvent;)t=n;return t}function W(t,n){if(t=Wt(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}if(n.getBoundingClientRect){var s=n.getBoundingClientRect();return[t.clientX-s.left-n.clientLeft,t.clientY-s.top-n.clientTop]}}return[t.pageX,t.pageY]}const Zt={passive:!1},tt={capture:!0,passive:!1};function at(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function At(t){var n=t.document.documentElement,e=Y(t).on("dragstart.drag",q,tt);"onselectstart"in n?e.on("selectstart.drag",q,tt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function It(t,n){var e=t.document.documentElement,r=Y(t).on("dragstart.drag",null);n&&(r.on("click.drag",q,tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}var et=t=>()=>t;function ht(t,{sourceEvent:n,subject:e,target:r,identifier:s,active:a,x:h,y:o,dx:v,dy:f,dispatch:w}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:e,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:v,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:w}})}ht.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function qt(t){return!t.ctrlKey&&!t.button}function Jt(){return this.parentNode}function te(t,n){return n==null?{x:t.x,y:t.y}:n}function ee(){return navigator.maxTouchPoints||"ontouchstart"in this}function ne(){var t=qt,n=Jt,e=te,r=ee,s={},a=ct("start","drag","end"),h=0,o,v,f,w,N=0;function x(u){u.on("mousedown.drag",d).filter(r).on("touchstart.drag",m).on("touchmove.drag",c,Zt).on("touchend.drag touchcancel.drag",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(u,k){if(!(w||!t.call(this,u,k))){var T=_(this,n.call(this,u,k),u,k,"mouse");!T||(Y(u.view).on("mousemove.drag",M,tt).on("mouseup.drag",y,tt),At(u.view),at(u),f=!1,o=u.clientX,v=u.clientY,T("start",u))}}function M(u){if(q(u),!f){var k=u.clientX-o,T=u.clientY-v;f=k*k+T*T>N}s.mouse("drag",u)}function y(u){Y(u.view).on("mousemove.drag mouseup.drag",null),It(u.view,f),q(u),s.mouse("end",u)}function m(u,k){if(!!t.call(this,u,k)){var T=u.changedTouches,I=n.call(this,u,k),E=T.length,$,C;for($=0;$<E;++$)(C=_(this,I,u,k,T[$].identifier,T[$]))&&(at(u),C("start",u,T[$]))}}function c(u){var k=u.changedTouches,T=k.length,I,E;for(I=0;I<T;++I)(E=s[k[I].identifier])&&(q(u),E("drag",u,k[I]))}function p(u){var k=u.changedTouches,T=k.length,I,E;for(w&&clearTimeout(w),w=setTimeout(function(){w=null},500),I=0;I<T;++I)(E=s[k[I].identifier])&&(at(u),E("end",u,k[I]))}function _(u,k,T,I,E,$){var C=a.copy(),B=W($||T,k),P,j,i;if((i=e.call(u,new ht("beforestart",{sourceEvent:T,target:x,identifier:E,active:h,x:B[0],y:B[1],dx:0,dy:0,dispatch:C}),I))!=null)return P=i.x-B[0]||0,j=i.y-B[1]||0,function g(l,z,A){var S=B,D;switch(l){case"start":s[E]=g,D=h++;break;case"end":delete s[E],--h;case"drag":B=W(A||z,k),D=h;break}C.call(l,u,new ht(l,{sourceEvent:z,subject:i,target:x,identifier:E,active:D,x:B[0]+P,y:B[1]+j,dx:B[0]-S[0],dy:B[1]-S[1],dispatch:C}),I)}}return x.filter=function(u){return arguments.length?(t=typeof u=="function"?u:et(!!u),x):t},x.container=function(u){return arguments.length?(n=typeof u=="function"?u:et(u),x):n},x.subject=function(u){return arguments.length?(e=typeof u=="function"?u:et(u),x):e},x.touchable=function(u){return arguments.length?(r=typeof u=="function"?u:et(!!u),x):r},x.on=function(){var u=a.on.apply(a,arguments);return u===a?x:u},x.clickDistance=function(u){return arguments.length?(N=(u=+u)*u,x):Math.sqrt(N)},x}var ie=1e-12;function _t(t){return((t=Math.exp(t))+1/t)/2}function re(t){return((t=Math.exp(t))-1/t)/2}function oe(t){return((t=Math.exp(2*t))-1)/(t+1)}var ue=function t(n,e,r){function s(a,h){var o=a[0],v=a[1],f=a[2],w=h[0],N=h[1],x=h[2],d=w-o,M=N-v,y=d*d+M*M,m,c;if(y<ie)c=Math.log(x/f)/n,m=function(I){return[o+I*d,v+I*M,f*Math.exp(n*I*c)]};else{var p=Math.sqrt(y),_=(x*x-f*f+r*y)/(2*f*e*p),u=(x*x-f*f-r*y)/(2*x*e*p),k=Math.log(Math.sqrt(_*_+1)-_),T=Math.log(Math.sqrt(u*u+1)-u);c=(T-k)/n,m=function(I){var E=I*c,$=_t(k),C=f/(e*p)*($*oe(n*E+k)-re(k));return[o+C*d,v+C*M,f*$/_t(n*E+k)]}}return m.duration=c*1e3*n/Math.SQRT2,m}return s.rho=function(a){var h=Math.max(.001,+a),o=h*h,v=o*o;return t(h,o,v)},s}(Math.SQRT2,2,4);function ae(t){const n=+this._x.call(null,t),e=+this._y.call(null,t);return St(this.cover(n,e),n,e,t)}function St(t,n,e,r){if(isNaN(n)||isNaN(e))return t;var s,a=t._root,h={data:r},o=t._x0,v=t._y0,f=t._x1,w=t._y1,N,x,d,M,y,m,c,p;if(!a)return t._root=h,t;for(;a.length;)if((y=n>=(N=(o+f)/2))?o=N:f=N,(m=e>=(x=(v+w)/2))?v=x:w=x,s=a,!(a=a[c=m<<1|y]))return s[c]=h,t;if(d=+t._x.call(null,a.data),M=+t._y.call(null,a.data),n===d&&e===M)return h.next=a,s?s[c]=h:t._root=h,t;do s=s?s[c]=new Array(4):t._root=new Array(4),(y=n>=(N=(o+f)/2))?o=N:f=N,(m=e>=(x=(v+w)/2))?v=x:w=x;while((c=m<<1|y)===(p=(M>=x)<<1|d>=N));return s[p]=a,s[c]=h,t}function se(t){var n,e,r=t.length,s,a,h=new Array(r),o=new Array(r),v=1/0,f=1/0,w=-1/0,N=-1/0;for(e=0;e<r;++e)isNaN(s=+this._x.call(null,n=t[e]))||isNaN(a=+this._y.call(null,n))||(h[e]=s,o[e]=a,s<v&&(v=s),s>w&&(w=s),a<f&&(f=a),a>N&&(N=a));if(v>w||f>N)return this;for(this.cover(v,f).cover(w,N),e=0;e<r;++e)St(this,h[e],o[e],t[e]);return this}function he(t,n){if(isNaN(t=+t)||isNaN(n=+n))return this;var e=this._x0,r=this._y0,s=this._x1,a=this._y1;if(isNaN(e))s=(e=Math.floor(t))+1,a=(r=Math.floor(n))+1;else{for(var h=s-e||1,o=this._root,v,f;e>t||t>=s||r>n||n>=a;)switch(f=(n<r)<<1|t<e,v=new Array(4),v[f]=o,o=v,h*=2,f){case 0:s=e+h,a=r+h;break;case 1:e=s-h,a=r+h;break;case 2:s=e+h,r=a-h;break;case 3:e=s-h,r=a-h;break}this._root&&this._root.length&&(this._root=o)}return this._x0=e,this._y0=r,this._x1=s,this._y1=a,this}function ce(){var t=[];return this.visit(function(n){if(!n.length)do t.push(n.data);while(n=n.next)}),t}function le(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function G(t,n,e,r,s){this.node=t,this.x0=n,this.y0=e,this.x1=r,this.y1=s}function fe(t,n,e){var r,s=this._x0,a=this._y0,h,o,v,f,w=this._x1,N=this._y1,x=[],d=this._root,M,y;for(d&&x.push(new G(d,s,a,w,N)),e==null?e=1/0:(s=t-e,a=n-e,w=t+e,N=n+e,e*=e);M=x.pop();)if(!(!(d=M.node)||(h=M.x0)>w||(o=M.y0)>N||(v=M.x1)<s||(f=M.y1)<a))if(d.length){var m=(h+v)/2,c=(o+f)/2;x.push(new G(d[3],m,c,v,f),new G(d[2],h,c,m,f),new G(d[1],m,o,v,c),new G(d[0],h,o,m,c)),(y=(n>=c)<<1|t>=m)&&(M=x[x.length-1],x[x.length-1]=x[x.length-1-y],x[x.length-1-y]=M)}else{var p=t-+this._x.call(null,d.data),_=n-+this._y.call(null,d.data),u=p*p+_*_;if(u<e){var k=Math.sqrt(e=u);s=t-k,a=n-k,w=t+k,N=n+k,r=d.data}}return r}function ge(t){if(isNaN(w=+this._x.call(null,t))||isNaN(N=+this._y.call(null,t)))return this;var n,e=this._root,r,s,a,h=this._x0,o=this._y0,v=this._x1,f=this._y1,w,N,x,d,M,y,m,c;if(!e)return this;if(e.length)for(;;){if((M=w>=(x=(h+v)/2))?h=x:v=x,(y=N>=(d=(o+f)/2))?o=d:f=d,n=e,!(e=e[m=y<<1|M]))return this;if(!e.length)break;(n[m+1&3]||n[m+2&3]||n[m+3&3])&&(r=n,c=m)}for(;e.data!==t;)if(s=e,!(e=e.next))return this;return(a=e.next)&&delete e.next,s?(a?s.next=a:delete s.next,this):n?(a?n[m]=a:delete n[m],(e=n[0]||n[1]||n[2]||n[3])&&e===(n[3]||n[2]||n[1]||n[0])&&!e.length&&(r?r[c]=e:this._root=e),this):(this._root=a,this)}function me(t){for(var n=0,e=t.length;n<e;++n)this.remove(t[n]);return this}function pe(){return this._root}function ye(){var t=0;return this.visit(function(n){if(!n.length)do++t;while(n=n.next)}),t}function de(t){var n=[],e,r=this._root,s,a,h,o,v;for(r&&n.push(new G(r,this._x0,this._y0,this._x1,this._y1));e=n.pop();)if(!t(r=e.node,a=e.x0,h=e.y0,o=e.x1,v=e.y1)&&r.length){var f=(a+o)/2,w=(h+v)/2;(s=r[3])&&n.push(new G(s,f,w,o,v)),(s=r[2])&&n.push(new G(s,a,w,f,v)),(s=r[1])&&n.push(new G(s,f,h,o,w)),(s=r[0])&&n.push(new G(s,a,h,f,w))}return this}function ve(t){var n=[],e=[],r;for(this._root&&n.push(new G(this._root,this._x0,this._y0,this._x1,this._y1));r=n.pop();){var s=r.node;if(s.length){var a,h=r.x0,o=r.y0,v=r.x1,f=r.y1,w=(h+v)/2,N=(o+f)/2;(a=s[0])&&n.push(new G(a,h,o,w,N)),(a=s[1])&&n.push(new G(a,w,o,v,N)),(a=s[2])&&n.push(new G(a,h,N,w,f)),(a=s[3])&&n.push(new G(a,w,N,v,f))}e.push(r)}for(;r=e.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function xe(t){return t[0]}function we(t){return arguments.length?(this._x=t,this):this._x}function _e(t){return t[1]}function ze(t){return arguments.length?(this._y=t,this):this._y}function lt(t,n,e){var r=new ft(n==null?xe:n,e==null?_e:e,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ft(t,n,e,r,s,a){this._x=t,this._y=n,this._x0=e,this._y0=r,this._x1=s,this._y1=a,this._root=void 0}function zt(t){for(var n={data:t.data},e=n;t=t.next;)e=e.next={data:t.data};return n}var V=lt.prototype=ft.prototype;V.copy=function(){var t=new ft(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,e,r;if(!n)return t;if(!n.length)return t._root=zt(n),t;for(e=[{source:n,target:t._root=new Array(4)}];n=e.pop();)for(var s=0;s<4;++s)(r=n.source[s])&&(r.length?e.push({source:r,target:n.target[s]=new Array(4)}):n.target[s]=zt(r));return t};V.add=ae;V.addAll=se;V.cover=he;V.data=ce;V.extent=le;V.find=fe;V.remove=ge;V.removeAll=me;V.root=pe;V.size=ye;V.visit=de;V.visitAfter=ve;V.x=we;V.y=ze;function X(t){return function(){return t}}function Z(t){return(t()-.5)*1e-6}function Me(t){return t.x+t.vx}function ke(t){return t.y+t.vy}function Ne(t){var n,e,r,s=1,a=1;typeof t!="function"&&(t=X(t==null?1:+t));function h(){for(var f,w=n.length,N,x,d,M,y,m,c=0;c<a;++c)for(N=lt(n,Me,ke).visitAfter(o),f=0;f<w;++f)x=n[f],y=e[x.index],m=y*y,d=x.x+x.vx,M=x.y+x.vy,N.visit(p);function p(_,u,k,T,I){var E=_.data,$=_.r,C=y+$;if(E){if(E.index>x.index){var B=d-E.x-E.vx,P=M-E.y-E.vy,j=B*B+P*P;j<C*C&&(B===0&&(B=Z(r),j+=B*B),P===0&&(P=Z(r),j+=P*P),j=(C-(j=Math.sqrt(j)))/j*s,x.vx+=(B*=j)*(C=($*=$)/(m+$)),x.vy+=(P*=j)*C,E.vx-=B*(C=1-C),E.vy-=P*C)}return}return u>d+C||T<d-C||k>M+C||I<M-C}}function o(f){if(f.data)return f.r=e[f.data.index];for(var w=f.r=0;w<4;++w)f[w]&&f[w].r>f.r&&(f.r=f[w].r)}function v(){if(!!n){var f,w=n.length,N;for(e=new Array(w),f=0;f<w;++f)N=n[f],e[N.index]=+t(N,f,n)}}return h.initialize=function(f,w){n=f,r=w,v()},h.iterations=function(f){return arguments.length?(a=+f,h):a},h.strength=function(f){return arguments.length?(s=+f,h):s},h.radius=function(f){return arguments.length?(t=typeof f=="function"?f:X(+f),v(),h):t},h}function Te(t){return t.index}function Mt(t,n){var e=t.get(n);if(!e)throw new Error("node not found: "+n);return e}function Ae(t){var n=Te,e=N,r,s=X(30),a,h,o,v,f,w=1;t==null&&(t=[]);function N(m){return 1/Math.min(o[m.source.index],o[m.target.index])}function x(m){for(var c=0,p=t.length;c<w;++c)for(var _=0,u,k,T,I,E,$,C;_<p;++_)u=t[_],k=u.source,T=u.target,I=T.x+T.vx-k.x-k.vx||Z(f),E=T.y+T.vy-k.y-k.vy||Z(f),$=Math.sqrt(I*I+E*E),$=($-a[_])/$*m*r[_],I*=$,E*=$,T.vx-=I*(C=v[_]),T.vy-=E*C,k.vx+=I*(C=1-C),k.vy+=E*C}function d(){if(!!h){var m,c=h.length,p=t.length,_=new Map(h.map((k,T)=>[n(k,T,h),k])),u;for(m=0,o=new Array(c);m<p;++m)u=t[m],u.index=m,typeof u.source!="object"&&(u.source=Mt(_,u.source)),typeof u.target!="object"&&(u.target=Mt(_,u.target)),o[u.source.index]=(o[u.source.index]||0)+1,o[u.target.index]=(o[u.target.index]||0)+1;for(m=0,v=new Array(p);m<p;++m)u=t[m],v[m]=o[u.source.index]/(o[u.source.index]+o[u.target.index]);r=new Array(p),M(),a=new Array(p),y()}}function M(){if(!!h)for(var m=0,c=t.length;m<c;++m)r[m]=+e(t[m],m,t)}function y(){if(!!h)for(var m=0,c=t.length;m<c;++m)a[m]=+s(t[m],m,t)}return x.initialize=function(m,c){h=m,f=c,d()},x.links=function(m){return arguments.length?(t=m,d(),x):t},x.id=function(m){return arguments.length?(n=m,x):n},x.iterations=function(m){return arguments.length?(w=+m,x):w},x.strength=function(m){return arguments.length?(e=typeof m=="function"?m:X(+m),M(),x):e},x.distance=function(m){return arguments.length?(s=typeof m=="function"?m:X(+m),y(),x):s},x}const Ie=1664525,Se=1013904223,kt=4294967296;function De(){let t=1;return()=>(t=(Ie*t+Se)%kt)/kt}function Ee(t){return t.x}function Ce(t){return t.y}var $e=10,Le=Math.PI*(3-Math.sqrt(5));function Be(t){var n,e=1,r=.001,s=1-Math.pow(r,1/300),a=0,h=.6,o=new Map,v=Kt(N),f=ct("tick","end"),w=De();t==null&&(t=[]);function N(){x(),f.call("tick",n),e<r&&(v.stop(),f.call("end",n))}function x(y){var m,c=t.length,p;y===void 0&&(y=1);for(var _=0;_<y;++_)for(e+=(a-e)*s,o.forEach(function(u){u(e)}),m=0;m<c;++m)p=t[m],p.fx==null?p.x+=p.vx*=h:(p.x=p.fx,p.vx=0),p.fy==null?p.y+=p.vy*=h:(p.y=p.fy,p.vy=0);return n}function d(){for(var y=0,m=t.length,c;y<m;++y){if(c=t[y],c.index=y,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var p=$e*Math.sqrt(.5+y),_=y*Le;c.x=p*Math.cos(_),c.y=p*Math.sin(_)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function M(y){return y.initialize&&y.initialize(t,w),y}return d(),n={tick:x,restart:function(){return v.restart(N),n},stop:function(){return v.stop(),n},nodes:function(y){return arguments.length?(t=y,d(),o.forEach(M),n):t},alpha:function(y){return arguments.length?(e=+y,n):e},alphaMin:function(y){return arguments.length?(r=+y,n):r},alphaDecay:function(y){return arguments.length?(s=+y,n):+s},alphaTarget:function(y){return arguments.length?(a=+y,n):a},velocityDecay:function(y){return arguments.length?(h=1-y,n):1-h},randomSource:function(y){return arguments.length?(w=y,o.forEach(M),n):w},force:function(y,m){return arguments.length>1?(m==null?o.delete(y):o.set(y,M(m)),n):o.get(y)},find:function(y,m,c){var p=0,_=t.length,u,k,T,I,E;for(c==null?c=1/0:c*=c,p=0;p<_;++p)I=t[p],u=y-I.x,k=m-I.y,T=u*u+k*k,T<c&&(E=I,c=T);return E},on:function(y,m){return arguments.length>1?(f.on(y,m),n):f.on(y)}}}function Re(){var t,n,e,r,s=X(-30),a,h=1,o=1/0,v=.81;function f(d){var M,y=t.length,m=lt(t,Ee,Ce).visitAfter(N);for(r=d,M=0;M<y;++M)n=t[M],m.visit(x)}function w(){if(!!t){var d,M=t.length,y;for(a=new Array(M),d=0;d<M;++d)y=t[d],a[y.index]=+s(y,d,t)}}function N(d){var M=0,y,m,c=0,p,_,u;if(d.length){for(p=_=u=0;u<4;++u)(y=d[u])&&(m=Math.abs(y.value))&&(M+=y.value,c+=m,p+=m*y.x,_+=m*y.y);d.x=p/c,d.y=_/c}else{y=d,y.x=y.data.x,y.y=y.data.y;do M+=a[y.data.index];while(y=y.next)}d.value=M}function x(d,M,y,m){if(!d.value)return!0;var c=d.x-n.x,p=d.y-n.y,_=m-M,u=c*c+p*p;if(_*_/v<u)return u<o&&(c===0&&(c=Z(e),u+=c*c),p===0&&(p=Z(e),u+=p*p),u<h&&(u=Math.sqrt(h*u)),n.vx+=c*d.value*r/u,n.vy+=p*d.value*r/u),!0;if(d.length||u>=o)return;(d.data!==n||d.next)&&(c===0&&(c=Z(e),u+=c*c),p===0&&(p=Z(e),u+=p*p),u<h&&(u=Math.sqrt(h*u)));do d.data!==n&&(_=a[d.data.index]*r/u,n.vx+=c*_,n.vy+=p*_);while(d=d.next)}return f.initialize=function(d,M){t=d,e=M,w()},f.strength=function(d){return arguments.length?(s=typeof d=="function"?d:X(+d),w(),f):s},f.distanceMin=function(d){return arguments.length?(h=d*d,f):Math.sqrt(h)},f.distanceMax=function(d){return arguments.length?(o=d*d,f):Math.sqrt(o)},f.theta=function(d){return arguments.length?(v=d*d,f):Math.sqrt(v)},f}function je(t){var n=X(.1),e,r,s;typeof t!="function"&&(t=X(t==null?0:+t));function a(o){for(var v=0,f=e.length,w;v<f;++v)w=e[v],w.vx+=(s[v]-w.x)*r[v]*o}function h(){if(!!e){var o,v=e.length;for(r=new Array(v),s=new Array(v),o=0;o<v;++o)r[o]=isNaN(s[o]=+t(e[o],o,e))?0:+n(e[o],o,e)}}return a.initialize=function(o){e=o,h()},a.strength=function(o){return arguments.length?(n=typeof o=="function"?o:X(+o),h(),a):n},a.x=function(o){return arguments.length?(t=typeof o=="function"?o:X(+o),h(),a):t},a}function be(t){var n=X(.1),e,r,s;typeof t!="function"&&(t=X(t==null?0:+t));function a(o){for(var v=0,f=e.length,w;v<f;++v)w=e[v],w.vy+=(s[v]-w.y)*r[v]*o}function h(){if(!!e){var o,v=e.length;for(r=new Array(v),s=new Array(v),o=0;o<v;++o)r[o]=isNaN(s[o]=+t(e[o],o,e))?0:+n(e[o],o,e)}}return a.initialize=function(o){e=o,h()},a.strength=function(o){return arguments.length?(n=typeof o=="function"?o:X(+o),h(),a):n},a.y=function(o){return arguments.length?(t=typeof o=="function"?o:X(+o),h(),a):t},a}var nt=t=>()=>t;function Pe(t,{sourceEvent:n,target:e,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function st(t){t.stopImmediatePropagation()}function J(t){t.preventDefault(),t.stopImmediatePropagation()}function Ge(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Xe(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Nt(){return this.__zoom||Tt}function Ve(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ye(){return navigator.maxTouchPoints||"ontouchstart"in this}function Oe(t,n,e){var r=t.invertX(n[0][0])-e[0][0],s=t.invertX(n[1][0])-e[1][0],a=t.invertY(n[0][1])-e[0][1],h=t.invertY(n[1][1])-e[1][1];return t.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),h>a?(a+h)/2:Math.min(0,a)||Math.max(0,h))}function Ue(){var t=Ge,n=Xe,e=Oe,r=Ve,s=Ye,a=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],o=250,v=ue,f=ct("start","zoom","end"),w,N,x,d=500,M=150,y=0,m=10;function c(i){i.property("__zoom",Nt).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",$).on("dblclick.zoom",C).filter(s).on("touchstart.zoom",B).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",j).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.transform=function(i,g,l,z){var A=i.selection?i.selection():i;A.property("__zoom",Nt),i!==A?k(i,g,l,z):A.interrupt().each(function(){T(this,arguments).event(z).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},c.scaleBy=function(i,g,l,z){c.scaleTo(i,function(){var A=this.__zoom.k,S=typeof g=="function"?g.apply(this,arguments):g;return A*S},l,z)},c.scaleTo=function(i,g,l,z){c.transform(i,function(){var A=n.apply(this,arguments),S=this.__zoom,D=l==null?u(A):typeof l=="function"?l.apply(this,arguments):l,L=S.invert(D),R=typeof g=="function"?g.apply(this,arguments):g;return e(_(p(S,R),D,L),A,h)},l,z)},c.translateBy=function(i,g,l,z){c.transform(i,function(){return e(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof l=="function"?l.apply(this,arguments):l),n.apply(this,arguments),h)},null,z)},c.translateTo=function(i,g,l,z,A){c.transform(i,function(){var S=n.apply(this,arguments),D=this.__zoom,L=z==null?u(S):typeof z=="function"?z.apply(this,arguments):z;return e(Tt.translate(L[0],L[1]).scale(D.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof l=="function"?-l.apply(this,arguments):-l),S,h)},z,A)};function p(i,g){return g=Math.max(a[0],Math.min(a[1],g)),g===i.k?i:new ot(g,i.x,i.y)}function _(i,g,l){var z=g[0]-l[0]*i.k,A=g[1]-l[1]*i.k;return z===i.x&&A===i.y?i:new ot(i.k,z,A)}function u(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function k(i,g,l,z){i.on("start.zoom",function(){T(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(z).end()}).tween("zoom",function(){var A=this,S=arguments,D=T(A,S).event(z),L=n.apply(A,S),R=l==null?u(L):typeof l=="function"?l.apply(A,S):l,F=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),b=A.__zoom,O=typeof g=="function"?g.apply(A,S):g,K=v(b.invert(R).concat(F/b.k),O.invert(R).concat(F/O.k));return function(U){if(U===1)U=O;else{var Q=K(U),it=F/Q[2];U=new ot(it,R[0]-Q[0]*it,R[1]-Q[1]*it)}D.zoom(null,U)}})}function T(i,g,l){return!l&&i.__zooming||new I(i,g)}function I(i,g){this.that=i,this.args=g,this.active=0,this.sourceEvent=null,this.extent=n.apply(i,g),this.taps=0}I.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,g){return this.mouse&&i!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var g=Y(this.that).datum();f.call(i,this.that,new Pe(i,{sourceEvent:this.sourceEvent,target:c,type:i,transform:this.that.__zoom,dispatch:f}),g)}};function E(i,...g){if(!t.apply(this,arguments))return;var l=T(this,g).event(i),z=this.__zoom,A=Math.max(a[0],Math.min(a[1],z.k*Math.pow(2,r.apply(this,arguments)))),S=W(i);if(l.wheel)(l.mouse[0][0]!==S[0]||l.mouse[0][1]!==S[1])&&(l.mouse[1]=z.invert(l.mouse[0]=S)),clearTimeout(l.wheel);else{if(z.k===A)return;l.mouse=[S,z.invert(S)],ut(this),l.start()}J(i),l.wheel=setTimeout(D,M),l.zoom("mouse",e(_(p(z,A),l.mouse[0],l.mouse[1]),l.extent,h));function D(){l.wheel=null,l.end()}}function $(i,...g){if(x||!t.apply(this,arguments))return;var l=i.currentTarget,z=T(this,g,!0).event(i),A=Y(i.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",F,!0),S=W(i,l),D=i.clientX,L=i.clientY;At(i.view),st(i),z.mouse=[S,this.__zoom.invert(S)],ut(this),z.start();function R(b){if(J(b),!z.moved){var O=b.clientX-D,K=b.clientY-L;z.moved=O*O+K*K>y}z.event(b).zoom("mouse",e(_(z.that.__zoom,z.mouse[0]=W(b,l),z.mouse[1]),z.extent,h))}function F(b){A.on("mousemove.zoom mouseup.zoom",null),It(b.view,z.moved),J(b),z.event(b).end()}}function C(i,...g){if(!!t.apply(this,arguments)){var l=this.__zoom,z=W(i.changedTouches?i.changedTouches[0]:i,this),A=l.invert(z),S=l.k*(i.shiftKey?.5:2),D=e(_(p(l,S),z,A),n.apply(this,g),h);J(i),o>0?Y(this).transition().duration(o).call(k,D,z,i):Y(this).call(c.transform,D,z,i)}}function B(i,...g){if(!!t.apply(this,arguments)){var l=i.touches,z=l.length,A=T(this,g,i.changedTouches.length===z).event(i),S,D,L,R;for(st(i),D=0;D<z;++D)L=l[D],R=W(L,this),R=[R,this.__zoom.invert(R),L.identifier],A.touch0?!A.touch1&&A.touch0[2]!==R[2]&&(A.touch1=R,A.taps=0):(A.touch0=R,S=!0,A.taps=1+!!w);w&&(w=clearTimeout(w)),S&&(A.taps<2&&(N=R[0],w=setTimeout(function(){w=null},d)),ut(this),A.start())}}function P(i,...g){if(!!this.__zooming){var l=T(this,g).event(i),z=i.changedTouches,A=z.length,S,D,L,R;for(J(i),S=0;S<A;++S)D=z[S],L=W(D,this),l.touch0&&l.touch0[2]===D.identifier?l.touch0[0]=L:l.touch1&&l.touch1[2]===D.identifier&&(l.touch1[0]=L);if(D=l.that.__zoom,l.touch1){var F=l.touch0[0],b=l.touch0[1],O=l.touch1[0],K=l.touch1[1],U=(U=O[0]-F[0])*U+(U=O[1]-F[1])*U,Q=(Q=K[0]-b[0])*Q+(Q=K[1]-b[1])*Q;D=p(D,Math.sqrt(U/Q)),L=[(F[0]+O[0])/2,(F[1]+O[1])/2],R=[(b[0]+K[0])/2,(b[1]+K[1])/2]}else if(l.touch0)L=l.touch0[0],R=l.touch0[1];else return;l.zoom("touch",e(_(D,L,R),l.extent,h))}}function j(i,...g){if(!!this.__zooming){var l=T(this,g).event(i),z=i.changedTouches,A=z.length,S,D;for(st(i),x&&clearTimeout(x),x=setTimeout(function(){x=null},d),S=0;S<A;++S)D=z[S],l.touch0&&l.touch0[2]===D.identifier?delete l.touch0:l.touch1&&l.touch1[2]===D.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),l.taps===2&&(D=W(D,this),Math.hypot(N[0]-D[0],N[1]-D[1])<m)){var L=Y(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return c.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:nt(+i),c):r},c.filter=function(i){return arguments.length?(t=typeof i=="function"?i:nt(!!i),c):t},c.touchable=function(i){return arguments.length?(s=typeof i=="function"?i:nt(!!i),c):s},c.extent=function(i){return arguments.length?(n=typeof i=="function"?i:nt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),c):n},c.scaleExtent=function(i){return arguments.length?(a[0]=+i[0],a[1]=+i[1],c):[a[0],a[1]]},c.translateExtent=function(i){return arguments.length?(h[0][0]=+i[0][0],h[1][0]=+i[1][0],h[0][1]=+i[0][1],h[1][1]=+i[1][1],c):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},c.constrain=function(i){return arguments.length?(e=i,c):e},c.duration=function(i){return arguments.length?(o=+i,c):o},c.interpolate=function(i){return arguments.length?(v=i,c):v},c.on=function(){var i=f.on.apply(f,arguments);return i===f?c:i},c.clickDistance=function(i){return arguments.length?(y=(i=+i)*i,c):Math.sqrt(y)},c.tapDistance=function(i){return arguments.length?(m=+i,c):m},c}class gt{constructor(n,e,r){this.linkContainer=n,this.ticked=()=>{var s;(s=this.sel)==null||s.attr("x1",a=>{var h,o;return(o=(h=a.source)==null?void 0:h.x)!=null?o:0}).attr("y1",a=>{var h,o;return(o=(h=a.source)==null?void 0:h.y)!=null?o:0}).attr("x2",a=>{var h,o;return(o=(h=a.target)==null?void 0:h.x)!=null?o:0}).attr("y2",a=>{var h,o;return(o=(h=a.target)==null?void 0:h.y)!=null?o:0})},this.mouseover=s=>{this.highliter.highlite(s)},this.mouseout=()=>{},this.init=s=>{this.sel=this.linkContainer.attr("stroke","#555").attr("stroke-width",1).selectAll("line").data(s).join("line"),this.createBackRefs()},this.createBackRefs=()=>{this.sel.each(function(s){s.d3node=Y(this)})},r&&this.init(r),this.highliter=new He(e)}}class Fe extends gt{constructor(){super(...arguments),this.mouseover=n=>{this.init([...n.mainInputs,...n.mainOutputs]),this.highliter.highlite(n)}}}const Dt=class extends gt{constructor(){super(...arguments),this.ticked=()=>{this.sel.attr("d",Dt.linkArc)},this.init=t=>{this.sel=this.linkContainer.attr("fill","none").selectAll("path").data(t).join("path").attr("stroke-width",1).attr("stroke","#555"),this.createBackRefs()}}};let Et=Dt;Et.linkArc=t=>{var e,r,s,a;const n=Math.hypot((r=t.target.x)!=null?r:0-((e=t.source.x)!=null?e:0),(a=t.target.y)!=null?a:0-((s=t.source.y)!=null?s:0));return`
      M${t.source.x},${t.source.y}
      A${n},${n} 0 0,1 ${t.target.x},${t.target.y}
      `};class He{constructor(n){this.stylesCallbacks=n,this.currDeph=0,this.outputIndex=0,this.all=[],this.instant=!0,this.highlite=e=>{this.reset(),this.all=[...new Set([...e.mainInputs,...e.mainOutputs])],this.outputIndex=e.mainInputs.size,this.instant?this.all.forEach(r=>this.styleSingle(r)):(this.all.forEach(r=>this.stylesCallbacks.defaultLink(r)),this.timeoutID=setInterval(this.nextStep,5))},this.reset=()=>{this.currDeph=0,clearInterval(this.timeoutID)},this.nextStep=()=>{var r;const e=(r=this.all)==null?void 0:r[this.currDeph];if(!e){clearInterval(this.timeoutID);return}this.styleSingle(e)}}styleSingle(n){const e=Number(this.currDeph>=this.outputIndex);[this.stylesCallbacks.inputLink,this.stylesCallbacks.outputLink][e](n,this.currDeph),this.currDeph++}}function Ke(t,n,e){var C,B,P,j;n.selectAll("*").remove();const r=n.append("g"),s=t,a=20,h=Math.floor(s.length/9),o=h-a,v=(B=(C=n.node())==null?void 0:C.getBoundingClientRect().width)!=null?B:400,f=(j=(P=n.node())==null?void 0:P.getBoundingClientRect().height)!=null?j:200,w=i=>{const g=t.map(A=>A[i]),l=Math.min(...g),z=Math.max(1,...g);return A=>(A-l)/z},N=w("complexity"),x=w("usability"),d=i=>Math.pow(i,.5),M=i=>d(d(i.weight)),y=i=>d(N(i.complexity)),m=i=>d(x(i.usability)),c=i=>v/2+y(i)*o*20-m(i)*o*20,p=i=>{const g=(y(i)+m(i))/2*h+a,l=Math.max(a,Math.min(h,g));return isNaN(l)?10:l},_=r.append("g").selectAll("g").data(s).join(u,k);function u(i){return k(i.append("g").style("cursor",g=>g.isGhost?null:"pointer").attr("opacity",g=>g.isGhost?.1:null).call(g=>g.append("circle")).call(g=>g.append("image")))}function k(i){return i.select("circle").attr("r",p).attr("stroke-width",g=>m(g)*10+1).attr("stroke","#fff").attr("fill",g=>g.inputsAmount===0?"rgba(67, 113, 165, 0.3)":g.outputsAmount===0?"rgba(0, 145, 7, 0.4)":"#111"),i.select("image").attr("x",g=>-p(g)*.9).attr("y",g=>-p(g)*.9).attr("height",g=>p(g)*2*.9).attr("width",g=>p(g)*2*.9).attr("xlink:href",g=>g.href).attr("image-rendering","pixelated"),i}_.each(function(i){i.d3node=Y(this)});const T=Ue().scaleExtent([.01,10]).on("zoom",i=>{var g;r.attr("transform",i.transform),(g=e.zoom)==null||g.call(e,i)});n.call(T),_.on("click",(i,g)=>{var l;(l=e.click)==null||l.call(e,g,!1)}).on("contextmenu",(i,g)=>{var l;i.preventDefault(),(l=e.click)==null||l.call(e,g,!0)}).on("mouseover",(i,g)=>{var l;(l=e.mouseover)==null||l.call(e,g,i)}).on("mouseout",(i,g)=>{var l;return(l=e.mouseout)==null?void 0:l.call(e,g,i)}).call(ne().on("start",I).on("drag",E).on("end",$));function I(i,g){var l;i.sourceEvent.stopPropagation(),i.active||(l=e.dragstarted)==null||l.call(e,g,i),g.fx=g.x,g.fy=g.y}function E(i,g){var l,z;(l=e.isGhost)!=null&&l.call(e,g,i)||((z=e.dragged)==null||z.call(e,g,i),g.fx=i.x,g.fy=i.y)}function $(i,g){var l;i.active||(l=e.dragended)==null||l.call(e,g,i),g.fx=null,g.fy=null}return{container:r,nodes:_,fNonlinear:d,fComp:y,fUsab:m,fX:c,fStroke:M,fSize:p,vizWidth:v,vizHeight:f,diffSize:o}}let H;function Qe(t,n,e={}){let r;const s=dt(yt({},e),{dragstarted(p){var _;H==null||H.alphaTarget(.3).restart(),(_=e.dragstarted)==null||_.call(e,p)},dragended(p){var _;H==null||H.alphaTarget(0),(_=e.dragended)==null||_.call(e,p)},mouseover(p){var _;r.mouseover(p),r.ticked(),(_=e.mouseover)==null||_.call(e,p)},mouseout(p){var _;r.mouseout(),r.ticked(),(_=e.mouseout)==null||_.call(e,p)}}),a=Ke(n,t,s),{fX:h,fSize:o,fUsab:v,vizHeight:f,diffSize:w,fStroke:N}=a,x=a.container.insert("g",":first-child").attr("class","linksLayer");H==null||H.on("tick",null).stop();const d={showLinks:n.length<500,showCurvedLinks:n.length<100,useReuse:n.length>500},M=[];for(const p of n)for(const _ of p.mainInputs)M.push(_);H=Be(n).force("charge",Re().strength(-2e3)).force("x",je(h).strength(1)).force("y",be(f/2).strength(p=>v(p)+1)).force("collision",Ne().radius(o).strength(.75)).force("link",Ae(M).distance(w/2).strength(1)).on("tick",c);function y(p,_){var u;(u=p.d3node)==null||u.attr("stroke-width",N(p)*3/_+3)}const m={defaultLink:p=>{var _;(_=p.d3node)==null||_.attr("stroke-width",1).attr("stroke","#555")},inputLink:(p,_)=>{var u;y(p,_),(u=p.d3node)==null||u.attr("stroke","#7f7")},outputLink:(p,_)=>{var u;y(p,_),(u=p.d3node)==null||u.attr("stroke","#38f")}};r=d.showLinks?d.showCurvedLinks?new Et(x,m,M):new gt(x,m,M):new Fe(x,m);function c(){r==null||r.ticked(),a.nodes.attr("transform",p=>`translate(${p.x},${p.y})`)}c()}const We={class:"relative"},Ze={key:0,class:"fixed"},qe=Ut("svg",{id:"viz",class:"w-full h-full"},null,-1),rn=jt({setup(t){const n=bt(),{pickedItems:e}=Pt(n);let r=Gt();Xt(s),Vt(e,s);function s(){!e.value||Qe(Y("#viz"),e.value,{mouseover:a=>r.value=a,click:a=>console.log(a.mainOutputs)})}return(a,h)=>{var f,w;const o=Qt,v=Ft;return rt(),vt("div",We,[r.value?(rt(),vt("div",Ze,[Yt(o,{item:r.value},null,8,["item"]),(f=r.value)!=null&&f.mainRecipe?(rt(),Ot(v,{key:0,recipes:[(w=r.value)==null?void 0:w.mainRecipe]},null,8,["recipes"])):xt("",!0)])):xt("",!0),qe])}}});export{rn as default};
