{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es.math.hypot.js","webpack:///./src/views/Graph.vue?3d4d","webpack:///./src/assets/js/d3ForcManyBodyReuse.js","webpack:///./src/assets/js/graph.js","webpack:///src/views/Graph.vue","webpack:///./src/views/Graph.vue?6c3f","webpack:///./src/views/Graph.vue"],"names":["$","$hypot","Math","hypot","abs","sqrt","BUGGY","Infinity","NaN","target","stat","forced","value1","value2","arg","div","sum","i","aLen","arguments","length","larg","render","_vm","this","_h","$createElement","_c","_self","staticStyle","staticClass","attrs","selectedNode","_e","staticRenderFns","forceUpdate","next","nodes","curr","floor","log","d3","forceManyBodyReuse","update","vizWidth","window","innerWidth","vizHeight","innerHeight","svg","zoom","container","linkContainer","nodeContainer","simulation","init","select","append","scaleExtent","on","attr","event","transform","call","linkArc","d","r","x","source","y","makeGraph","graph","vue","query","stop","graphNodes","q","lookupNode","find","n","id","safeDive","link","it","push","outputs","filter","inputs","graphLinks","j","findIndex","o","weight","index","options","showLinks","showCurvedLinks","useReuse","nonLinear","v","importancy","min","max","compFnc","complexity","minC","maxC","usabFnc","usability","minU","maxU","strokeWfnc","minSize","maxSize","parseInt","diffSize","sizeFnc","size","xFnc","forceSimulation","force","forceManyBody","strength","forceX","forceY","forceLink","distance","forceCollide","radius","ticked","undefined","selectAll","remove","data","join","each","d3node","l","node","appendNode","updateNode","enter","ec","style","navig","isRightClick","$router","path","catch","err","preventDefault","viewBox","require","diveToList","targetNode","targetDeph","listName","isInput","maxDeph","deph","currDeph","unhighliteLine","linkNode","resetLines","currIntervalID","drawDive","inDeph","selectedDeph","clearInterval","highlite","setInterval","filteredGraph","unhighlite","dragstarted","sourceEvent","stopPropagation","active","alphaTarget","restart","fx","fy","dragged","dragended","drag","name","props","type","Object","required","beforeRouteUpdate","to","mounted","component"],"mappings":"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","file":"js/graph.e5b5722c.js","sourcesContent":["var $ = require('../internals/export');\n\nvar $hypot = Math.hypot;\nvar abs = Math.abs;\nvar sqrt = Math.sqrt;\n\n// Chrome 77 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=9546\nvar BUGGY = !!$hypot && $hypot(Infinity, NaN) !== Infinity;\n\n// `Math.hypot` method\n// https://tc39.github.io/ecma262/#sec-math.hypot\n$({ target: 'Math', stat: true, forced: BUGGY }, {\n  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * sqrt(sum);\n  }\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"position\":\"relative\",\"height\":\"100%\"}},[_c('div',{staticClass:\"ma-4\",staticStyle:{\"position\":\"absolute\"}},[(_vm.selectedNode)?_c('tree-entry',{attrs:{\"node\":_vm.selectedNode,\"size\":\"64\"}}):_vm._e()],1),_c('svg',{staticStyle:{\"width\":\"100%\",\"height\":\"100%\"},attrs:{\"id\":\"viz\"}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","function forceUpdate() {\r\n  var next = 1;\r\n  return function (i, nodes) {\r\n    var curr = Math.floor(20 * Math.log(i));\r\n    if (curr !== next) {\r\n      next = curr;\r\n      return true;\r\n    }\r\n    return false;\r\n  };\r\n}\r\n\r\nexport default d3.forceManyBodyReuse().update(forceUpdate)","\r\nimport forceManyBodyReuse from \"./d3ForcManyBodyReuse.js\"\r\n\r\n\r\nvar vizWidth = window.innerWidth;\r\nvar vizHeight = window.innerHeight;\r\n\r\nvar svg = null;\r\nvar zoom = null;\r\nvar container = null;\r\nvar linkContainer = null;\r\nvar nodeContainer = null;\r\nvar simulation = null;\r\n\r\n\r\nexport function init() {\r\n  \r\n  svg = d3.select(\"#viz\");\r\n  container = svg.append(\"g\")\r\n\r\n  zoom = d3.zoom()\r\n    .scaleExtent([.1, 4])\r\n    .on(\"zoom\", function () { container.attr(\"transform\", d3.event.transform);});\r\n  \r\n  svg.call(zoom)\r\n\r\n  linkContainer = container.append(\"g\").attr(\"class\", \"linksLayer\");\r\n  nodeContainer = container.append(\"g\");\r\n}\r\n\r\n\r\nfunction linkArc(d) {\r\n  const r = Math.hypot(d.target.x - d.source.x, d.target.y - d.source.y);\r\n  return `\r\n    M${d.source.x},${d.source.y}\r\n    A${r},${r} 0 0,1 ${d.target.x},${d.target.y}\r\n    `;\r\n}\r\n\r\n\r\nexport function makeGraph(graph, vue, query) {\r\n\r\n  if (!container) init();\r\n\r\n  // ====================================================\r\n  // Dispose previous\r\n  // ====================================================\r\n  if (simulation) {\r\n    simulation.on(\"tick\", null);\r\n    simulation.stop();\r\n  }\r\n\r\n  // ====================================================\r\n  // Prepare nodes\r\n  // ====================================================\r\n\r\n  // Filter all graphNodes\r\n  // Remove elements that dont have inputs or outputs\r\n  var graphNodes = null;\r\n\r\n  if (query.q) {\r\n    const lookupNode = graph.nodes.find(n => n.id === query.q);\r\n\r\n    if (lookupNode) {\r\n      graphNodes = [lookupNode];\r\n      lookupNode.safeDive((link) => {\r\n        if (!graphNodes.find(n => n.id === link.it.id)) {\r\n          graphNodes.push(link.it);\r\n        }\r\n      }, query.outputs ? 'outputs' : 'inputs');\r\n    }\r\n  } \r\n  \r\n  if (!graphNodes) \r\n    graphNodes = graph.nodes.filter(n => n.inputs.length > 0 || n.outputs.length > 0);\r\n\r\n\r\n  const graphLinks = [];\r\n  for (let j = 0; j < graphNodes.length; j++) {\r\n    const n = graphNodes[j];\r\n\r\n    for (let i = 0; i < n.inputs.length; i++) {\r\n      const link = n.inputs[i];\r\n      const source = graphNodes.findIndex(o => o.id === link.it.id);\r\n\r\n      if (source > -1) {\r\n        graphLinks.push({\r\n          source: source,\r\n          target: j,\r\n          weight: link.weight,\r\n          index: graphLinks.length,\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  const options = {\r\n    showLinks:       graphNodes.length < 500,\r\n    showCurvedLinks: graphNodes.length < 100,\r\n    useReuse:        graphNodes.length > 500,\r\n  };\r\n\r\n  // ====================================================\r\n  // Math functions\r\n  // ====================================================\r\n  function nonLinear(v) {return Math.sqrt(v)}\r\n\r\n  function importancy(v, min, max) { return (v - min) / (max + 1) }\r\n  function compFnc(d) { return nonLinear(importancy(d.complexity, graph.minC, graph.maxC)) }\r\n  function usabFnc(d) { return nonLinear(importancy(d.usability,  graph.minU, graph.maxU)) }\r\n  function strokeWfnc(d) { return nonLinear(nonLinear(d.weight)); }\r\n\r\n  var minSize = 20;\r\n  var maxSize = parseInt(graphNodes.length / 9);\r\n  var diffSize = maxSize - minSize;\r\n\r\n  function sizeFnc(d) {\r\n    var size = (compFnc(d) + usabFnc(d))/2 * maxSize + minSize;\r\n    return Math.max(minSize, Math.min(maxSize, size));\r\n  }\r\n\r\n  function xFnc(d) { return vizWidth/2 + compFnc(d)*diffSize*20 - usabFnc(d)*diffSize*20 };\r\n  \r\n\r\n  // Adjust starting positions\r\n  // graphNodes.forEach(function (node) {\r\n  //   node.x = xFnc(node);\r\n  //   node.y = vizHeight / 4 + node.popularity*10;\r\n  // });\r\n\r\n\r\n  // ====================================================\r\n  // Layout\r\n  // ====================================================\r\n  simulation = d3.forceSimulation(graphNodes)\r\n    .force(\"charge\", (options.useReuse ? forceManyBodyReuse : d3.forceManyBody()).strength(-2000))\r\n    .force(\"x\", d3.forceX(xFnc).strength(1))\r\n    .force(\"y\", d3.forceY(vizHeight / 2).strength(d => usabFnc(d) + 1))\r\n    .force(\"link\", d3.forceLink(graphLinks)/* .id(d => d.id) */.distance(diffSize/2).strength(1))\r\n    .force('collision', d3.forceCollide().radius(sizeFnc).strength(0.75))\r\n    .on(\"tick\", ticked);\r\n\r\n  // .call(zoom.transform, \r\n  //   d3.zoomIdentity.scale(10 / Math.sqrt(graphNodes.length)));\r\n\r\n  // ====================================================\r\n  // Links\r\n  // ====================================================\r\n  var link = undefined;\r\n    linkContainer.selectAll(\"*\").remove();\r\n  \r\n\r\n  if (options.showLinks) {\r\n\r\n    if (options.showCurvedLinks) {\r\n      link = \r\n        linkContainer\r\n          .attr(\"fill\", \"none\")\r\n          .selectAll(\"path\")\r\n          .data(graphLinks)\r\n          .join(\"path\")\r\n          .attr(\"stroke-width\", 1)\r\n          .attr(\"stroke\", \"#555\")\r\n    } else {\r\n      link = \r\n        linkContainer\r\n          .attr(\"stroke\", \"#555\")\r\n          .attr(\"stroke-width\", 1)\r\n          .selectAll(\"line\")\r\n          .data(graphLinks)\r\n          .join(\"line\")\r\n    }\r\n\r\n    link.each(function(link, i) {\r\n      const d3node = d3.select(this) // Current ONE node\r\n\r\n      link.source.outputs .find(l => {\r\n        return l.it.id === link.target.id\r\n      }).d3node = d3node;\r\n      link.target.inputs.find(l => l.it.id === link.source.id).d3node = d3node;\r\n    });\r\n  }\r\n\r\n  // ====================================================\r\n  // Nodes\r\n  // ====================================================\r\n  var node = nodeContainer\r\n    .selectAll(\"g\")\r\n    .data(graphNodes)\r\n    // .enter()\r\n    .join(appendNode, updateNode)\r\n\r\n  function appendNode(enter) {\r\n    const ec = enter.append(\"g\")\r\n      .style('cursor', 'pointer');\r\n\r\n    ec.append(\"circle\");\r\n    ec.append(\"svg\").append(\"image\");\r\n\r\n    return updateNode(ec);\r\n  }\r\n\r\n  function navig(d, isRightClick) {\r\n    vue.$router.push({ path: 'graph', query: { q: d.id, outputs: isRightClick } }).catch(err => {})\r\n  }\r\n\r\n  function updateNode(update) {\r\n    update\r\n      .on(\"click\", d => navig(d))\r\n      .on(\"contextmenu\", d => {\r\n        d3.event.preventDefault();\r\n        navig(d, true);\r\n      })\r\n\r\n      .select(\"circle\")\r\n      .attr(\"r\", sizeFnc)\r\n      .attr(\"stroke-width\", d => usabFnc(d)*10 + 1)\r\n      .attr(\"stroke\", \"#fff\")\r\n      .attr(\"fill\", d => {\r\n        return d.inputs.length === 0 ? \"rgba(67, 113, 165, 0.3)\" :\r\n        (d.outputs.length === 0 ? \"rgba(0, 145, 7, 0.4)\" :\r\n        \"#111\")\r\n      })\r\n\r\n    update.select(\"svg\")\r\n      .attr(\"height\", (d,i) => sizeFnc(d,i) * 2 * 0.9)\r\n      .attr(\"width\",  (d,i) => sizeFnc(d,i) * 2 * 0.9)\r\n      .attr(\"x\",      (d,i) => - sizeFnc(d,i) * 0.9)\r\n      .attr(\"y\",      (d,i) => - sizeFnc(d,i) * 0.9)\r\n      .attr(\"viewBox\", d => d.viewBox)\r\n      .select(\"image\")\r\n        .attr(\"xlink:href\", require(\"@/assets/Spritesheet.png\"))\r\n        .attr(\"image-rendering\", \"pixelated\")\r\n\r\n    return update\r\n  };\r\n\r\n  node.each(function(d, i) {\r\n    d.d3node = d3.select(this) // Current ONE node\r\n  });\r\n\r\n  // ====================================================\r\n  // Events\r\n  // ====================================================\r\n\r\n  function ticked() {\r\n    if (link) {\r\n      if (options.showCurvedLinks) {\r\n        link.attr(\"d\", linkArc);\r\n      } else {\r\n        link\r\n          .attr(\"x1\", d => d.source.x)\r\n          .attr(\"y1\", d => d.source.y)\r\n          .attr(\"x2\", d => d.target.x)\r\n          .attr(\"y2\", d => d.target.y);\r\n      }\r\n    }\r\n      \r\n    node.attr(\"transform\", d => `translate(${d.x},${d.y})`);\r\n  }\r\n\r\n  \r\n  // ====================================================\r\n  // Node and links highliting\r\n  // ====================================================\r\n\r\n  function diveToList(targetNode, targetDeph, listName, style) {   \r\n    targetDeph = targetDeph || 999999999;\r\n    const isInput = listName === 'inputs';\r\n    var maxDeph = 0;\r\n    \r\n    targetNode.safeDive((link, source, deph) => {\r\n      const currDeph = 1 + targetDeph - deph;\r\n      maxDeph = Math.max(maxDeph, currDeph);\r\n\r\n      if (currDeph === targetDeph || targetDeph === 999999999){\r\n        if (link.d3node) {\r\n          if (style)\r\n            style(link.d3node)\r\n          else\r\n            link.d3node\r\n              .attr(\"stroke-width\", strokeWfnc(link) * 3 / (deph) + 1)\r\n              .attr(\"stroke\", isInput ? \"#7f7\" : \"#38f\");\r\n        }\r\n      }\r\n    }, listName, null, targetDeph);\r\n    \r\n    return maxDeph;\r\n  }\r\n\r\n  function unhighliteLine(linkNode) {\r\n    linkNode\r\n      .attr(\"stroke-width\", 1)\r\n      .attr(\"stroke\", \"#555\");\r\n  }\r\n\r\n  function resetLines(node){\r\n    if (vue.selectedNode) {\r\n      diveToList(node, null, 'inputs' , unhighliteLine);\r\n      diveToList(node, null, 'outputs', unhighliteLine);\r\n    }\r\n  }\r\n\r\n  var currIntervalID = null;\r\n\r\n  function drawDive() {\r\n\r\n    const inDeph = diveToList(vue.selectedNode, vue.selectedDeph, 'inputs');\r\n\r\n    if (vue.selectedDeph > inDeph) {\r\n      const targetDeph = vue.selectedDeph - inDeph;\r\n      if (targetDeph > diveToList(vue.selectedNode, targetDeph, 'outputs')) {\r\n        clearInterval(currIntervalID);\r\n      }\r\n    }\r\n    \r\n    vue.selectedDeph += 1;\r\n  }\r\n\r\n  function highlite(node) {\r\n\r\n    // Reset previous selected node links\r\n    if (options.showLinks) resetLines(vue.selectedNode);\r\n\r\n    vue.selectedNode = node;\r\n    \r\n    // Show new links\r\n    if (options.showLinks) {\r\n      vue.selectedDeph = 1;\r\n      clearInterval(currIntervalID);\r\n      currIntervalID = setInterval(drawDive, 100);\r\n    } else {\r\n      const filteredGraph = graphLinks.filter(l => l.target === node || l.source === node);\r\n\r\n      link = linkContainer\r\n        .attr(\"stroke-width\", 3)\r\n        .selectAll(\"line\")\r\n        .data(filteredGraph)\r\n        .join(\"line\")\r\n        .attr(\"stroke\", d => d.target === node ? \"#7f7\" : \"#38f\")\r\n      \r\n        // if (!d3.event.active) simulation.alphaTarget(0.3);\r\n    }\r\n  }\r\n\r\n  function unhighlite(d) {\r\n    if (options.showLinks) {\r\n      resetLines(vue.selectedNode);\r\n\r\n      vue.selectedDeph = 0;\r\n      clearInterval(currIntervalID);\r\n    }\r\n  }\r\n\r\n  node.on(\"mouseover\", highlite);\r\n  node.on(\"mouseout\", unhighlite);\r\n\r\n  // ====================================================\r\n  // Node dragging\r\n  // ====================================================\r\n  {\r\n    node.call(\r\n      d3.drag()\r\n        .on(\"start\", dragstarted)\r\n        .on(\"drag\", dragged)\r\n        .on(\"end\", dragended)\r\n    );\r\n    \r\n    function dragstarted(d) {\r\n      d3.event.sourceEvent.stopPropagation();\r\n      if (!d3.event.active) simulation.alphaTarget(0.3).restart();\r\n      d.fx = d.x;\r\n      d.fy = d.y;\r\n    }\r\n\r\n    function dragged(d) {\r\n      d.fx = d3.event.x;\r\n      d.fy = d3.event.y;\r\n    }\r\n\r\n    function dragended(d) {\r\n      if (!d3.event.active) simulation.alphaTarget(0);\r\n      d.fx = null;\r\n      d.fy = null;\r\n    }\r\n  }\r\n\r\n  return node;\r\n}\r\n","<template>\r\n  <div style=\"position: relative; height: 100%\">\r\n    <div style=\"position: absolute;\" class=\"ma-4\">\r\n      <tree-entry v-if=\"selectedNode\" :node=\"selectedNode\" size=\"64\"/>\r\n    </div>\r\n    <svg id=\"viz\" style=\"width: 100%; height: 100%\"></svg>\r\n    <!-- <v-stage :config=\"configKonva\">\r\n      <v-layer>\r\n        <v-circle :config=\"configCircle\"></v-circle>\r\n      </v-layer>\r\n    </v-stage> -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport {init, makeGraph} from \"../assets/js/graph.js\"\r\n\r\nexport default {\r\n  name: \"Graph\",\r\n  data() {\r\n    return {\r\n      selectedNode: undefined,\r\n      selectedDeph: 0,\r\n    }\r\n  },\r\n  props: {\r\n    graph: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n\r\n  beforeRouteUpdate (to, from, next) {\r\n    makeGraph(this.graph, this, to.query);\r\n    \r\n    next();\r\n  },\r\n\r\n  mounted() {\r\n    if (typeof this.graph == 'object')\r\n      makeGraph(this.graph, this, this.$route.query);\r\n  },\r\n};\r\n</script>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/vuetify-loader/lib/loader.js??ref--17-0!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Graph.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Graph.vue?vue&type=template&id=46410fea&\"\nimport script from \"./Graph.vue?vue&type=script&lang=js&\"\nexport * from \"./Graph.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}