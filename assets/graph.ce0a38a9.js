import{ad as mt,ae as Tt,af as ht,ag as At,ah as zt,ai as rt,aj as ot,H as It,K as Et,L as St,N as Dt,X as Ct,ab as Lt,a as pt,h as $t,c as jt,e as dt,f as Bt,ak as Rt,o as ut}from"./index.0bc36597.js";import{_ as bt}from"./ItemDetailed.84857be4.js";import"./GearedNumber.71287c0d.js";function Y(t){return typeof t=="string"?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],Tt)}function Pt(t){let e;for(;e=t.sourceEvent;)t=e;return t}function W(t,e){if(t=Pt(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const Xt={passive:!1},tt={capture:!0,passive:!1};function at(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function Mt(t){var e=t.document.documentElement,n=Y(t).on("dragstart.drag",q,tt);"onselectstart"in e?n.on("selectstart.drag",q,tt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function kt(t,e){var n=t.document.documentElement,r=Y(t).on("dragstart.drag",null);e&&(r.on("click.drag",q,tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const et=t=>()=>t;function ct(t,{sourceEvent:e,subject:n,target:r,identifier:s,active:u,x:h,y:a,dx:v,dy:f,dispatch:_}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:v,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:_}})}ct.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Gt(t){return!t.ctrlKey&&!t.button}function Vt(){return this.parentNode}function Yt(t,e){return e==null?{x:t.x,y:t.y}:e}function Ut(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ft(){var t=Gt,e=Vt,n=Yt,r=Ut,s={},u=ht("start","drag","end"),h=0,a,v,f,_,N=0;function y(o){o.on("mousedown.drag",d).filter(r).on("touchstart.drag",m).on("touchmove.drag",c,Xt).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(o,x){if(!(_||!t.call(this,o,x))){var z=T(this,e.call(this,o,x),o,x,"mouse");!z||(Y(o.view).on("mousemove.drag",k,tt).on("mouseup.drag",p,tt),Mt(o.view),at(o),f=!1,a=o.clientX,v=o.clientY,z("start",o))}}function k(o){if(q(o),!f){var x=o.clientX-a,z=o.clientY-v;f=x*x+z*z>N}s.mouse("drag",o)}function p(o){Y(o.view).on("mousemove.drag mouseup.drag",null),kt(o.view,f),q(o),s.mouse("end",o)}function m(o,x){if(!!t.call(this,o,x)){var z=o.changedTouches,A=e.call(this,o,x),E=z.length,L,C;for(L=0;L<E;++L)(C=T(this,A,o,x,z[L].identifier,z[L]))&&(at(o),C("start",o,z[L]))}}function c(o){var x=o.changedTouches,z=x.length,A,E;for(A=0;A<z;++A)(E=s[x[A].identifier])&&(q(o),E("drag",o,x[A]))}function w(o){var x=o.changedTouches,z=x.length,A,E;for(_&&clearTimeout(_),_=setTimeout(function(){_=null},500),A=0;A<z;++A)(E=s[x[A].identifier])&&(at(o),E("end",o,x[A]))}function T(o,x,z,A,E,L){var C=u.copy(),j=W(L||z,x),P,R,i;if((i=n.call(o,new ct("beforestart",{sourceEvent:z,target:y,identifier:E,active:h,x:j[0],y:j[1],dx:0,dy:0,dispatch:C}),A))!=null)return P=i.x-j[0]||0,R=i.y-j[1]||0,function g(l,M,I){var S=j,D;switch(l){case"start":s[E]=g,D=h++;break;case"end":delete s[E],--h;case"drag":j=W(I||M,x),D=h;break}C.call(l,o,new ct(l,{sourceEvent:M,subject:i,target:y,identifier:E,active:D,x:j[0]+P,y:j[1]+R,dx:j[0]-S[0],dy:j[1]-S[1],dispatch:C}),A)}}return y.filter=function(o){return arguments.length?(t=typeof o=="function"?o:et(!!o),y):t},y.container=function(o){return arguments.length?(e=typeof o=="function"?o:et(o),y):e},y.subject=function(o){return arguments.length?(n=typeof o=="function"?o:et(o),y):n},y.touchable=function(o){return arguments.length?(r=typeof o=="function"?o:et(!!o),y):r},y.on=function(){var o=u.on.apply(u,arguments);return o===u?y:o},y.clickDistance=function(o){return arguments.length?(N=(o=+o)*o,y):Math.sqrt(N)},y}var Kt=1e-12;function yt(t){return((t=Math.exp(t))+1/t)/2}function Ot(t){return((t=Math.exp(t))-1/t)/2}function Ht(t){return((t=Math.exp(2*t))-1)/(t+1)}const Qt=function t(e,n,r){function s(u,h){var a=u[0],v=u[1],f=u[2],_=h[0],N=h[1],y=h[2],d=_-a,k=N-v,p=d*d+k*k,m,c;if(p<Kt)c=Math.log(y/f)/e,m=function(A){return[a+A*d,v+A*k,f*Math.exp(e*A*c)]};else{var w=Math.sqrt(p),T=(y*y-f*f+r*p)/(2*f*n*w),o=(y*y-f*f-r*p)/(2*y*n*w),x=Math.log(Math.sqrt(T*T+1)-T),z=Math.log(Math.sqrt(o*o+1)-o);c=(z-x)/e,m=function(A){var E=A*c,L=yt(x),C=f/(n*w)*(L*Ht(e*E+x)-Ot(x));return[a+C*d,v+C*k,f*L/yt(e*E+x)]}}return m.duration=c*1e3*e/Math.SQRT2,m}return s.rho=function(u){var h=Math.max(.001,+u),a=h*h,v=a*a;return t(h,a,v)},s}(Math.SQRT2,2,4);function Wt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Nt(this.cover(e,n),e,n,t)}function Nt(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var s,u=t._root,h={data:r},a=t._x0,v=t._y0,f=t._x1,_=t._y1,N,y,d,k,p,m,c,w;if(!u)return t._root=h,t;for(;u.length;)if((p=e>=(N=(a+f)/2))?a=N:f=N,(m=n>=(y=(v+_)/2))?v=y:_=y,s=u,!(u=u[c=m<<1|p]))return s[c]=h,t;if(d=+t._x.call(null,u.data),k=+t._y.call(null,u.data),e===d&&n===k)return h.next=u,s?s[c]=h:t._root=h,t;do s=s?s[c]=new Array(4):t._root=new Array(4),(p=e>=(N=(a+f)/2))?a=N:f=N,(m=n>=(y=(v+_)/2))?v=y:_=y;while((c=m<<1|p)===(w=(k>=y)<<1|d>=N));return s[w]=u,s[c]=h,t}function Zt(t){var e,n,r=t.length,s,u,h=new Array(r),a=new Array(r),v=1/0,f=1/0,_=-1/0,N=-1/0;for(n=0;n<r;++n)isNaN(s=+this._x.call(null,e=t[n]))||isNaN(u=+this._y.call(null,e))||(h[n]=s,a[n]=u,s<v&&(v=s),s>_&&(_=s),u<f&&(f=u),u>N&&(N=u));if(v>_||f>N)return this;for(this.cover(v,f).cover(_,N),n=0;n<r;++n)Nt(this,h[n],a[n],t[n]);return this}function qt(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,s=this._x1,u=this._y1;if(isNaN(n))s=(n=Math.floor(t))+1,u=(r=Math.floor(e))+1;else{for(var h=s-n||1,a=this._root,v,f;n>t||t>=s||r>e||e>=u;)switch(f=(e<r)<<1|t<n,v=new Array(4),v[f]=a,a=v,h*=2,f){case 0:s=n+h,u=r+h;break;case 1:n=s-h,u=r+h;break;case 2:s=n+h,r=u-h;break;case 3:n=s-h,r=u-h;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=s,this._y1=u,this}function Jt(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function te(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function X(t,e,n,r,s){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=s}function ee(t,e,n){var r,s=this._x0,u=this._y0,h,a,v,f,_=this._x1,N=this._y1,y=[],d=this._root,k,p;for(d&&y.push(new X(d,s,u,_,N)),n==null?n=1/0:(s=t-n,u=e-n,_=t+n,N=e+n,n*=n);k=y.pop();)if(!(!(d=k.node)||(h=k.x0)>_||(a=k.y0)>N||(v=k.x1)<s||(f=k.y1)<u))if(d.length){var m=(h+v)/2,c=(a+f)/2;y.push(new X(d[3],m,c,v,f),new X(d[2],h,c,m,f),new X(d[1],m,a,v,c),new X(d[0],h,a,m,c)),(p=(e>=c)<<1|t>=m)&&(k=y[y.length-1],y[y.length-1]=y[y.length-1-p],y[y.length-1-p]=k)}else{var w=t-+this._x.call(null,d.data),T=e-+this._y.call(null,d.data),o=w*w+T*T;if(o<n){var x=Math.sqrt(n=o);s=t-x,u=e-x,_=t+x,N=e+x,r=d.data}}return r}function ne(t){if(isNaN(_=+this._x.call(null,t))||isNaN(N=+this._y.call(null,t)))return this;var e,n=this._root,r,s,u,h=this._x0,a=this._y0,v=this._x1,f=this._y1,_,N,y,d,k,p,m,c;if(!n)return this;if(n.length)for(;;){if((k=_>=(y=(h+v)/2))?h=y:v=y,(p=N>=(d=(a+f)/2))?a=d:f=d,e=n,!(n=n[m=p<<1|k]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,c=m)}for(;n.data!==t;)if(s=n,!(n=n.next))return this;return(u=n.next)&&delete n.next,s?(u?s.next=u:delete s.next,this):e?(u?e[m]=u:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[c]=n:this._root=n),this):(this._root=u,this)}function ie(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function re(){return this._root}function oe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ue(t){var e=[],n,r=this._root,s,u,h,a,v;for(r&&e.push(new X(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,u=n.x0,h=n.y0,a=n.x1,v=n.y1)&&r.length){var f=(u+a)/2,_=(h+v)/2;(s=r[3])&&e.push(new X(s,f,_,a,v)),(s=r[2])&&e.push(new X(s,u,_,f,v)),(s=r[1])&&e.push(new X(s,f,h,a,_)),(s=r[0])&&e.push(new X(s,u,h,f,_))}return this}function ae(t){var e=[],n=[],r;for(this._root&&e.push(new X(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var s=r.node;if(s.length){var u,h=r.x0,a=r.y0,v=r.x1,f=r.y1,_=(h+v)/2,N=(a+f)/2;(u=s[0])&&e.push(new X(u,h,a,_,N)),(u=s[1])&&e.push(new X(u,_,a,v,N)),(u=s[2])&&e.push(new X(u,h,N,_,f)),(u=s[3])&&e.push(new X(u,_,N,v,f))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function se(t){return t[0]}function ce(t){return arguments.length?(this._x=t,this):this._x}function he(t){return t[1]}function le(t){return arguments.length?(this._y=t,this):this._y}function lt(t,e,n){var r=new ft(e==null?se:e,n==null?he:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ft(t,e,n,r,s,u){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=s,this._y1=u,this._root=void 0}function vt(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var V=lt.prototype=ft.prototype;V.copy=function(){var t=new ft(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=vt(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var s=0;s<4;++s)(r=e.source[s])&&(r.length?n.push({source:r,target:e.target[s]=new Array(4)}):e.target[s]=vt(r));return t};V.add=Wt;V.addAll=Zt;V.cover=qt;V.data=Jt;V.extent=te;V.find=ee;V.remove=ne;V.removeAll=ie;V.root=re;V.size=oe;V.visit=ue;V.visitAfter=ae;V.x=ce;V.y=le;function G(t){return function(){return t}}function Z(t){return(t()-.5)*1e-6}function fe(t){return t.x+t.vx}function ge(t){return t.y+t.vy}function me(t){var e,n,r,s=1,u=1;typeof t!="function"&&(t=G(t==null?1:+t));function h(){for(var f,_=e.length,N,y,d,k,p,m,c=0;c<u;++c)for(N=lt(e,fe,ge).visitAfter(a),f=0;f<_;++f)y=e[f],p=n[y.index],m=p*p,d=y.x+y.vx,k=y.y+y.vy,N.visit(w);function w(T,o,x,z,A){var E=T.data,L=T.r,C=p+L;if(E){if(E.index>y.index){var j=d-E.x-E.vx,P=k-E.y-E.vy,R=j*j+P*P;R<C*C&&(j===0&&(j=Z(r),R+=j*j),P===0&&(P=Z(r),R+=P*P),R=(C-(R=Math.sqrt(R)))/R*s,y.vx+=(j*=R)*(C=(L*=L)/(m+L)),y.vy+=(P*=R)*C,E.vx-=j*(C=1-C),E.vy-=P*C)}return}return o>d+C||z<d-C||x>k+C||A<k-C}}function a(f){if(f.data)return f.r=n[f.data.index];for(var _=f.r=0;_<4;++_)f[_]&&f[_].r>f.r&&(f.r=f[_].r)}function v(){if(!!e){var f,_=e.length,N;for(n=new Array(_),f=0;f<_;++f)N=e[f],n[N.index]=+t(N,f,e)}}return h.initialize=function(f,_){e=f,r=_,v()},h.iterations=function(f){return arguments.length?(u=+f,h):u},h.strength=function(f){return arguments.length?(s=+f,h):s},h.radius=function(f){return arguments.length?(t=typeof f=="function"?f:G(+f),v(),h):t},h}function pe(t){return t.index}function xt(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function de(t){var e=pe,n=N,r,s=G(30),u,h,a,v,f,_=1;t==null&&(t=[]);function N(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function y(m){for(var c=0,w=t.length;c<_;++c)for(var T=0,o,x,z,A,E,L,C;T<w;++T)o=t[T],x=o.source,z=o.target,A=z.x+z.vx-x.x-x.vx||Z(f),E=z.y+z.vy-x.y-x.vy||Z(f),L=Math.sqrt(A*A+E*E),L=(L-u[T])/L*m*r[T],A*=L,E*=L,z.vx-=A*(C=v[T]),z.vy-=E*C,x.vx+=A*(C=1-C),x.vy+=E*C}function d(){if(!!h){var m,c=h.length,w=t.length,T=new Map(h.map((x,z)=>[e(x,z,h),x])),o;for(m=0,a=new Array(c);m<w;++m)o=t[m],o.index=m,typeof o.source!="object"&&(o.source=xt(T,o.source)),typeof o.target!="object"&&(o.target=xt(T,o.target)),a[o.source.index]=(a[o.source.index]||0)+1,a[o.target.index]=(a[o.target.index]||0)+1;for(m=0,v=new Array(w);m<w;++m)o=t[m],v[m]=a[o.source.index]/(a[o.source.index]+a[o.target.index]);r=new Array(w),k(),u=new Array(w),p()}}function k(){if(!!h)for(var m=0,c=t.length;m<c;++m)r[m]=+n(t[m],m,t)}function p(){if(!!h)for(var m=0,c=t.length;m<c;++m)u[m]=+s(t[m],m,t)}return y.initialize=function(m,c){h=m,f=c,d()},y.links=function(m){return arguments.length?(t=m,d(),y):t},y.id=function(m){return arguments.length?(e=m,y):e},y.iterations=function(m){return arguments.length?(_=+m,y):_},y.strength=function(m){return arguments.length?(n=typeof m=="function"?m:G(+m),k(),y):n},y.distance=function(m){return arguments.length?(s=typeof m=="function"?m:G(+m),p(),y):s},y}const ye=1664525,ve=1013904223,_t=4294967296;function xe(){let t=1;return()=>(t=(ye*t+ve)%_t)/_t}function _e(t){return t.x}function we(t){return t.y}var ze=10,Me=Math.PI*(3-Math.sqrt(5));function ke(t){var e,n=1,r=.001,s=1-Math.pow(r,1/300),u=0,h=.6,a=new Map,v=At(N),f=ht("tick","end"),_=xe();t==null&&(t=[]);function N(){y(),f.call("tick",e),n<r&&(v.stop(),f.call("end",e))}function y(p){var m,c=t.length,w;p===void 0&&(p=1);for(var T=0;T<p;++T)for(n+=(u-n)*s,a.forEach(function(o){o(n)}),m=0;m<c;++m)w=t[m],w.fx==null?w.x+=w.vx*=h:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=h:(w.y=w.fy,w.vy=0);return e}function d(){for(var p=0,m=t.length,c;p<m;++p){if(c=t[p],c.index=p,c.fx!=null&&(c.x=c.fx),c.fy!=null&&(c.y=c.fy),isNaN(c.x)||isNaN(c.y)){var w=ze*Math.sqrt(.5+p),T=p*Me;c.x=w*Math.cos(T),c.y=w*Math.sin(T)}(isNaN(c.vx)||isNaN(c.vy))&&(c.vx=c.vy=0)}}function k(p){return p.initialize&&p.initialize(t,_),p}return d(),e={tick:y,restart:function(){return v.restart(N),e},stop:function(){return v.stop(),e},nodes:function(p){return arguments.length?(t=p,d(),a.forEach(k),e):t},alpha:function(p){return arguments.length?(n=+p,e):n},alphaMin:function(p){return arguments.length?(r=+p,e):r},alphaDecay:function(p){return arguments.length?(s=+p,e):+s},alphaTarget:function(p){return arguments.length?(u=+p,e):u},velocityDecay:function(p){return arguments.length?(h=1-p,e):1-h},randomSource:function(p){return arguments.length?(_=p,a.forEach(k),e):_},force:function(p,m){return arguments.length>1?(m==null?a.delete(p):a.set(p,k(m)),e):a.get(p)},find:function(p,m,c){var w=0,T=t.length,o,x,z,A,E;for(c==null?c=1/0:c*=c,w=0;w<T;++w)A=t[w],o=p-A.x,x=m-A.y,z=o*o+x*x,z<c&&(E=A,c=z);return E},on:function(p,m){return arguments.length>1?(f.on(p,m),e):f.on(p)}}}function Ne(){var t,e,n,r,s=G(-30),u,h=1,a=1/0,v=.81;function f(d){var k,p=t.length,m=lt(t,_e,we).visitAfter(N);for(r=d,k=0;k<p;++k)e=t[k],m.visit(y)}function _(){if(!!t){var d,k=t.length,p;for(u=new Array(k),d=0;d<k;++d)p=t[d],u[p.index]=+s(p,d,t)}}function N(d){var k=0,p,m,c=0,w,T,o;if(d.length){for(w=T=o=0;o<4;++o)(p=d[o])&&(m=Math.abs(p.value))&&(k+=p.value,c+=m,w+=m*p.x,T+=m*p.y);d.x=w/c,d.y=T/c}else{p=d,p.x=p.data.x,p.y=p.data.y;do k+=u[p.data.index];while(p=p.next)}d.value=k}function y(d,k,p,m){if(!d.value)return!0;var c=d.x-e.x,w=d.y-e.y,T=m-k,o=c*c+w*w;if(T*T/v<o)return o<a&&(c===0&&(c=Z(n),o+=c*c),w===0&&(w=Z(n),o+=w*w),o<h&&(o=Math.sqrt(h*o)),e.vx+=c*d.value*r/o,e.vy+=w*d.value*r/o),!0;if(d.length||o>=a)return;(d.data!==e||d.next)&&(c===0&&(c=Z(n),o+=c*c),w===0&&(w=Z(n),o+=w*w),o<h&&(o=Math.sqrt(h*o)));do d.data!==e&&(T=u[d.data.index]*r/o,e.vx+=c*T,e.vy+=w*T);while(d=d.next)}return f.initialize=function(d,k){t=d,n=k,_()},f.strength=function(d){return arguments.length?(s=typeof d=="function"?d:G(+d),_(),f):s},f.distanceMin=function(d){return arguments.length?(h=d*d,f):Math.sqrt(h)},f.distanceMax=function(d){return arguments.length?(a=d*d,f):Math.sqrt(a)},f.theta=function(d){return arguments.length?(v=d*d,f):Math.sqrt(v)},f}function Te(t){var e=G(.1),n,r,s;typeof t!="function"&&(t=G(t==null?0:+t));function u(a){for(var v=0,f=n.length,_;v<f;++v)_=n[v],_.vx+=(s[v]-_.x)*r[v]*a}function h(){if(!!n){var a,v=n.length;for(r=new Array(v),s=new Array(v),a=0;a<v;++a)r[a]=isNaN(s[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,h()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:G(+a),h(),u):e},u.x=function(a){return arguments.length?(t=typeof a=="function"?a:G(+a),h(),u):t},u}function Ae(t){var e=G(.1),n,r,s;typeof t!="function"&&(t=G(t==null?0:+t));function u(a){for(var v=0,f=n.length,_;v<f;++v)_=n[v],_.vy+=(s[v]-_.y)*r[v]*a}function h(){if(!!n){var a,v=n.length;for(r=new Array(v),s=new Array(v),a=0;a<v;++a)r[a]=isNaN(s[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,h()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:G(+a),h(),u):e},u.y=function(a){return arguments.length?(t=typeof a=="function"?a:G(+a),h(),u):t},u}const nt=t=>()=>t;function Ie(t,{sourceEvent:e,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function st(t){t.stopImmediatePropagation()}function J(t){t.preventDefault(),t.stopImmediatePropagation()}function Ee(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Se(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function wt(){return this.__zoom||zt}function De(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ce(){return navigator.maxTouchPoints||"ontouchstart"in this}function Le(t,e,n){var r=t.invertX(e[0][0])-n[0][0],s=t.invertX(e[1][0])-n[1][0],u=t.invertY(e[0][1])-n[0][1],h=t.invertY(e[1][1])-n[1][1];return t.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),h>u?(u+h)/2:Math.min(0,u)||Math.max(0,h))}function $e(){var t=Ee,e=Se,n=Le,r=De,s=Ce,u=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],a=250,v=Qt,f=ht("start","zoom","end"),_,N,y,d=500,k=150,p=0,m=10;function c(i){i.property("__zoom",wt).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",C).filter(s).on("touchstart.zoom",j).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.transform=function(i,g,l,M){var I=i.selection?i.selection():i;I.property("__zoom",wt),i!==I?x(i,g,l,M):I.interrupt().each(function(){z(this,arguments).event(M).start().zoom(null,typeof g=="function"?g.apply(this,arguments):g).end()})},c.scaleBy=function(i,g,l,M){c.scaleTo(i,function(){var I=this.__zoom.k,S=typeof g=="function"?g.apply(this,arguments):g;return I*S},l,M)},c.scaleTo=function(i,g,l,M){c.transform(i,function(){var I=e.apply(this,arguments),S=this.__zoom,D=l==null?o(I):typeof l=="function"?l.apply(this,arguments):l,$=S.invert(D),B=typeof g=="function"?g.apply(this,arguments):g;return n(T(w(S,B),D,$),I,h)},l,M)},c.translateBy=function(i,g,l,M){c.transform(i,function(){return n(this.__zoom.translate(typeof g=="function"?g.apply(this,arguments):g,typeof l=="function"?l.apply(this,arguments):l),e.apply(this,arguments),h)},null,M)},c.translateTo=function(i,g,l,M,I){c.transform(i,function(){var S=e.apply(this,arguments),D=this.__zoom,$=M==null?o(S):typeof M=="function"?M.apply(this,arguments):M;return n(zt.translate($[0],$[1]).scale(D.k).translate(typeof g=="function"?-g.apply(this,arguments):-g,typeof l=="function"?-l.apply(this,arguments):-l),S,h)},M,I)};function w(i,g){return g=Math.max(u[0],Math.min(u[1],g)),g===i.k?i:new rt(g,i.x,i.y)}function T(i,g,l){var M=g[0]-l[0]*i.k,I=g[1]-l[1]*i.k;return M===i.x&&I===i.y?i:new rt(i.k,M,I)}function o(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function x(i,g,l,M){i.on("start.zoom",function(){z(this,arguments).event(M).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event(M).end()}).tween("zoom",function(){var I=this,S=arguments,D=z(I,S).event(M),$=e.apply(I,S),B=l==null?o($):typeof l=="function"?l.apply(I,S):l,K=Math.max($[1][0]-$[0][0],$[1][1]-$[0][1]),b=I.__zoom,U=typeof g=="function"?g.apply(I,S):g,H=v(b.invert(B).concat(K/b.k),U.invert(B).concat(K/U.k));return function(F){if(F===1)F=U;else{var Q=H(F),it=K/Q[2];F=new rt(it,B[0]-Q[0]*it,B[1]-Q[1]*it)}D.zoom(null,F)}})}function z(i,g,l){return!l&&i.__zooming||new A(i,g)}function A(i,g){this.that=i,this.args=g,this.active=0,this.sourceEvent=null,this.extent=e.apply(i,g),this.taps=0}A.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,g){return this.mouse&&i!=="mouse"&&(this.mouse[1]=g.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=g.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=g.invert(this.touch1[0])),this.that.__zoom=g,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var g=Y(this.that).datum();f.call(i,this.that,new Ie(i,{sourceEvent:this.sourceEvent,target:c,type:i,transform:this.that.__zoom,dispatch:f}),g)}};function E(i,...g){if(!t.apply(this,arguments))return;var l=z(this,g).event(i),M=this.__zoom,I=Math.max(u[0],Math.min(u[1],M.k*Math.pow(2,r.apply(this,arguments)))),S=W(i);if(l.wheel)(l.mouse[0][0]!==S[0]||l.mouse[0][1]!==S[1])&&(l.mouse[1]=M.invert(l.mouse[0]=S)),clearTimeout(l.wheel);else{if(M.k===I)return;l.mouse=[S,M.invert(S)],ot(this),l.start()}J(i),l.wheel=setTimeout(D,k),l.zoom("mouse",n(T(w(M,I),l.mouse[0],l.mouse[1]),l.extent,h));function D(){l.wheel=null,l.end()}}function L(i,...g){if(y||!t.apply(this,arguments))return;var l=i.currentTarget,M=z(this,g,!0).event(i),I=Y(i.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",K,!0),S=W(i,l),D=i.clientX,$=i.clientY;Mt(i.view),st(i),M.mouse=[S,this.__zoom.invert(S)],ot(this),M.start();function B(b){if(J(b),!M.moved){var U=b.clientX-D,H=b.clientY-$;M.moved=U*U+H*H>p}M.event(b).zoom("mouse",n(T(M.that.__zoom,M.mouse[0]=W(b,l),M.mouse[1]),M.extent,h))}function K(b){I.on("mousemove.zoom mouseup.zoom",null),kt(b.view,M.moved),J(b),M.event(b).end()}}function C(i,...g){if(!!t.apply(this,arguments)){var l=this.__zoom,M=W(i.changedTouches?i.changedTouches[0]:i,this),I=l.invert(M),S=l.k*(i.shiftKey?.5:2),D=n(T(w(l,S),M,I),e.apply(this,g),h);J(i),a>0?Y(this).transition().duration(a).call(x,D,M,i):Y(this).call(c.transform,D,M,i)}}function j(i,...g){if(!!t.apply(this,arguments)){var l=i.touches,M=l.length,I=z(this,g,i.changedTouches.length===M).event(i),S,D,$,B;for(st(i),D=0;D<M;++D)$=l[D],B=W($,this),B=[B,this.__zoom.invert(B),$.identifier],I.touch0?!I.touch1&&I.touch0[2]!==B[2]&&(I.touch1=B,I.taps=0):(I.touch0=B,S=!0,I.taps=1+!!_);_&&(_=clearTimeout(_)),S&&(I.taps<2&&(N=B[0],_=setTimeout(function(){_=null},d)),ot(this),I.start())}}function P(i,...g){if(!!this.__zooming){var l=z(this,g).event(i),M=i.changedTouches,I=M.length,S,D,$,B;for(J(i),S=0;S<I;++S)D=M[S],$=W(D,this),l.touch0&&l.touch0[2]===D.identifier?l.touch0[0]=$:l.touch1&&l.touch1[2]===D.identifier&&(l.touch1[0]=$);if(D=l.that.__zoom,l.touch1){var K=l.touch0[0],b=l.touch0[1],U=l.touch1[0],H=l.touch1[1],F=(F=U[0]-K[0])*F+(F=U[1]-K[1])*F,Q=(Q=H[0]-b[0])*Q+(Q=H[1]-b[1])*Q;D=w(D,Math.sqrt(F/Q)),$=[(K[0]+U[0])/2,(K[1]+U[1])/2],B=[(b[0]+H[0])/2,(b[1]+H[1])/2]}else if(l.touch0)$=l.touch0[0],B=l.touch0[1];else return;l.zoom("touch",n(T(D,$,B),l.extent,h))}}function R(i,...g){if(!!this.__zooming){var l=z(this,g).event(i),M=i.changedTouches,I=M.length,S,D;for(st(i),y&&clearTimeout(y),y=setTimeout(function(){y=null},d),S=0;S<I;++S)D=M[S],l.touch0&&l.touch0[2]===D.identifier?delete l.touch0:l.touch1&&l.touch1[2]===D.identifier&&delete l.touch1;if(l.touch1&&!l.touch0&&(l.touch0=l.touch1,delete l.touch1),l.touch0)l.touch0[1]=this.__zoom.invert(l.touch0[0]);else if(l.end(),l.taps===2&&(D=W(D,this),Math.hypot(N[0]-D[0],N[1]-D[1])<m)){var $=Y(this).on("dblclick.zoom");$&&$.apply(this,arguments)}}}return c.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:nt(+i),c):r},c.filter=function(i){return arguments.length?(t=typeof i=="function"?i:nt(!!i),c):t},c.touchable=function(i){return arguments.length?(s=typeof i=="function"?i:nt(!!i),c):s},c.extent=function(i){return arguments.length?(e=typeof i=="function"?i:nt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),c):e},c.scaleExtent=function(i){return arguments.length?(u[0]=+i[0],u[1]=+i[1],c):[u[0],u[1]]},c.translateExtent=function(i){return arguments.length?(h[0][0]=+i[0][0],h[1][0]=+i[1][0],h[0][1]=+i[0][1],h[1][1]=+i[1][1],c):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},c.constrain=function(i){return arguments.length?(n=i,c):n},c.duration=function(i){return arguments.length?(a=+i,c):a},c.interpolate=function(i){return arguments.length?(v=i,c):v},c.on=function(){var i=f.on.apply(f,arguments);return i===f?c:i},c.clickDistance=function(i){return arguments.length?(p=(i=+i)*i,c):Math.sqrt(p)},c.tapDistance=function(i){return arguments.length?(m=+i,c):m},c}class gt{constructor(e,n,r){this.linkContainer=e,this.stylesCallbacks=n,this.currDeph=0,this.outputIndex=0,this.all=[],this.instant=!0,this.init(r)}ticked(){this.sel.attr("x1",e=>{var n,r;return(r=(n=e.source)==null?void 0:n.x)!=null?r:0}).attr("y1",e=>{var n,r;return(r=(n=e.source)==null?void 0:n.y)!=null?r:0}).attr("x2",e=>{var n,r;return(r=(n=e.target)==null?void 0:n.x)!=null?r:0}).attr("y2",e=>{var n,r;return(r=(n=e.target)==null?void 0:n.y)!=null?r:0})}mouseover(e){this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.highlite(e)}mouseout(){this.reset()}init(e){this.sel=this.linkContainer.attr("stroke","#555").attr("stroke-width",1).selectAll("line").data(e).join("line"),this.createBackRefs()}createBackRefs(){this.sel.each(function(e){e.d3node=Y(this)})}highlite(e){this.reset(),this.all=[...new Set([...e.mainInputs,...e.mainOutputs])],this.outputIndex=e.mainInputs.size,this.instant?this.all.forEach(n=>this.styleSingle(n)):(this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.timeoutID=setInterval(this.nextStep,5))}reset(){this.currDeph=0,clearInterval(this.timeoutID)}nextStep(){var n;const e=(n=this.all)==null?void 0:n[this.currDeph];if(!e){clearInterval(this.timeoutID);return}this.styleSingle(e)}styleSingle(e){const n=Number(this.currDeph>=this.outputIndex),r=this.stylesCallbacks[["inputLink","outputLink"][n]];r(e,this.currDeph),this.currDeph++}}class je extends gt{constructor(...e){super(...e),this.init([])}mouseover(e){this.init([...e.mainInputs,...e.mainOutputs]),this.highlite(e)}mouseout(){}}class Be extends gt{ticked(){this.sel.attr("d",e=>{var r,s,u,h;const n=Math.hypot((s=e.target.x)!=null?s:0-((r=e.source.x)!=null?r:0),(h=e.target.y)!=null?h:0-((u=e.source.y)!=null?u:0));return`
        M${e.source.x},${e.source.y}
        A${n},${n} 0 0,1 ${e.target.x},${e.target.y}
        `})}init(e){this.sel=this.linkContainer.attr("fill","none").selectAll("path").data(e).join("path").attr("stroke-width",1).attr("stroke","#555"),this.createBackRefs()}}function Re(t,e,n){var C,j,P,R;e.selectAll("*").remove();const r=e.append("g"),s=t.filter(i=>i.source!=="placeholder"),u=20,h=Math.floor(s.length/9),a=h-u,v=(j=(C=e.node())==null?void 0:C.getBoundingClientRect().width)!=null?j:400,f=(R=(P=e.node())==null?void 0:P.getBoundingClientRect().height)!=null?R:200,_=i=>{const g=s.map(I=>I[i]),l=Math.min(...g),M=Math.max(1,...g);return I=>(I-l)/M},N=_("complexity"),y=_("usability"),d=i=>i**.5,k=i=>d(d(i)),p=i=>d(N(i.complexity)),m=i=>d(y(i.usability)),c=i=>v/2+p(i)*a*20-m(i)*a*20,w=i=>{const g=(p(i)+m(i))/2*h+u,l=Math.max(u,Math.min(h,g));return isNaN(l)?10:l},T=r.append("g").selectAll("g").data(s).join(o,x);function o(i){return x(i.append("g").style("cursor",g=>g.isGhost?null:"pointer").attr("opacity",g=>g.isGhost?.1:null).call(g=>g.append("circle")).call(g=>g.append("image")))}function x(i){return i.select("circle").attr("r",w).attr("stroke-width",g=>m(g)*10+1).attr("stroke",g=>g.popularity>0?"#f90":"#fff").attr("fill",g=>g.inputsAmount===0?"rgba(67, 113, 165, 0.3)":g.outputsAmount===0?"rgba(0, 145, 7, 0.4)":"#111"),i.select("image").attr("x",g=>-w(g)*.9).attr("y",g=>-w(g)*.9).attr("height",g=>w(g)*2*.9).attr("width",g=>w(g)*2*.9).attr("xlink:href",g=>g.href).attr("image-rendering","pixelated"),i}T.each(function(i){i.d3node=Y(this)});const z=$e().scaleExtent([.01,10]).on("zoom",i=>{var g;r.attr("transform",i.transform),(g=n.zoom)==null||g.call(n,i)});e.call(z),T.on("click",(i,g)=>{var l;(l=n.click)==null||l.call(n,g,!1)}).on("contextmenu",(i,g)=>{var l;i.preventDefault(),(l=n.click)==null||l.call(n,g,!0)}).on("mouseover",(i,g)=>{var l;(l=n.mouseover)==null||l.call(n,g,i)}).on("mouseout",(i,g)=>{var l;return(l=n.mouseout)==null?void 0:l.call(n,g,i)}).call(Ft().on("start",A).on("drag",E).on("end",L));function A(i,g){var l;i.sourceEvent.stopPropagation(),i.active||(l=n.dragstarted)==null||l.call(n,g,i),g.fx=g.x,g.fy=g.y}function E(i,g){var l,M;(l=n.isGhost)!=null&&l.call(n,g,i)||((M=n.dragged)==null||M.call(n,g,i),g.fx=i.x,g.fy=i.y)}function L(i,g){var l;i.active||(l=n.dragended)==null||l.call(n,g,i),g.fx=null,g.fy=null}return{container:r,nodes:T,fNonlinear:d,fComp:p,fUsab:m,fX:c,fStroke:k,fSize:w,vizWidth:v,vizHeight:f,diffSize:a,graphNodes:s}}let O;function be(t,e,n={}){let r;const s={...n,dragstarted(x){var z;O==null||O.alphaTarget(.3).restart(),(z=n.dragstarted)==null||z.call(n,x)},dragended(x){var z;O==null||O.alphaTarget(0),(z=n.dragended)==null||z.call(n,x)},mouseover(x){var z;r.mouseover(x),r.ticked(),(z=n.mouseover)==null||z.call(n,x)},mouseout(x){var z;r.mouseout(),r.ticked(),(z=n.mouseout)==null||z.call(n,x)}},u=Re(e,t,s),{fX:h,fSize:a,fUsab:v,vizHeight:f,diffSize:_,fStroke:N,graphNodes:y}=u,d=u.container.insert("g",":first-child").attr("class","linksLayer");O==null||O.on("tick",null).stop();const k={showLinks:y.length<500,showCurvedLinks:y.length<100,useReuse:y.length>500},p=[],m=x=>y.includes(x.source)&&y.includes(x.target)&&p.push(x);for(const x of y)x.mainInputs.forEach(m);O=ke(y).force("charge",Ne().strength(-2e3)).force("x",Te(h).strength(1)).force("y",Ae(f/2).strength(x=>v(x)+1)).force("collision",me().radius(a).strength(.75)).force("link",de(p).distance(_/2).strength(1)).on("tick",o);function c(x,z,A){var E;(E=x.d3node)==null||E.attr("stroke-width",N(A)*3/(z+1)+1)}const w={defaultLink:x=>{var z;(z=x.d3node)==null||z.attr("stroke-width",1).attr("stroke","#555")},inputLink:(x,z)=>{var A;c(x,z,x.weight),(A=x.d3node)==null||A.attr("stroke","#7f7")},outputLink:(x,z)=>{var A;c(x,z,1/x.weight),(A=x.d3node)==null||A.attr("stroke","#38f")}},T=k.showLinks?k.showCurvedLinks?Be:gt:je;r=new T(d,w,p);function o(){r==null||r.ticked(),u.nodes.attr("transform",x=>`translate(${x.x},${x.y})`)}o()}const Pe={class:"relative"},Xe={key:0,class:"fixed"},Ge=Bt("svg",{id:"viz",class:"w-full h-full"},null,-1),Fe=It({__name:"graph",setup(t){const e=Et(),n=St(e).pickedItems;let r=Dt();Ct(s),Lt(n,s);function s(){!n.value||be(Y("#viz"),n.value,{mouseover:u=>r.value=u,click:(u,h)=>h?e.pileFrom(u):e.pileTo(u)})}return(u,h)=>{var f,_;const a=bt,v=Rt;return ut(),pt("div",Pe,[r.value?(ut(),pt("div",Xe,[$t(a,{item:r.value},null,8,["item"]),(f=r.value)!=null&&f.mainRecipe?(ut(),jt(v,{key:0,recipes:[(_=r.value)==null?void 0:_.mainRecipe]},null,8,["recipes"])):dt("",!0)])):dt("",!0),Ge])}}});export{Fe as default};
