import{_ as on}from"./ItemDetailed-e9e5c33f.js";import{aa as an,ab as L,ac as V,ad as q,ae as un,af as sn,ag as cn,V as Q,_ as Y,a0 as z,ah as ln,a1 as B,ai as fn,aj as mn,ak as hn,al as pn,am as dn,o as A,c as C,a as S,t as gn,an as T,X as N,ao as Z,ap as vn,W as Mn,F as X,f as O,e as U}from"./index-dceabbb9.js";import"./GearedNumber-86a029c2.js";function E(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function _n(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function b(n){let e,o,r;n.length!==2?(e=E,o=(i,u)=>E(n(i),u),r=(i,u)=>n(i)-u):(e=n===E||n===_n?n:wn,o=n,r=n);function a(i,u,t=0,f=i.length){if(t<f){if(e(u,u)!==0)return f;do{const m=t+f>>>1;o(i[m],u)<0?t=m+1:f=m}while(t<f)}return t}function c(i,u,t=0,f=i.length){if(t<f){if(e(u,u)!==0)return f;do{const m=t+f>>>1;o(i[m],u)<=0?t=m+1:f=m}while(t<f)}return t}function s(i,u,t=0,f=i.length){const m=a(i,u,t,f-1);return m>t&&r(i[m-1],u)>-r(i[m],u)?m-1:m}return{left:a,center:s,right:c}}function wn(){return 0}function yn(n){return n===null?NaN:+n}const kn=b(E),Nn=kn.right;b(yn).center;const $n=Nn,An=Math.sqrt(50),xn=Math.sqrt(10),Bn=Math.sqrt(2);function j(n,e,o){const r=(e-n)/Math.max(0,o),a=Math.floor(Math.log10(r)),c=r/Math.pow(10,a),s=c>=An?10:c>=xn?5:c>=Bn?2:1;let i,u,t;return a<0?(t=Math.pow(10,-a)/s,i=Math.round(n*t),u=Math.round(e*t),i/t<n&&++i,u/t>e&&--u,t=-t):(t=Math.pow(10,a)*s,i=Math.round(n/t),u=Math.round(e/t),i*t<n&&++i,u*t>e&&--u),u<i&&.5<=o&&o<2?j(n,e,o*2):[i,u,t]}function H(n,e,o){if(e=+e,n=+n,o=+o,!(o>0))return[];if(n===e)return[n];const r=e<n,[a,c,s]=r?j(e,n,o):j(n,e,o);if(!(c>=a))return[];const i=c-a+1,u=new Array(i);if(r)if(s<0)for(let t=0;t<i;++t)u[t]=(c-t)/-s;else for(let t=0;t<i;++t)u[t]=(c-t)*s;else if(s<0)for(let t=0;t<i;++t)u[t]=(a+t)/-s;else for(let t=0;t<i;++t)u[t]=(a+t)*s;return u}function Sn(n,e){e||(e=[]);var o=n?Math.min(e.length,n.length):0,r=e.slice(),a;return function(c){for(a=0;a<o;++a)r[a]=n[a]*(1-c)+e[a]*c;return r}}function Rn(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Cn(n,e){var o=e?e.length:0,r=n?Math.min(o,n.length):0,a=new Array(r),c=new Array(o),s;for(s=0;s<r;++s)a[s]=F(n[s],e[s]);for(;s<o;++s)c[s]=e[s];return function(i){for(s=0;s<r;++s)c[s]=a[s](i);return c}}function En(n,e){var o=new Date;return n=+n,e=+e,function(r){return o.setTime(n*(1-r)+e*r),o}}function In(n,e){var o={},r={},a;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(a in e)a in n?o[a]=F(n[a],e[a]):r[a]=e[a];return function(c){for(a in o)r[a]=o[a](c);return r}}function F(n,e){var o=typeof e,r;return e==null||o==="boolean"?an(e):(o==="number"?L:o==="string"?(r=V(e))?(e=r,q):un:e instanceof V?q:e instanceof Date?En:Rn(e)?Sn:Array.isArray(e)?Cn:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?In:L)(n,e)}function Ln(n,e){return n=+n,e=+e,function(o){return Math.round(n*(1-o)+e*o)}}function zn(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function jn(n){return function(){return n}}function Dn(n){return+n}var P=[0,1];function R(n){return n}function D(n,e){return(e-=n=+n)?function(o){return(o-n)/e}:jn(isNaN(e)?NaN:.5)}function Fn(n,e){var o;return n>e&&(o=n,n=e,e=o),function(r){return Math.max(n,Math.min(e,r))}}function Gn(n,e,o){var r=n[0],a=n[1],c=e[0],s=e[1];return a<r?(r=D(a,r),c=o(s,c)):(r=D(r,a),c=o(c,s)),function(i){return c(r(i))}}function Vn(n,e,o){var r=Math.min(n.length,e.length)-1,a=new Array(r),c=new Array(r),s=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++s<r;)a[s]=D(n[s],n[s+1]),c[s]=o(e[s],e[s+1]);return function(i){var u=$n(n,i,1,r)-1;return c[u](a[u](i))}}function qn(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Tn(){var n=P,e=P,o=F,r,a,c,s=R,i,u,t;function f(){var l=Math.min(n.length,e.length);return s!==R&&(s=Fn(n[0],n[l-1])),i=l>2?Vn:Gn,u=t=null,m}function m(l){return l==null||isNaN(l=+l)?c:(u||(u=i(n.map(r),e,o)))(r(s(l)))}return m.invert=function(l){return s(a((t||(t=i(e,n.map(r),L)))(l)))},m.domain=function(l){return arguments.length?(n=Array.from(l,Dn),f()):n.slice()},m.range=function(l){return arguments.length?(e=Array.from(l),f()):e.slice()},m.rangeRound=function(l){return e=Array.from(l),o=Ln,f()},m.clamp=function(l){return arguments.length?(s=l?!0:R,f()):s!==R},m.interpolate=function(l){return arguments.length?(o=l,f()):o},m.unknown=function(l){return arguments.length?(c=l,m):c},function(l,g){return r=l,a=g,f()}}function Xn(n,e){n=n.slice();var o=0,r=n.length-1,a=n[o],c=n[r],s;return c<a&&(s=o,o=r,r=s,s=a,a=c,c=s),n[o]=e.floor(a),n[r]=e.ceil(c),n}function W(n){return Math.log(n)}function J(n){return Math.exp(n)}function On(n){return-Math.log(-n)}function Un(n){return-Math.exp(-n)}function Hn(n){return isFinite(n)?+("1e"+n):n<0?0:n}function Pn(n){return n===10?Hn:n===Math.E?Math.exp:e=>Math.pow(n,e)}function Wn(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function K(n){return(e,o)=>-n(-e,o)}function Jn(n){const e=n(W,J),o=e.domain;let r=10,a,c;function s(){return a=Wn(r),c=Pn(r),o()[0]<0?(a=K(a),c=K(c),n(On,Un)):n(W,J),e}return e.base=function(i){return arguments.length?(r=+i,s()):r},e.domain=function(i){return arguments.length?(o(i),s()):o()},e.ticks=i=>{const u=o();let t=u[0],f=u[u.length-1];const m=f<t;m&&([t,f]=[f,t]);let l=a(t),g=a(f),v,M;const $=i==null?10:+i;let w=[];if(!(r%1)&&g-l<$){if(l=Math.floor(l),g=Math.ceil(g),t>0){for(;l<=g;++l)for(v=1;v<r;++v)if(M=l<0?v/c(-l):v*c(l),!(M<t)){if(M>f)break;w.push(M)}}else for(;l<=g;++l)for(v=r-1;v>=1;--v)if(M=l>0?v/c(-l):v*c(l),!(M<t)){if(M>f)break;w.push(M)}w.length*2<$&&(w=H(t,f,$))}else w=H(l,g,Math.min(g-l,$)).map(c);return m?w.reverse():w},e.tickFormat=(i,u)=>{if(i==null&&(i=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=sn(u)).precision==null&&(u.trim=!0),u=cn(u)),i===1/0)return u;const t=Math.max(1,r*i/e.ticks().length);return f=>{let m=f/c(Math.round(a(f)));return m*r<r-.5&&(m*=r),m<=t?u(f):""}},e.nice=()=>o(Xn(o(),{floor:i=>c(Math.floor(a(i))),ceil:i=>c(Math.ceil(a(i)))})),e}function nn(){const n=Jn(Tn()).domain([1,10]);return n.copy=()=>qn(n,nn()).base(n.base()),zn.apply(n,arguments),n}const Kn=["color"],Qn={class:"absolute"},Yn=Q({__name:"ModBar",props:{name:{},items:{},offset:{}},emits:["showitems","selectrecipes"],setup(n,{emit:e}){const o=n,r=e,{selectRecipes:a}=Y(),c=z(()=>v(o.items)),s=z(()=>ln(o.name)),i=B(),u=B();let t=B(),f=B();const l=nn().domain([.1,1e3]).range([0,1e3]).base(2),g=h=>l(Math.max(0,h)+.1);function v(h){const d=h.map(k=>k.complexity),p=g(Math.min(...d)),_=g(Math.max(...d))-p,y=h.map(k=>({item:k,pos:g(k.complexity)-p,width:Math.max(3,g(k.usability)/50),hue:1/(1+Math.log(k.popularity+1))}));return{from:p-g(o.offset),width:Math.max(100,_),items:y}}fn(()=>{mn(()=>{var d;const h=(d=u.value)==null?void 0:d.getContext("2d");h&&(i.value=h),M(),window.addEventListener("resize",M)})}),hn(()=>window.removeEventListener("resize",M)),pn(()=>M());function M(){var p,_;const h=u.value;if(!h)return;const d=(_=(p=h==null?void 0:h.parentNode)==null?void 0:p.parentNode)==null?void 0:_.getBoundingClientRect();h.width=d.width-2,h.height=d.height-2,$()}function $(){var d;const h=((d=u.value)==null?void 0:d.height)??1;c.value.items.forEach(async p=>{if(!i.value)return;const _=p.pos-p.width|0,y=p.pos+p.width|0,x=i.value.createLinearGradient(_,0,y,0);w(x,p),i.value.globalCompositeOperation="screen",i.value.fillStyle=x,i.value.fillRect(_,0,y-_,h)})}function w(h,d){let p=0;const _=.1,y=1,x=1,k=.25,I=`hsla(${44*d.hue%255}, ${100*x|0}%, ${100*k|0}%,`;for(h.addColorStop(.5,`${I} ${1*y})`);p<.5;){const G=(p*2)**.3/2;h.addColorStop(G,`${I} ${p*2*y})`),h.addColorStop(1-G,`${I} ${p*2*y})`),p+=_}}function en(h){return c.value?Z(c.value.items).map(d=>[Math.abs(h-d.pos),d]).sortBy(0).filter(([d,p])=>d<p.width).map(([,d])=>d.item).slice(0,10).value():[]}dn(t,()=>r("showitems",t.value));function tn(h){t.value=en(h.offsetX),f.value=t.value.map(d=>{var p;return(p=d.bestRecipe())==null?void 0:p[0]}).filter(d=>!!d)}function rn(h){f.value.length&&a(f.value)}return(h,d)=>{var p;return A(),C("div",{style:T({"margin-left":`${N(c).from}px`,width:`${N(c).width}px`,cursor:`${(p=f.value)!=null&&p.length?"pointer":"default"}`}),color:`hsla(${N(s)}, 60%, 40%, 0.1)`,class:"bar border-1 border-round-sm border-primary-900",onMousemove:tn,onClick:rn},[S("div",Qn,[S("canvas",{ref_key:"canvas",ref:u},null,512)]),S("span",{style:T({color:`hsl(${N(s)}, 60%, 40%)`}),class:"mx-2"},gn(h.name),5)],44,Kn)}}});const Zn=vn(Yn,[["__scopeId","data-v-5bf4ee7a"]]),bn={class:"m-0 relative"},ne={class:"absolute"},ee={class:"fixed"},ie=Q({__name:"history",setup(n){const e=Y().pickedItems,o=z(()=>e?s(e):void 0),r=Mn(0),a=B(),c=["placeholder"];function s(i){let u=Number.MAX_SAFE_INTEGER;const t=Z(i).groupBy("source").entries().filter(([f])=>!c.includes(f)).sortBy(([,f])=>{const m=Math.min(...f.map(l=>l.complexity));return u=Math.min(u,m),m}).value();return r.value=u,t}return(i,u)=>{const t=Zn,f=on;return A(),C("div",bn,[S("div",ne,[(A(!0),C(X,null,O(N(o),([m,l],g)=>(A(),U(t,{key:g,name:m,items:l,offset:N(r),onShowitems:v=>a.value=v},null,8,["name","items","offset","onShowitems"]))),128))]),S("div",ee,[(A(!0),C(X,null,O(N(a),m=>(A(),U(f,{key:m.id,item:m},null,8,["item"]))),128))])])}}});export{ie as default};
