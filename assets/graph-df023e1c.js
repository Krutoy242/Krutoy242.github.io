import{aq as mt,ar as Tt,as as ht,at as At,au as zt,av as rt,aw as ot,V as It,_ as Et,$ as St,a1 as Dt,ai as Ct,am as $t,c as pt,k as Lt,e as bt,i as dt,a as Bt,ax as Rt,o as ut}from"./index-1090266f.js";import{_ as jt}from"./ItemDetailed-9610021a.js";import"./GearedNumber-d019b737.js";function Y(t){return typeof t=="string"?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],Tt)}function Pt(t){let e;for(;e=t.sourceEvent;)t=e;return t}function W(t,e){if(t=Pt(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var c=e.getBoundingClientRect();return[t.clientX-c.left-e.clientLeft,t.clientY-c.top-e.clientTop]}}return[t.pageX,t.pageY]}const Gt={passive:!1},tt={capture:!0,passive:!1};function at(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function Mt(t){var e=t.document.documentElement,n=Y(t).on("dragstart.drag",q,tt);"onselectstart"in e?n.on("selectstart.drag",q,tt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function kt(t,e){var n=t.document.documentElement,r=Y(t).on("dragstart.drag",null);e&&(r.on("click.drag",q,tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const et=t=>()=>t;function ct(t,{sourceEvent:e,subject:n,target:r,identifier:c,active:a,x:h,y:s,dx:y,dy:l,dispatch:_}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:y,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:_}})}ct.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Vt(t){return!t.ctrlKey&&!t.button}function Xt(){return this.parentNode}function Yt(t,e){return e??{x:t.x,y:t.y}}function Ot(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ut(){var t=Vt,e=Xt,n=Yt,r=Ot,c={},a=ht("start","drag","end"),h=0,s,y,l,_,A=0;function p(o){o.on("mousedown.drag",v).filter(r).on("touchstart.drag",f).on("touchmove.drag",u,Gt).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(o,x){if(!(_||!t.call(this,o,x))){var z=T(this,e.call(this,o,x),o,x,"mouse");z&&(Y(o.view).on("mousemove.drag",k,tt).on("mouseup.drag",m,tt),Mt(o.view),at(o),l=!1,s=o.clientX,y=o.clientY,z("start",o))}}function k(o){if(q(o),!l){var x=o.clientX-s,z=o.clientY-y;l=x*x+z*z>A}c.mouse("drag",o)}function m(o){Y(o.view).on("mousemove.drag mouseup.drag",null),kt(o.view,l),q(o),c.mouse("end",o)}function f(o,x){if(t.call(this,o,x)){var z=o.changedTouches,I=e.call(this,o,x),S=z.length,L,$;for(L=0;L<S;++L)($=T(this,I,o,x,z[L].identifier,z[L]))&&(at(o),$("start",o,z[L]))}}function u(o){var x=o.changedTouches,z=x.length,I,S;for(I=0;I<z;++I)(S=c[x[I].identifier])&&(q(o),S("drag",o,x[I]))}function w(o){var x=o.changedTouches,z=x.length,I,S;for(_&&clearTimeout(_),_=setTimeout(function(){_=null},500),I=0;I<z;++I)(S=c[x[I].identifier])&&(at(o),S("end",o,x[I]))}function T(o,x,z,I,S,L){var $=a.copy(),B=W(L||z,x),P,M,i;if((i=n.call(o,new ct("beforestart",{sourceEvent:z,target:p,identifier:S,active:h,x:B[0],y:B[1],dx:0,dy:0,dispatch:$}),I))!=null)return P=i.x-B[0]||0,M=i.y-B[1]||0,function d(g,N,E){var D=B,C;switch(g){case"start":c[S]=d,C=h++;break;case"end":delete c[S],--h;case"drag":B=W(E||N,x),C=h;break}$.call(g,o,new ct(g,{sourceEvent:N,subject:i,target:p,identifier:S,active:C,x:B[0]+P,y:B[1]+M,dx:B[0]-D[0],dy:B[1]-D[1],dispatch:$}),I)}}return p.filter=function(o){return arguments.length?(t=typeof o=="function"?o:et(!!o),p):t},p.container=function(o){return arguments.length?(e=typeof o=="function"?o:et(o),p):e},p.subject=function(o){return arguments.length?(n=typeof o=="function"?o:et(o),p):n},p.touchable=function(o){return arguments.length?(r=typeof o=="function"?o:et(!!o),p):r},p.on=function(){var o=a.on.apply(a,arguments);return o===a?p:o},p.clickDistance=function(o){return arguments.length?(A=(o=+o)*o,p):Math.sqrt(A)},p}var Ft=1e-12;function yt(t){return((t=Math.exp(t))+1/t)/2}function Kt(t){return((t=Math.exp(t))-1/t)/2}function Qt(t){return((t=Math.exp(2*t))-1)/(t+1)}const Ht=function t(e,n,r){function c(a,h){var s=a[0],y=a[1],l=a[2],_=h[0],A=h[1],p=h[2],v=_-s,k=A-y,m=v*v+k*k,f,u;if(m<Ft)u=Math.log(p/l)/e,f=function(I){return[s+I*v,y+I*k,l*Math.exp(e*I*u)]};else{var w=Math.sqrt(m),T=(p*p-l*l+r*m)/(2*l*n*w),o=(p*p-l*l-r*m)/(2*p*n*w),x=Math.log(Math.sqrt(T*T+1)-T),z=Math.log(Math.sqrt(o*o+1)-o);u=(z-x)/e,f=function(I){var S=I*u,L=yt(x),$=l/(n*w)*(L*Qt(e*S+x)-Kt(x));return[s+$*v,y+$*k,l*L/yt(e*S+x)]}}return f.duration=u*1e3*e/Math.SQRT2,f}return c.rho=function(a){var h=Math.max(.001,+a),s=h*h,y=s*s;return t(h,s,y)},c}(Math.SQRT2,2,4);function Wt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Nt(this.cover(e,n),e,n,t)}function Nt(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var c,a=t._root,h={data:r},s=t._x0,y=t._y0,l=t._x1,_=t._y1,A,p,v,k,m,f,u,w;if(!a)return t._root=h,t;for(;a.length;)if((m=e>=(A=(s+l)/2))?s=A:l=A,(f=n>=(p=(y+_)/2))?y=p:_=p,c=a,!(a=a[u=f<<1|m]))return c[u]=h,t;if(v=+t._x.call(null,a.data),k=+t._y.call(null,a.data),e===v&&n===k)return h.next=a,c?c[u]=h:t._root=h,t;do c=c?c[u]=new Array(4):t._root=new Array(4),(m=e>=(A=(s+l)/2))?s=A:l=A,(f=n>=(p=(y+_)/2))?y=p:_=p;while((u=f<<1|m)===(w=(k>=p)<<1|v>=A));return c[w]=a,c[u]=h,t}function Zt(t){var e,n,r=t.length,c,a,h=new Array(r),s=new Array(r),y=1/0,l=1/0,_=-1/0,A=-1/0;for(n=0;n<r;++n)isNaN(c=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(h[n]=c,s[n]=a,c<y&&(y=c),c>_&&(_=c),a<l&&(l=a),a>A&&(A=a));if(y>_||l>A)return this;for(this.cover(y,l).cover(_,A),n=0;n<r;++n)Nt(this,h[n],s[n],t[n]);return this}function qt(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,c=this._x1,a=this._y1;if(isNaN(n))c=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var h=c-n||1,s=this._root,y,l;n>t||t>=c||r>e||e>=a;)switch(l=(e<r)<<1|t<n,y=new Array(4),y[l]=s,s=y,h*=2,l){case 0:c=n+h,a=r+h;break;case 1:n=c-h,a=r+h;break;case 2:c=n+h,r=a-h;break;case 3:n=c-h,r=a-h;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=c,this._y1=a,this}function Jt(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function te(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function G(t,e,n,r,c){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=c}function ee(t,e,n){var r,c=this._x0,a=this._y0,h,s,y,l,_=this._x1,A=this._y1,p=[],v=this._root,k,m;for(v&&p.push(new G(v,c,a,_,A)),n==null?n=1/0:(c=t-n,a=e-n,_=t+n,A=e+n,n*=n);k=p.pop();)if(!(!(v=k.node)||(h=k.x0)>_||(s=k.y0)>A||(y=k.x1)<c||(l=k.y1)<a))if(v.length){var f=(h+y)/2,u=(s+l)/2;p.push(new G(v[3],f,u,y,l),new G(v[2],h,u,f,l),new G(v[1],f,s,y,u),new G(v[0],h,s,f,u)),(m=(e>=u)<<1|t>=f)&&(k=p[p.length-1],p[p.length-1]=p[p.length-1-m],p[p.length-1-m]=k)}else{var w=t-+this._x.call(null,v.data),T=e-+this._y.call(null,v.data),o=w*w+T*T;if(o<n){var x=Math.sqrt(n=o);c=t-x,a=e-x,_=t+x,A=e+x,r=v.data}}return r}function ne(t){if(isNaN(_=+this._x.call(null,t))||isNaN(A=+this._y.call(null,t)))return this;var e,n=this._root,r,c,a,h=this._x0,s=this._y0,y=this._x1,l=this._y1,_,A,p,v,k,m,f,u;if(!n)return this;if(n.length)for(;;){if((k=_>=(p=(h+y)/2))?h=p:y=p,(m=A>=(v=(s+l)/2))?s=v:l=v,e=n,!(n=n[f=m<<1|k]))return this;if(!n.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(r=e,u=f)}for(;n.data!==t;)if(c=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,c?(a?c.next=a:delete c.next,this):e?(a?e[f]=a:delete e[f],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[u]=n:this._root=n),this):(this._root=a,this)}function ie(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function re(){return this._root}function oe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ue(t){var e=[],n,r=this._root,c,a,h,s,y;for(r&&e.push(new G(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,h=n.y0,s=n.x1,y=n.y1)&&r.length){var l=(a+s)/2,_=(h+y)/2;(c=r[3])&&e.push(new G(c,l,_,s,y)),(c=r[2])&&e.push(new G(c,a,_,l,y)),(c=r[1])&&e.push(new G(c,l,h,s,_)),(c=r[0])&&e.push(new G(c,a,h,l,_))}return this}function ae(t){var e=[],n=[],r;for(this._root&&e.push(new G(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var c=r.node;if(c.length){var a,h=r.x0,s=r.y0,y=r.x1,l=r.y1,_=(h+y)/2,A=(s+l)/2;(a=c[0])&&e.push(new G(a,h,s,_,A)),(a=c[1])&&e.push(new G(a,_,s,y,A)),(a=c[2])&&e.push(new G(a,h,A,_,l)),(a=c[3])&&e.push(new G(a,_,A,y,l))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function se(t){return t[0]}function ce(t){return arguments.length?(this._x=t,this):this._x}function he(t){return t[1]}function le(t){return arguments.length?(this._y=t,this):this._y}function lt(t,e,n){var r=new ft(e??se,n??he,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ft(t,e,n,r,c,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=c,this._y1=a,this._root=void 0}function vt(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var X=lt.prototype=ft.prototype;X.copy=function(){var t=new ft(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=vt(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var c=0;c<4;++c)(r=e.source[c])&&(r.length?n.push({source:r,target:e.target[c]=new Array(4)}):e.target[c]=vt(r));return t};X.add=Wt;X.addAll=Zt;X.cover=qt;X.data=Jt;X.extent=te;X.find=ee;X.remove=ne;X.removeAll=ie;X.root=re;X.size=oe;X.visit=ue;X.visitAfter=ae;X.x=ce;X.y=le;function V(t){return function(){return t}}function Z(t){return(t()-.5)*1e-6}function fe(t){return t.x+t.vx}function ge(t){return t.y+t.vy}function me(t){var e,n,r,c=1,a=1;typeof t!="function"&&(t=V(t==null?1:+t));function h(){for(var l,_=e.length,A,p,v,k,m,f,u=0;u<a;++u)for(A=lt(e,fe,ge).visitAfter(s),l=0;l<_;++l)p=e[l],m=n[p.index],f=m*m,v=p.x+p.vx,k=p.y+p.vy,A.visit(w);function w(T,o,x,z,I){var S=T.data,L=T.r,$=m+L;if(S){if(S.index>p.index){var B=v-S.x-S.vx,P=k-S.y-S.vy,M=B*B+P*P;M<$*$&&(B===0&&(B=Z(r),M+=B*B),P===0&&(P=Z(r),M+=P*P),M=($-(M=Math.sqrt(M)))/M*c,p.vx+=(B*=M)*($=(L*=L)/(f+L)),p.vy+=(P*=M)*$,S.vx-=B*($=1-$),S.vy-=P*$)}return}return o>v+$||z<v-$||x>k+$||I<k-$}}function s(l){if(l.data)return l.r=n[l.data.index];for(var _=l.r=0;_<4;++_)l[_]&&l[_].r>l.r&&(l.r=l[_].r)}function y(){if(e){var l,_=e.length,A;for(n=new Array(_),l=0;l<_;++l)A=e[l],n[A.index]=+t(A,l,e)}}return h.initialize=function(l,_){e=l,r=_,y()},h.iterations=function(l){return arguments.length?(a=+l,h):a},h.strength=function(l){return arguments.length?(c=+l,h):c},h.radius=function(l){return arguments.length?(t=typeof l=="function"?l:V(+l),y(),h):t},h}function pe(t){return t.index}function xt(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function de(t){var e=pe,n=A,r,c=V(30),a,h,s,y,l,_=1;t==null&&(t=[]);function A(f){return 1/Math.min(s[f.source.index],s[f.target.index])}function p(f){for(var u=0,w=t.length;u<_;++u)for(var T=0,o,x,z,I,S,L,$;T<w;++T)o=t[T],x=o.source,z=o.target,I=z.x+z.vx-x.x-x.vx||Z(l),S=z.y+z.vy-x.y-x.vy||Z(l),L=Math.sqrt(I*I+S*S),L=(L-a[T])/L*f*r[T],I*=L,S*=L,z.vx-=I*($=y[T]),z.vy-=S*$,x.vx+=I*($=1-$),x.vy+=S*$}function v(){if(h){var f,u=h.length,w=t.length,T=new Map(h.map((x,z)=>[e(x,z,h),x])),o;for(f=0,s=new Array(u);f<w;++f)o=t[f],o.index=f,typeof o.source!="object"&&(o.source=xt(T,o.source)),typeof o.target!="object"&&(o.target=xt(T,o.target)),s[o.source.index]=(s[o.source.index]||0)+1,s[o.target.index]=(s[o.target.index]||0)+1;for(f=0,y=new Array(w);f<w;++f)o=t[f],y[f]=s[o.source.index]/(s[o.source.index]+s[o.target.index]);r=new Array(w),k(),a=new Array(w),m()}}function k(){if(h)for(var f=0,u=t.length;f<u;++f)r[f]=+n(t[f],f,t)}function m(){if(h)for(var f=0,u=t.length;f<u;++f)a[f]=+c(t[f],f,t)}return p.initialize=function(f,u){h=f,l=u,v()},p.links=function(f){return arguments.length?(t=f,v(),p):t},p.id=function(f){return arguments.length?(e=f,p):e},p.iterations=function(f){return arguments.length?(_=+f,p):_},p.strength=function(f){return arguments.length?(n=typeof f=="function"?f:V(+f),k(),p):n},p.distance=function(f){return arguments.length?(c=typeof f=="function"?f:V(+f),m(),p):c},p}const ye=1664525,ve=1013904223,_t=4294967296;function xe(){let t=1;return()=>(t=(ye*t+ve)%_t)/_t}function _e(t){return t.x}function we(t){return t.y}var ze=10,Me=Math.PI*(3-Math.sqrt(5));function ke(t){var e,n=1,r=.001,c=1-Math.pow(r,1/300),a=0,h=.6,s=new Map,y=At(A),l=ht("tick","end"),_=xe();t==null&&(t=[]);function A(){p(),l.call("tick",e),n<r&&(y.stop(),l.call("end",e))}function p(m){var f,u=t.length,w;m===void 0&&(m=1);for(var T=0;T<m;++T)for(n+=(a-n)*c,s.forEach(function(o){o(n)}),f=0;f<u;++f)w=t[f],w.fx==null?w.x+=w.vx*=h:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=h:(w.y=w.fy,w.vy=0);return e}function v(){for(var m=0,f=t.length,u;m<f;++m){if(u=t[m],u.index=m,u.fx!=null&&(u.x=u.fx),u.fy!=null&&(u.y=u.fy),isNaN(u.x)||isNaN(u.y)){var w=ze*Math.sqrt(.5+m),T=m*Me;u.x=w*Math.cos(T),u.y=w*Math.sin(T)}(isNaN(u.vx)||isNaN(u.vy))&&(u.vx=u.vy=0)}}function k(m){return m.initialize&&m.initialize(t,_),m}return v(),e={tick:p,restart:function(){return y.restart(A),e},stop:function(){return y.stop(),e},nodes:function(m){return arguments.length?(t=m,v(),s.forEach(k),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(r=+m,e):r},alphaDecay:function(m){return arguments.length?(c=+m,e):+c},alphaTarget:function(m){return arguments.length?(a=+m,e):a},velocityDecay:function(m){return arguments.length?(h=1-m,e):1-h},randomSource:function(m){return arguments.length?(_=m,s.forEach(k),e):_},force:function(m,f){return arguments.length>1?(f==null?s.delete(m):s.set(m,k(f)),e):s.get(m)},find:function(m,f,u){var w=0,T=t.length,o,x,z,I,S;for(u==null?u=1/0:u*=u,w=0;w<T;++w)I=t[w],o=m-I.x,x=f-I.y,z=o*o+x*x,z<u&&(S=I,u=z);return S},on:function(m,f){return arguments.length>1?(l.on(m,f),e):l.on(m)}}}function Ne(){var t,e,n,r,c=V(-30),a,h=1,s=1/0,y=.81;function l(v){var k,m=t.length,f=lt(t,_e,we).visitAfter(A);for(r=v,k=0;k<m;++k)e=t[k],f.visit(p)}function _(){if(t){var v,k=t.length,m;for(a=new Array(k),v=0;v<k;++v)m=t[v],a[m.index]=+c(m,v,t)}}function A(v){var k=0,m,f,u=0,w,T,o;if(v.length){for(w=T=o=0;o<4;++o)(m=v[o])&&(f=Math.abs(m.value))&&(k+=m.value,u+=f,w+=f*m.x,T+=f*m.y);v.x=w/u,v.y=T/u}else{m=v,m.x=m.data.x,m.y=m.data.y;do k+=a[m.data.index];while(m=m.next)}v.value=k}function p(v,k,m,f){if(!v.value)return!0;var u=v.x-e.x,w=v.y-e.y,T=f-k,o=u*u+w*w;if(T*T/y<o)return o<s&&(u===0&&(u=Z(n),o+=u*u),w===0&&(w=Z(n),o+=w*w),o<h&&(o=Math.sqrt(h*o)),e.vx+=u*v.value*r/o,e.vy+=w*v.value*r/o),!0;if(v.length||o>=s)return;(v.data!==e||v.next)&&(u===0&&(u=Z(n),o+=u*u),w===0&&(w=Z(n),o+=w*w),o<h&&(o=Math.sqrt(h*o)));do v.data!==e&&(T=a[v.data.index]*r/o,e.vx+=u*T,e.vy+=w*T);while(v=v.next)}return l.initialize=function(v,k){t=v,n=k,_()},l.strength=function(v){return arguments.length?(c=typeof v=="function"?v:V(+v),_(),l):c},l.distanceMin=function(v){return arguments.length?(h=v*v,l):Math.sqrt(h)},l.distanceMax=function(v){return arguments.length?(s=v*v,l):Math.sqrt(s)},l.theta=function(v){return arguments.length?(y=v*v,l):Math.sqrt(y)},l}function Te(t){var e=V(.1),n,r,c;typeof t!="function"&&(t=V(t==null?0:+t));function a(s){for(var y=0,l=n.length,_;y<l;++y)_=n[y],_.vx+=(c[y]-_.x)*r[y]*s}function h(){if(n){var s,y=n.length;for(r=new Array(y),c=new Array(y),s=0;s<y;++s)r[s]=isNaN(c[s]=+t(n[s],s,n))?0:+e(n[s],s,n)}}return a.initialize=function(s){n=s,h()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:V(+s),h(),a):e},a.x=function(s){return arguments.length?(t=typeof s=="function"?s:V(+s),h(),a):t},a}function Ae(t){var e=V(.1),n,r,c;typeof t!="function"&&(t=V(t==null?0:+t));function a(s){for(var y=0,l=n.length,_;y<l;++y)_=n[y],_.vy+=(c[y]-_.y)*r[y]*s}function h(){if(n){var s,y=n.length;for(r=new Array(y),c=new Array(y),s=0;s<y;++s)r[s]=isNaN(c[s]=+t(n[s],s,n))?0:+e(n[s],s,n)}}return a.initialize=function(s){n=s,h()},a.strength=function(s){return arguments.length?(e=typeof s=="function"?s:V(+s),h(),a):e},a.y=function(s){return arguments.length?(t=typeof s=="function"?s:V(+s),h(),a):t},a}const nt=t=>()=>t;function Ie(t,{sourceEvent:e,target:n,transform:r,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:c}})}function st(t){t.stopImmediatePropagation()}function J(t){t.preventDefault(),t.stopImmediatePropagation()}function Ee(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Se(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function wt(){return this.__zoom||zt}function De(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ce(){return navigator.maxTouchPoints||"ontouchstart"in this}function $e(t,e,n){var r=t.invertX(e[0][0])-n[0][0],c=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],h=t.invertY(e[1][1])-n[1][1];return t.translate(c>r?(r+c)/2:Math.min(0,r)||Math.max(0,c),h>a?(a+h)/2:Math.min(0,a)||Math.max(0,h))}function Le(){var t=Ee,e=Se,n=$e,r=De,c=Ce,a=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],s=250,y=Ht,l=ht("start","zoom","end"),_,A,p,v=500,k=150,m=0,f=10;function u(i){i.property("__zoom",wt).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",$).filter(c).on("touchstart.zoom",B).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",M).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.transform=function(i,d,g,N){var E=i.selection?i.selection():i;E.property("__zoom",wt),i!==E?x(i,d,g,N):E.interrupt().each(function(){z(this,arguments).event(N).start().zoom(null,typeof d=="function"?d.apply(this,arguments):d).end()})},u.scaleBy=function(i,d,g,N){u.scaleTo(i,function(){var E=this.__zoom.k,D=typeof d=="function"?d.apply(this,arguments):d;return E*D},g,N)},u.scaleTo=function(i,d,g,N){u.transform(i,function(){var E=e.apply(this,arguments),D=this.__zoom,C=g==null?o(E):typeof g=="function"?g.apply(this,arguments):g,b=D.invert(C),R=typeof d=="function"?d.apply(this,arguments):d;return n(T(w(D,R),C,b),E,h)},g,N)},u.translateBy=function(i,d,g,N){u.transform(i,function(){return n(this.__zoom.translate(typeof d=="function"?d.apply(this,arguments):d,typeof g=="function"?g.apply(this,arguments):g),e.apply(this,arguments),h)},null,N)},u.translateTo=function(i,d,g,N,E){u.transform(i,function(){var D=e.apply(this,arguments),C=this.__zoom,b=N==null?o(D):typeof N=="function"?N.apply(this,arguments):N;return n(zt.translate(b[0],b[1]).scale(C.k).translate(typeof d=="function"?-d.apply(this,arguments):-d,typeof g=="function"?-g.apply(this,arguments):-g),D,h)},N,E)};function w(i,d){return d=Math.max(a[0],Math.min(a[1],d)),d===i.k?i:new rt(d,i.x,i.y)}function T(i,d,g){var N=d[0]-g[0]*i.k,E=d[1]-g[1]*i.k;return N===i.x&&E===i.y?i:new rt(i.k,N,E)}function o(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function x(i,d,g,N){i.on("start.zoom",function(){z(this,arguments).event(N).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event(N).end()}).tween("zoom",function(){var E=this,D=arguments,C=z(E,D).event(N),b=e.apply(E,D),R=g==null?o(b):typeof g=="function"?g.apply(E,D):g,F=Math.max(b[1][0]-b[0][0],b[1][1]-b[0][1]),j=E.__zoom,O=typeof d=="function"?d.apply(E,D):d,Q=y(j.invert(R).concat(F/j.k),O.invert(R).concat(F/O.k));return function(U){if(U===1)U=O;else{var H=Q(U),it=F/H[2];U=new rt(it,R[0]-H[0]*it,R[1]-H[1]*it)}C.zoom(null,U)}})}function z(i,d,g){return!g&&i.__zooming||new I(i,d)}function I(i,d){this.that=i,this.args=d,this.active=0,this.sourceEvent=null,this.extent=e.apply(i,d),this.taps=0}I.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,d){return this.mouse&&i!=="mouse"&&(this.mouse[1]=d.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=d.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=d.invert(this.touch1[0])),this.that.__zoom=d,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var d=Y(this.that).datum();l.call(i,this.that,new Ie(i,{sourceEvent:this.sourceEvent,target:u,type:i,transform:this.that.__zoom,dispatch:l}),d)}};function S(i,...d){if(!t.apply(this,arguments))return;var g=z(this,d).event(i),N=this.__zoom,E=Math.max(a[0],Math.min(a[1],N.k*Math.pow(2,r.apply(this,arguments)))),D=W(i);if(g.wheel)(g.mouse[0][0]!==D[0]||g.mouse[0][1]!==D[1])&&(g.mouse[1]=N.invert(g.mouse[0]=D)),clearTimeout(g.wheel);else{if(N.k===E)return;g.mouse=[D,N.invert(D)],ot(this),g.start()}J(i),g.wheel=setTimeout(C,k),g.zoom("mouse",n(T(w(N,E),g.mouse[0],g.mouse[1]),g.extent,h));function C(){g.wheel=null,g.end()}}function L(i,...d){if(p||!t.apply(this,arguments))return;var g=i.currentTarget,N=z(this,d,!0).event(i),E=Y(i.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",F,!0),D=W(i,g),C=i.clientX,b=i.clientY;Mt(i.view),st(i),N.mouse=[D,this.__zoom.invert(D)],ot(this),N.start();function R(j){if(J(j),!N.moved){var O=j.clientX-C,Q=j.clientY-b;N.moved=O*O+Q*Q>m}N.event(j).zoom("mouse",n(T(N.that.__zoom,N.mouse[0]=W(j,g),N.mouse[1]),N.extent,h))}function F(j){E.on("mousemove.zoom mouseup.zoom",null),kt(j.view,N.moved),J(j),N.event(j).end()}}function $(i,...d){if(t.apply(this,arguments)){var g=this.__zoom,N=W(i.changedTouches?i.changedTouches[0]:i,this),E=g.invert(N),D=g.k*(i.shiftKey?.5:2),C=n(T(w(g,D),N,E),e.apply(this,d),h);J(i),s>0?Y(this).transition().duration(s).call(x,C,N,i):Y(this).call(u.transform,C,N,i)}}function B(i,...d){if(t.apply(this,arguments)){var g=i.touches,N=g.length,E=z(this,d,i.changedTouches.length===N).event(i),D,C,b,R;for(st(i),C=0;C<N;++C)b=g[C],R=W(b,this),R=[R,this.__zoom.invert(R),b.identifier],E.touch0?!E.touch1&&E.touch0[2]!==R[2]&&(E.touch1=R,E.taps=0):(E.touch0=R,D=!0,E.taps=1+!!_);_&&(_=clearTimeout(_)),D&&(E.taps<2&&(A=R[0],_=setTimeout(function(){_=null},v)),ot(this),E.start())}}function P(i,...d){if(this.__zooming){var g=z(this,d).event(i),N=i.changedTouches,E=N.length,D,C,b,R;for(J(i),D=0;D<E;++D)C=N[D],b=W(C,this),g.touch0&&g.touch0[2]===C.identifier?g.touch0[0]=b:g.touch1&&g.touch1[2]===C.identifier&&(g.touch1[0]=b);if(C=g.that.__zoom,g.touch1){var F=g.touch0[0],j=g.touch0[1],O=g.touch1[0],Q=g.touch1[1],U=(U=O[0]-F[0])*U+(U=O[1]-F[1])*U,H=(H=Q[0]-j[0])*H+(H=Q[1]-j[1])*H;C=w(C,Math.sqrt(U/H)),b=[(F[0]+O[0])/2,(F[1]+O[1])/2],R=[(j[0]+Q[0])/2,(j[1]+Q[1])/2]}else if(g.touch0)b=g.touch0[0],R=g.touch0[1];else return;g.zoom("touch",n(T(C,b,R),g.extent,h))}}function M(i,...d){if(this.__zooming){var g=z(this,d).event(i),N=i.changedTouches,E=N.length,D,C;for(st(i),p&&clearTimeout(p),p=setTimeout(function(){p=null},v),D=0;D<E;++D)C=N[D],g.touch0&&g.touch0[2]===C.identifier?delete g.touch0:g.touch1&&g.touch1[2]===C.identifier&&delete g.touch1;if(g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0)g.touch0[1]=this.__zoom.invert(g.touch0[0]);else if(g.end(),g.taps===2&&(C=W(C,this),Math.hypot(A[0]-C[0],A[1]-C[1])<f)){var b=Y(this).on("dblclick.zoom");b&&b.apply(this,arguments)}}}return u.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:nt(+i),u):r},u.filter=function(i){return arguments.length?(t=typeof i=="function"?i:nt(!!i),u):t},u.touchable=function(i){return arguments.length?(c=typeof i=="function"?i:nt(!!i),u):c},u.extent=function(i){return arguments.length?(e=typeof i=="function"?i:nt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),u):e},u.scaleExtent=function(i){return arguments.length?(a[0]=+i[0],a[1]=+i[1],u):[a[0],a[1]]},u.translateExtent=function(i){return arguments.length?(h[0][0]=+i[0][0],h[1][0]=+i[1][0],h[0][1]=+i[0][1],h[1][1]=+i[1][1],u):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},u.constrain=function(i){return arguments.length?(n=i,u):n},u.duration=function(i){return arguments.length?(s=+i,u):s},u.interpolate=function(i){return arguments.length?(y=i,u):y},u.on=function(){var i=l.on.apply(l,arguments);return i===l?u:i},u.clickDistance=function(i){return arguments.length?(m=(i=+i)*i,u):Math.sqrt(m)},u.tapDistance=function(i){return arguments.length?(f=+i,u):f},u}function be(t,e,n){var B,P;e.selectAll("*").remove();const r=e.append("g");let c=t.filter((M,i)=>{var d;return i===0||((d=M.dependencies)==null?void 0:d.size)}),a=0;do a=0,c=c.filter((M,i)=>i===0||M.mainOutputs.values().some(d=>d.target!==M&&c.includes(d.target))?!0:(a++,!1));while(a);const h=20,s=Math.floor(c.length/9),y=s-h,l=((B=e.node())==null?void 0:B.getBoundingClientRect().width)??400,_=((P=e.node())==null?void 0:P.getBoundingClientRect().height)??200,A=M=>{const i=c.map(N=>N[M]),d=Math.min(...i),g=Math.max(1,...i);return N=>(N-d)/g},p=A("complexity"),v=A("usability"),k=M=>M**.5,m=M=>k(k(M)),f=M=>k(p(M.complexity)),u=M=>k(v(M.usability)),w=M=>l/2+f(M)*y*20-u(M)*y*20,T=M=>{const i=(f(M)+u(M))/2*s+h,d=Math.max(h,Math.min(s,i));return isNaN(d)?10:d},o=r.append("g").selectAll("g").data(c).join(x,z);function x(M){return z(M.append("g").style("cursor",i=>i.isGhost?null:"pointer").attr("opacity",i=>i.isGhost?.1:null).call(i=>i.append("circle")).call(i=>i.append("svg").append("image")))}function z(M){return M.select("circle").attr("r",T).attr("stroke-width",i=>u(i)*10+1).attr("stroke",i=>i.popularity>0?"#f90":"#fff").attr("fill",i=>i.inputsAmount===0?"rgba(67, 113, 165, 0.3)":i.outputsAmount===0?"rgba(0, 145, 7, 0.4)":"#111"),M.select("svg").attr("x",i=>-T(i)*.9).attr("y",i=>-T(i)*.9).attr("height",i=>T(i)*2*.9).attr("width",i=>T(i)*2*.9).attr("viewBox",i=>`${i.href||"0 0"} 16 16`).select("image").attr("xlink:href","https://github.com/Krutoy242/mc-icons/raw/137570d69b902eae7fdc898bc60c769045af6676/i/sprite.png").attr("image-rendering","pixelated"),M}o.each(function(M){M.d3node=Y(this)});const I=Le().scaleExtent([.01,10]).on("zoom",M=>{var i;r.attr("transform",M.transform),(i=n.zoom)==null||i.call(n,M)});e.call(I),o.on("click",(M,i)=>{var d;(d=n.click)==null||d.call(n,i,!1)}).on("contextmenu",(M,i)=>{var d;M.preventDefault(),(d=n.click)==null||d.call(n,i,!0)}).on("mouseover",(M,i)=>{var d;(d=n.mouseover)==null||d.call(n,i,M)}).on("mouseout",(M,i)=>{var d;return(d=n.mouseout)==null?void 0:d.call(n,i,M)}).call(Ut().on("start",S).on("drag",L).on("end",$));function S(M,i){var d;M.sourceEvent.stopPropagation(),M.active||(d=n.dragstarted)==null||d.call(n,i,M),i.fx=i.x,i.fy=i.y}function L(M,i){var d,g;(d=n.isGhost)!=null&&d.call(n,i,M)||((g=n.dragged)==null||g.call(n,i,M),i.fx=M.x,i.fy=M.y)}function $(M,i){var d;M.active||(d=n.dragended)==null||d.call(n,i,M),i.fx=null,i.fy=null}return{container:r,nodes:o,fNonlinear:k,fComp:f,fUsab:u,fX:w,fStroke:m,fSize:T,vizWidth:l,vizHeight:_,diffSize:y,graphNodes:c}}class gt{constructor(e,n,r){this.linkContainer=e,this.stylesCallbacks=n,this.currDeph=0,this.outputIndex=0,this.all=[],this.instant=!0,this.init(r)}ticked(){this.sel.attr("x1",e=>{var n;return((n=e.source)==null?void 0:n.x)??0}).attr("y1",e=>{var n;return((n=e.source)==null?void 0:n.y)??0}).attr("x2",e=>{var n;return((n=e.target)==null?void 0:n.x)??0}).attr("y2",e=>{var n;return((n=e.target)==null?void 0:n.y)??0})}mouseover(e){this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.highlite(e)}mouseout(){this.reset()}init(e){this.sel=this.linkContainer.attr("stroke","#555").attr("stroke-width",1).selectAll("line").data(e).join("line"),this.createBackRefs()}createBackRefs(){this.sel.each(function(e){e.d3node=Y(this)})}highlite(e){this.reset(),this.all=[...new Set([...e.mainInputs,...e.mainOutputs])],this.outputIndex=e.mainInputs.size,this.instant?this.all.forEach(n=>this.styleSingle(n)):(this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.timeoutID=setInterval(this.nextStep,5))}reset(){this.currDeph=0,clearInterval(this.timeoutID)}nextStep(){var n;const e=(n=this.all)==null?void 0:n[this.currDeph];if(!e){clearInterval(this.timeoutID);return}this.styleSingle(e)}styleSingle(e){const n=+(this.currDeph>=this.outputIndex),r=this.stylesCallbacks[["inputLink","outputLink"][n]];r(e,this.currDeph),this.currDeph++}}class Be extends gt{constructor(...e){super(...e),this.init([])}mouseover(e){this.init([...e.mainInputs,...e.mainOutputs]),this.highlite(e)}mouseout(){}}class Re extends gt{ticked(){this.sel.attr("d",e=>{const n=Math.hypot(e.target.x??0-(e.source.x??0),e.target.y??0-(e.source.y??0));return`
        M${e.source.x},${e.source.y}
        A${n},${n} 0 0,1 ${e.target.x},${e.target.y}
        `})}init(e){this.sel=this.linkContainer.attr("fill","none").selectAll("path").data(e).join("path").attr("stroke-width",1).attr("stroke","#555"),this.createBackRefs()}}let K;function je(t,e,n={}){let r;const c={...n,dragstarted(x){var z;K==null||K.alphaTarget(.3).restart(),(z=n.dragstarted)==null||z.call(n,x)},dragended(x){var z;K==null||K.alphaTarget(0),(z=n.dragended)==null||z.call(n,x)},mouseover(x){var z;r.mouseover(x),r.ticked(),(z=n.mouseover)==null||z.call(n,x)},mouseout(x){var z;r.mouseout(),r.ticked(),(z=n.mouseout)==null||z.call(n,x)}},a=be(e,t,c),{fX:h,fSize:s,fUsab:y,vizHeight:l,diffSize:_,fStroke:A,graphNodes:p}=a,v=a.container.insert("g",":first-child").attr("class","linksLayer");K==null||K.on("tick",null).stop();const k={showLinks:p.length<500,showCurvedLinks:p.length<100,useReuse:p.length>500},m=[],f=x=>p.includes(x.source)&&p.includes(x.target)&&m.push(x);for(const x of p)x.mainInputs.forEach(f);K=ke(p).force("charge",Ne().strength(-2e3)).force("x",Te(h).strength(1)).force("y",Ae(l/2).strength(x=>y(x)+1)).force("collision",me().radius(s).strength(.75)).force("link",de(m).distance(_/2).strength(1)).on("tick",o);function u(x,z,I){var S;(S=x.d3node)==null||S.attr("stroke-width",A(I)*3/(z+1)+1)}const w={defaultLink:x=>{var z;(z=x.d3node)==null||z.attr("stroke-width",1).attr("stroke","#555")},inputLink:(x,z)=>{var I;u(x,z,x.weight),(I=x.d3node)==null||I.attr("stroke","#7f7")},outputLink:(x,z)=>{var I;u(x,z,1/x.weight),(I=x.d3node)==null||I.attr("stroke","#38f")}},T=k.showLinks?k.showCurvedLinks?Re:gt:Be;r=new T(v,w,m);function o(){r==null||r.ticked(),a.nodes.attr("transform",x=>`translate(${x.x},${x.y})`)}o()}const Pe={class:"relative"},Ge={key:0,class:"fixed"},Ve=Bt("svg",{id:"viz",class:"w-full h-full"},null,-1),Ue=It({__name:"graph",setup(t){const e=Et(),n=St(e).pickedItems;let r=Dt();Ct(c),$t(n,c);function c(){n.value&&je(Y("#viz"),n.value,{mouseover:a=>r.value=a,click:(a,h)=>h?e.pileFrom(a):e.pileTo(a)})}return(a,h)=>{var l,_;const s=jt,y=Rt;return ut(),pt("div",Pe,[r.value?(ut(),pt("div",Ge,[Lt(s,{item:r.value},null,8,["item"]),(_=(l=r.value)==null?void 0:l.bestRecipe())!=null&&_[0]?(ut(),bt(y,{key:0,recipes:[r.value.bestRecipe()[0]]},null,8,["recipes"])):dt("",!0)])):dt("",!0),Ve])}}});export{Ue as default};
