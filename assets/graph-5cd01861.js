import{ap as mt,aq as Tt,ar as ht,as as At,at as zt,au as rt,av as ot,V as It,_ as Et,$ as St,a1 as Dt,ah as Ct,al as $t,c as pt,k as Lt,e as Bt,i as dt,a as Rt,aw as jt,o as ut}from"./index-11cc111c.js";import{_ as bt}from"./ItemDetailed-e9da8313.js";import"./GearedNumber-bb2f7b26.js";function Y(t){return typeof t=="string"?new mt([[document.querySelector(t)]],[document.documentElement]):new mt([[t]],Tt)}function Pt(t){let e;for(;e=t.sourceEvent;)t=e;return t}function W(t,e){if(t=Pt(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var c=e.getBoundingClientRect();return[t.clientX-c.left-e.clientLeft,t.clientY-c.top-e.clientTop]}}return[t.pageX,t.pageY]}const Gt={passive:!1},tt={capture:!0,passive:!1};function at(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function Mt(t){var e=t.document.documentElement,n=Y(t).on("dragstart.drag",q,tt);"onselectstart"in e?n.on("selectstart.drag",q,tt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function kt(t,e){var n=t.document.documentElement,r=Y(t).on("dragstart.drag",null);e&&(r.on("click.drag",q,tt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const et=t=>()=>t;function ct(t,{sourceEvent:e,subject:n,target:r,identifier:c,active:u,x:h,y:a,dx:y,dy:l,dispatch:x}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:c,enumerable:!0,configurable:!0},active:{value:u,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:y,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:x}})}ct.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Vt(t){return!t.ctrlKey&&!t.button}function Xt(){return this.parentNode}function Yt(t,e){return e??{x:t.x,y:t.y}}function Ut(){return navigator.maxTouchPoints||"ontouchstart"in this}function Ft(){var t=Vt,e=Xt,n=Yt,r=Ut,c={},u=ht("start","drag","end"),h=0,a,y,l,x,A=0;function d(o){o.on("mousedown.drag",p).filter(r).on("touchstart.drag",f).on("touchmove.drag",s,Gt).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(o,v){if(!(x||!t.call(this,o,v))){var z=I(this,e.call(this,o,v),o,v,"mouse");z&&(Y(o.view).on("mousemove.drag",N,tt).on("mouseup.drag",g,tt),Mt(o.view),at(o),l=!1,a=o.clientX,y=o.clientY,z("start",o))}}function N(o){if(q(o),!l){var v=o.clientX-a,z=o.clientY-y;l=v*v+z*z>A}c.mouse("drag",o)}function g(o){Y(o.view).on("mousemove.drag mouseup.drag",null),kt(o.view,l),q(o),c.mouse("end",o)}function f(o,v){if(t.call(this,o,v)){var z=o.changedTouches,E=e.call(this,o,v),D=z.length,B,L;for(B=0;B<D;++B)(L=I(this,E,o,v,z[B].identifier,z[B]))&&(at(o),L("start",o,z[B]))}}function s(o){var v=o.changedTouches,z=v.length,E,D;for(E=0;E<z;++E)(D=c[v[E].identifier])&&(q(o),D("drag",o,v[E]))}function _(o){var v=o.changedTouches,z=v.length,E,D;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),E=0;E<z;++E)(D=c[v[E].identifier])&&(at(o),D("end",o,v[E]))}function I(o,v,z,E,D,B){var L=u.copy(),j=W(B||z,v),k,w,i;if((i=n.call(o,new ct("beforestart",{sourceEvent:z,target:d,identifier:D,active:h,x:j[0],y:j[1],dx:0,dy:0,dispatch:L}),E))!=null)return k=i.x-j[0]||0,w=i.y-j[1]||0,function M(m,T,S){var C=j,$;switch(m){case"start":c[D]=M,$=h++;break;case"end":delete c[D],--h;case"drag":j=W(S||T,v),$=h;break}L.call(m,o,new ct(m,{sourceEvent:T,subject:i,target:d,identifier:D,active:$,x:j[0]+k,y:j[1]+w,dx:j[0]-C[0],dy:j[1]-C[1],dispatch:L}),E)}}return d.filter=function(o){return arguments.length?(t=typeof o=="function"?o:et(!!o),d):t},d.container=function(o){return arguments.length?(e=typeof o=="function"?o:et(o),d):e},d.subject=function(o){return arguments.length?(n=typeof o=="function"?o:et(o),d):n},d.touchable=function(o){return arguments.length?(r=typeof o=="function"?o:et(!!o),d):r},d.on=function(){var o=u.on.apply(u,arguments);return o===u?d:o},d.clickDistance=function(o){return arguments.length?(A=(o=+o)*o,d):Math.sqrt(A)},d}var Ot=1e-12;function yt(t){return((t=Math.exp(t))+1/t)/2}function Kt(t){return((t=Math.exp(t))-1/t)/2}function Qt(t){return((t=Math.exp(2*t))-1)/(t+1)}const Ht=function t(e,n,r){function c(u,h){var a=u[0],y=u[1],l=u[2],x=h[0],A=h[1],d=h[2],p=x-a,N=A-y,g=p*p+N*N,f,s;if(g<Ot)s=Math.log(d/l)/e,f=function(E){return[a+E*p,y+E*N,l*Math.exp(e*E*s)]};else{var _=Math.sqrt(g),I=(d*d-l*l+r*g)/(2*l*n*_),o=(d*d-l*l-r*g)/(2*d*n*_),v=Math.log(Math.sqrt(I*I+1)-I),z=Math.log(Math.sqrt(o*o+1)-o);s=(z-v)/e,f=function(E){var D=E*s,B=yt(v),L=l/(n*_)*(B*Qt(e*D+v)-Kt(v));return[a+L*p,y+L*N,l*B/yt(e*D+v)]}}return f.duration=s*1e3*e/Math.SQRT2,f}return c.rho=function(u){var h=Math.max(.001,+u),a=h*h,y=a*a;return t(h,a,y)},c}(Math.SQRT2,2,4);function Wt(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Nt(this.cover(e,n),e,n,t)}function Nt(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var c,u=t._root,h={data:r},a=t._x0,y=t._y0,l=t._x1,x=t._y1,A,d,p,N,g,f,s,_;if(!u)return t._root=h,t;for(;u.length;)if((g=e>=(A=(a+l)/2))?a=A:l=A,(f=n>=(d=(y+x)/2))?y=d:x=d,c=u,!(u=u[s=f<<1|g]))return c[s]=h,t;if(p=+t._x.call(null,u.data),N=+t._y.call(null,u.data),e===p&&n===N)return h.next=u,c?c[s]=h:t._root=h,t;do c=c?c[s]=new Array(4):t._root=new Array(4),(g=e>=(A=(a+l)/2))?a=A:l=A,(f=n>=(d=(y+x)/2))?y=d:x=d;while((s=f<<1|g)===(_=(N>=d)<<1|p>=A));return c[_]=u,c[s]=h,t}function Zt(t){var e,n,r=t.length,c,u,h=new Array(r),a=new Array(r),y=1/0,l=1/0,x=-1/0,A=-1/0;for(n=0;n<r;++n)isNaN(c=+this._x.call(null,e=t[n]))||isNaN(u=+this._y.call(null,e))||(h[n]=c,a[n]=u,c<y&&(y=c),c>x&&(x=c),u<l&&(l=u),u>A&&(A=u));if(y>x||l>A)return this;for(this.cover(y,l).cover(x,A),n=0;n<r;++n)Nt(this,h[n],a[n],t[n]);return this}function qt(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,c=this._x1,u=this._y1;if(isNaN(n))c=(n=Math.floor(t))+1,u=(r=Math.floor(e))+1;else{for(var h=c-n||1,a=this._root,y,l;n>t||t>=c||r>e||e>=u;)switch(l=(e<r)<<1|t<n,y=new Array(4),y[l]=a,a=y,h*=2,l){case 0:c=n+h,u=r+h;break;case 1:n=c-h,u=r+h;break;case 2:c=n+h,r=u-h;break;case 3:n=c-h,r=u-h;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=c,this._y1=u,this}function Jt(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function te(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function G(t,e,n,r,c){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=c}function ee(t,e,n){var r,c=this._x0,u=this._y0,h,a,y,l,x=this._x1,A=this._y1,d=[],p=this._root,N,g;for(p&&d.push(new G(p,c,u,x,A)),n==null?n=1/0:(c=t-n,u=e-n,x=t+n,A=e+n,n*=n);N=d.pop();)if(!(!(p=N.node)||(h=N.x0)>x||(a=N.y0)>A||(y=N.x1)<c||(l=N.y1)<u))if(p.length){var f=(h+y)/2,s=(a+l)/2;d.push(new G(p[3],f,s,y,l),new G(p[2],h,s,f,l),new G(p[1],f,a,y,s),new G(p[0],h,a,f,s)),(g=(e>=s)<<1|t>=f)&&(N=d[d.length-1],d[d.length-1]=d[d.length-1-g],d[d.length-1-g]=N)}else{var _=t-+this._x.call(null,p.data),I=e-+this._y.call(null,p.data),o=_*_+I*I;if(o<n){var v=Math.sqrt(n=o);c=t-v,u=e-v,x=t+v,A=e+v,r=p.data}}return r}function ne(t){if(isNaN(x=+this._x.call(null,t))||isNaN(A=+this._y.call(null,t)))return this;var e,n=this._root,r,c,u,h=this._x0,a=this._y0,y=this._x1,l=this._y1,x,A,d,p,N,g,f,s;if(!n)return this;if(n.length)for(;;){if((N=x>=(d=(h+y)/2))?h=d:y=d,(g=A>=(p=(a+l)/2))?a=p:l=p,e=n,!(n=n[f=g<<1|N]))return this;if(!n.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(r=e,s=f)}for(;n.data!==t;)if(c=n,!(n=n.next))return this;return(u=n.next)&&delete n.next,c?(u?c.next=u:delete c.next,this):e?(u?e[f]=u:delete e[f],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[s]=n:this._root=n),this):(this._root=u,this)}function ie(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function re(){return this._root}function oe(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function ue(t){var e=[],n,r=this._root,c,u,h,a,y;for(r&&e.push(new G(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,u=n.x0,h=n.y0,a=n.x1,y=n.y1)&&r.length){var l=(u+a)/2,x=(h+y)/2;(c=r[3])&&e.push(new G(c,l,x,a,y)),(c=r[2])&&e.push(new G(c,u,x,l,y)),(c=r[1])&&e.push(new G(c,l,h,a,x)),(c=r[0])&&e.push(new G(c,u,h,l,x))}return this}function ae(t){var e=[],n=[],r;for(this._root&&e.push(new G(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var c=r.node;if(c.length){var u,h=r.x0,a=r.y0,y=r.x1,l=r.y1,x=(h+y)/2,A=(a+l)/2;(u=c[0])&&e.push(new G(u,h,a,x,A)),(u=c[1])&&e.push(new G(u,x,a,y,A)),(u=c[2])&&e.push(new G(u,h,A,x,l)),(u=c[3])&&e.push(new G(u,x,A,y,l))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function se(t){return t[0]}function ce(t){return arguments.length?(this._x=t,this):this._x}function he(t){return t[1]}function le(t){return arguments.length?(this._y=t,this):this._y}function lt(t,e,n){var r=new ft(e??se,n??he,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function ft(t,e,n,r,c,u){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=c,this._y1=u,this._root=void 0}function vt(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var X=lt.prototype=ft.prototype;X.copy=function(){var t=new ft(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=vt(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var c=0;c<4;++c)(r=e.source[c])&&(r.length?n.push({source:r,target:e.target[c]=new Array(4)}):e.target[c]=vt(r));return t};X.add=Wt;X.addAll=Zt;X.cover=qt;X.data=Jt;X.extent=te;X.find=ee;X.remove=ne;X.removeAll=ie;X.root=re;X.size=oe;X.visit=ue;X.visitAfter=ae;X.x=ce;X.y=le;function V(t){return function(){return t}}function Z(t){return(t()-.5)*1e-6}function fe(t){return t.x+t.vx}function ge(t){return t.y+t.vy}function me(t){var e,n,r,c=1,u=1;typeof t!="function"&&(t=V(t==null?1:+t));function h(){for(var l,x=e.length,A,d,p,N,g,f,s=0;s<u;++s)for(A=lt(e,fe,ge).visitAfter(a),l=0;l<x;++l)d=e[l],g=n[d.index],f=g*g,p=d.x+d.vx,N=d.y+d.vy,A.visit(_);function _(I,o,v,z,E){var D=I.data,B=I.r,L=g+B;if(D){if(D.index>d.index){var j=p-D.x-D.vx,k=N-D.y-D.vy,w=j*j+k*k;w<L*L&&(j===0&&(j=Z(r),w+=j*j),k===0&&(k=Z(r),w+=k*k),w=(L-(w=Math.sqrt(w)))/w*c,d.vx+=(j*=w)*(L=(B*=B)/(f+B)),d.vy+=(k*=w)*L,D.vx-=j*(L=1-L),D.vy-=k*L)}return}return o>p+L||z<p-L||v>N+L||E<N-L}}function a(l){if(l.data)return l.r=n[l.data.index];for(var x=l.r=0;x<4;++x)l[x]&&l[x].r>l.r&&(l.r=l[x].r)}function y(){if(e){var l,x=e.length,A;for(n=new Array(x),l=0;l<x;++l)A=e[l],n[A.index]=+t(A,l,e)}}return h.initialize=function(l,x){e=l,r=x,y()},h.iterations=function(l){return arguments.length?(u=+l,h):u},h.strength=function(l){return arguments.length?(c=+l,h):c},h.radius=function(l){return arguments.length?(t=typeof l=="function"?l:V(+l),y(),h):t},h}function pe(t){return t.index}function xt(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function de(t){var e=pe,n=A,r,c=V(30),u,h,a,y,l,x=1;t==null&&(t=[]);function A(f){return 1/Math.min(a[f.source.index],a[f.target.index])}function d(f){for(var s=0,_=t.length;s<x;++s)for(var I=0,o,v,z,E,D,B,L;I<_;++I)o=t[I],v=o.source,z=o.target,E=z.x+z.vx-v.x-v.vx||Z(l),D=z.y+z.vy-v.y-v.vy||Z(l),B=Math.sqrt(E*E+D*D),B=(B-u[I])/B*f*r[I],E*=B,D*=B,z.vx-=E*(L=y[I]),z.vy-=D*L,v.vx+=E*(L=1-L),v.vy+=D*L}function p(){if(h){var f,s=h.length,_=t.length,I=new Map(h.map((v,z)=>[e(v,z,h),v])),o;for(f=0,a=new Array(s);f<_;++f)o=t[f],o.index=f,typeof o.source!="object"&&(o.source=xt(I,o.source)),typeof o.target!="object"&&(o.target=xt(I,o.target)),a[o.source.index]=(a[o.source.index]||0)+1,a[o.target.index]=(a[o.target.index]||0)+1;for(f=0,y=new Array(_);f<_;++f)o=t[f],y[f]=a[o.source.index]/(a[o.source.index]+a[o.target.index]);r=new Array(_),N(),u=new Array(_),g()}}function N(){if(h)for(var f=0,s=t.length;f<s;++f)r[f]=+n(t[f],f,t)}function g(){if(h)for(var f=0,s=t.length;f<s;++f)u[f]=+c(t[f],f,t)}return d.initialize=function(f,s){h=f,l=s,p()},d.links=function(f){return arguments.length?(t=f,p(),d):t},d.id=function(f){return arguments.length?(e=f,d):e},d.iterations=function(f){return arguments.length?(x=+f,d):x},d.strength=function(f){return arguments.length?(n=typeof f=="function"?f:V(+f),N(),d):n},d.distance=function(f){return arguments.length?(c=typeof f=="function"?f:V(+f),g(),d):c},d}const ye=1664525,ve=1013904223,_t=4294967296;function xe(){let t=1;return()=>(t=(ye*t+ve)%_t)/_t}function _e(t){return t.x}function we(t){return t.y}var ze=10,Me=Math.PI*(3-Math.sqrt(5));function ke(t){var e,n=1,r=.001,c=1-Math.pow(r,1/300),u=0,h=.6,a=new Map,y=At(A),l=ht("tick","end"),x=xe();t==null&&(t=[]);function A(){d(),l.call("tick",e),n<r&&(y.stop(),l.call("end",e))}function d(g){var f,s=t.length,_;g===void 0&&(g=1);for(var I=0;I<g;++I)for(n+=(u-n)*c,a.forEach(function(o){o(n)}),f=0;f<s;++f)_=t[f],_.fx==null?_.x+=_.vx*=h:(_.x=_.fx,_.vx=0),_.fy==null?_.y+=_.vy*=h:(_.y=_.fy,_.vy=0);return e}function p(){for(var g=0,f=t.length,s;g<f;++g){if(s=t[g],s.index=g,s.fx!=null&&(s.x=s.fx),s.fy!=null&&(s.y=s.fy),isNaN(s.x)||isNaN(s.y)){var _=ze*Math.sqrt(.5+g),I=g*Me;s.x=_*Math.cos(I),s.y=_*Math.sin(I)}(isNaN(s.vx)||isNaN(s.vy))&&(s.vx=s.vy=0)}}function N(g){return g.initialize&&g.initialize(t,x),g}return p(),e={tick:d,restart:function(){return y.restart(A),e},stop:function(){return y.stop(),e},nodes:function(g){return arguments.length?(t=g,p(),a.forEach(N),e):t},alpha:function(g){return arguments.length?(n=+g,e):n},alphaMin:function(g){return arguments.length?(r=+g,e):r},alphaDecay:function(g){return arguments.length?(c=+g,e):+c},alphaTarget:function(g){return arguments.length?(u=+g,e):u},velocityDecay:function(g){return arguments.length?(h=1-g,e):1-h},randomSource:function(g){return arguments.length?(x=g,a.forEach(N),e):x},force:function(g,f){return arguments.length>1?(f==null?a.delete(g):a.set(g,N(f)),e):a.get(g)},find:function(g,f,s){var _=0,I=t.length,o,v,z,E,D;for(s==null?s=1/0:s*=s,_=0;_<I;++_)E=t[_],o=g-E.x,v=f-E.y,z=o*o+v*v,z<s&&(D=E,s=z);return D},on:function(g,f){return arguments.length>1?(l.on(g,f),e):l.on(g)}}}function Ne(){var t,e,n,r,c=V(-30),u,h=1,a=1/0,y=.81;function l(p){var N,g=t.length,f=lt(t,_e,we).visitAfter(A);for(r=p,N=0;N<g;++N)e=t[N],f.visit(d)}function x(){if(t){var p,N=t.length,g;for(u=new Array(N),p=0;p<N;++p)g=t[p],u[g.index]=+c(g,p,t)}}function A(p){var N=0,g,f,s=0,_,I,o;if(p.length){for(_=I=o=0;o<4;++o)(g=p[o])&&(f=Math.abs(g.value))&&(N+=g.value,s+=f,_+=f*g.x,I+=f*g.y);p.x=_/s,p.y=I/s}else{g=p,g.x=g.data.x,g.y=g.data.y;do N+=u[g.data.index];while(g=g.next)}p.value=N}function d(p,N,g,f){if(!p.value)return!0;var s=p.x-e.x,_=p.y-e.y,I=f-N,o=s*s+_*_;if(I*I/y<o)return o<a&&(s===0&&(s=Z(n),o+=s*s),_===0&&(_=Z(n),o+=_*_),o<h&&(o=Math.sqrt(h*o)),e.vx+=s*p.value*r/o,e.vy+=_*p.value*r/o),!0;if(p.length||o>=a)return;(p.data!==e||p.next)&&(s===0&&(s=Z(n),o+=s*s),_===0&&(_=Z(n),o+=_*_),o<h&&(o=Math.sqrt(h*o)));do p.data!==e&&(I=u[p.data.index]*r/o,e.vx+=s*I,e.vy+=_*I);while(p=p.next)}return l.initialize=function(p,N){t=p,n=N,x()},l.strength=function(p){return arguments.length?(c=typeof p=="function"?p:V(+p),x(),l):c},l.distanceMin=function(p){return arguments.length?(h=p*p,l):Math.sqrt(h)},l.distanceMax=function(p){return arguments.length?(a=p*p,l):Math.sqrt(a)},l.theta=function(p){return arguments.length?(y=p*p,l):Math.sqrt(y)},l}function Te(t){var e=V(.1),n,r,c;typeof t!="function"&&(t=V(t==null?0:+t));function u(a){for(var y=0,l=n.length,x;y<l;++y)x=n[y],x.vx+=(c[y]-x.x)*r[y]*a}function h(){if(n){var a,y=n.length;for(r=new Array(y),c=new Array(y),a=0;a<y;++a)r[a]=isNaN(c[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,h()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:V(+a),h(),u):e},u.x=function(a){return arguments.length?(t=typeof a=="function"?a:V(+a),h(),u):t},u}function Ae(t){var e=V(.1),n,r,c;typeof t!="function"&&(t=V(t==null?0:+t));function u(a){for(var y=0,l=n.length,x;y<l;++y)x=n[y],x.vy+=(c[y]-x.y)*r[y]*a}function h(){if(n){var a,y=n.length;for(r=new Array(y),c=new Array(y),a=0;a<y;++a)r[a]=isNaN(c[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return u.initialize=function(a){n=a,h()},u.strength=function(a){return arguments.length?(e=typeof a=="function"?a:V(+a),h(),u):e},u.y=function(a){return arguments.length?(t=typeof a=="function"?a:V(+a),h(),u):t},u}const nt=t=>()=>t;function Ie(t,{sourceEvent:e,target:n,transform:r,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:c}})}function st(t){t.stopImmediatePropagation()}function J(t){t.preventDefault(),t.stopImmediatePropagation()}function Ee(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Se(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function wt(){return this.__zoom||zt}function De(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ce(){return navigator.maxTouchPoints||"ontouchstart"in this}function $e(t,e,n){var r=t.invertX(e[0][0])-n[0][0],c=t.invertX(e[1][0])-n[1][0],u=t.invertY(e[0][1])-n[0][1],h=t.invertY(e[1][1])-n[1][1];return t.translate(c>r?(r+c)/2:Math.min(0,r)||Math.max(0,c),h>u?(u+h)/2:Math.min(0,u)||Math.max(0,h))}function Le(){var t=Ee,e=Se,n=$e,r=De,c=Ce,u=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],a=250,y=Ht,l=ht("start","zoom","end"),x,A,d,p=500,N=150,g=0,f=10;function s(i){i.property("__zoom",wt).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",B).on("dblclick.zoom",L).filter(c).on("touchstart.zoom",j).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",w).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}s.transform=function(i,M,m,T){var S=i.selection?i.selection():i;S.property("__zoom",wt),i!==S?v(i,M,m,T):S.interrupt().each(function(){z(this,arguments).event(T).start().zoom(null,typeof M=="function"?M.apply(this,arguments):M).end()})},s.scaleBy=function(i,M,m,T){s.scaleTo(i,function(){var S=this.__zoom.k,C=typeof M=="function"?M.apply(this,arguments):M;return S*C},m,T)},s.scaleTo=function(i,M,m,T){s.transform(i,function(){var S=e.apply(this,arguments),C=this.__zoom,$=m==null?o(S):typeof m=="function"?m.apply(this,arguments):m,R=C.invert($),b=typeof M=="function"?M.apply(this,arguments):M;return n(I(_(C,b),$,R),S,h)},m,T)},s.translateBy=function(i,M,m,T){s.transform(i,function(){return n(this.__zoom.translate(typeof M=="function"?M.apply(this,arguments):M,typeof m=="function"?m.apply(this,arguments):m),e.apply(this,arguments),h)},null,T)},s.translateTo=function(i,M,m,T,S){s.transform(i,function(){var C=e.apply(this,arguments),$=this.__zoom,R=T==null?o(C):typeof T=="function"?T.apply(this,arguments):T;return n(zt.translate(R[0],R[1]).scale($.k).translate(typeof M=="function"?-M.apply(this,arguments):-M,typeof m=="function"?-m.apply(this,arguments):-m),C,h)},T,S)};function _(i,M){return M=Math.max(u[0],Math.min(u[1],M)),M===i.k?i:new rt(M,i.x,i.y)}function I(i,M,m){var T=M[0]-m[0]*i.k,S=M[1]-m[1]*i.k;return T===i.x&&S===i.y?i:new rt(i.k,T,S)}function o(i){return[(+i[0][0]+ +i[1][0])/2,(+i[0][1]+ +i[1][1])/2]}function v(i,M,m,T){i.on("start.zoom",function(){z(this,arguments).event(T).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event(T).end()}).tween("zoom",function(){var S=this,C=arguments,$=z(S,C).event(T),R=e.apply(S,C),b=m==null?o(R):typeof m=="function"?m.apply(S,C):m,O=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),P=S.__zoom,U=typeof M=="function"?M.apply(S,C):M,Q=y(P.invert(b).concat(O/P.k),U.invert(b).concat(O/U.k));return function(F){if(F===1)F=U;else{var H=Q(F),it=O/H[2];F=new rt(it,b[0]-H[0]*it,b[1]-H[1]*it)}$.zoom(null,F)}})}function z(i,M,m){return!m&&i.__zooming||new E(i,M)}function E(i,M){this.that=i,this.args=M,this.active=0,this.sourceEvent=null,this.extent=e.apply(i,M),this.taps=0}E.prototype={event:function(i){return i&&(this.sourceEvent=i),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(i,M){return this.mouse&&i!=="mouse"&&(this.mouse[1]=M.invert(this.mouse[0])),this.touch0&&i!=="touch"&&(this.touch0[1]=M.invert(this.touch0[0])),this.touch1&&i!=="touch"&&(this.touch1[1]=M.invert(this.touch1[0])),this.that.__zoom=M,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(i){var M=Y(this.that).datum();l.call(i,this.that,new Ie(i,{sourceEvent:this.sourceEvent,target:s,type:i,transform:this.that.__zoom,dispatch:l}),M)}};function D(i,...M){if(!t.apply(this,arguments))return;var m=z(this,M).event(i),T=this.__zoom,S=Math.max(u[0],Math.min(u[1],T.k*Math.pow(2,r.apply(this,arguments)))),C=W(i);if(m.wheel)(m.mouse[0][0]!==C[0]||m.mouse[0][1]!==C[1])&&(m.mouse[1]=T.invert(m.mouse[0]=C)),clearTimeout(m.wheel);else{if(T.k===S)return;m.mouse=[C,T.invert(C)],ot(this),m.start()}J(i),m.wheel=setTimeout($,N),m.zoom("mouse",n(I(_(T,S),m.mouse[0],m.mouse[1]),m.extent,h));function $(){m.wheel=null,m.end()}}function B(i,...M){if(d||!t.apply(this,arguments))return;var m=i.currentTarget,T=z(this,M,!0).event(i),S=Y(i.view).on("mousemove.zoom",b,!0).on("mouseup.zoom",O,!0),C=W(i,m),$=i.clientX,R=i.clientY;Mt(i.view),st(i),T.mouse=[C,this.__zoom.invert(C)],ot(this),T.start();function b(P){if(J(P),!T.moved){var U=P.clientX-$,Q=P.clientY-R;T.moved=U*U+Q*Q>g}T.event(P).zoom("mouse",n(I(T.that.__zoom,T.mouse[0]=W(P,m),T.mouse[1]),T.extent,h))}function O(P){S.on("mousemove.zoom mouseup.zoom",null),kt(P.view,T.moved),J(P),T.event(P).end()}}function L(i,...M){if(t.apply(this,arguments)){var m=this.__zoom,T=W(i.changedTouches?i.changedTouches[0]:i,this),S=m.invert(T),C=m.k*(i.shiftKey?.5:2),$=n(I(_(m,C),T,S),e.apply(this,M),h);J(i),a>0?Y(this).transition().duration(a).call(v,$,T,i):Y(this).call(s.transform,$,T,i)}}function j(i,...M){if(t.apply(this,arguments)){var m=i.touches,T=m.length,S=z(this,M,i.changedTouches.length===T).event(i),C,$,R,b;for(st(i),$=0;$<T;++$)R=m[$],b=W(R,this),b=[b,this.__zoom.invert(b),R.identifier],S.touch0?!S.touch1&&S.touch0[2]!==b[2]&&(S.touch1=b,S.taps=0):(S.touch0=b,C=!0,S.taps=1+!!x);x&&(x=clearTimeout(x)),C&&(S.taps<2&&(A=b[0],x=setTimeout(function(){x=null},p)),ot(this),S.start())}}function k(i,...M){if(this.__zooming){var m=z(this,M).event(i),T=i.changedTouches,S=T.length,C,$,R,b;for(J(i),C=0;C<S;++C)$=T[C],R=W($,this),m.touch0&&m.touch0[2]===$.identifier?m.touch0[0]=R:m.touch1&&m.touch1[2]===$.identifier&&(m.touch1[0]=R);if($=m.that.__zoom,m.touch1){var O=m.touch0[0],P=m.touch0[1],U=m.touch1[0],Q=m.touch1[1],F=(F=U[0]-O[0])*F+(F=U[1]-O[1])*F,H=(H=Q[0]-P[0])*H+(H=Q[1]-P[1])*H;$=_($,Math.sqrt(F/H)),R=[(O[0]+U[0])/2,(O[1]+U[1])/2],b=[(P[0]+Q[0])/2,(P[1]+Q[1])/2]}else if(m.touch0)R=m.touch0[0],b=m.touch0[1];else return;m.zoom("touch",n(I($,R,b),m.extent,h))}}function w(i,...M){if(this.__zooming){var m=z(this,M).event(i),T=i.changedTouches,S=T.length,C,$;for(st(i),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),C=0;C<S;++C)$=T[C],m.touch0&&m.touch0[2]===$.identifier?delete m.touch0:m.touch1&&m.touch1[2]===$.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&($=W($,this),Math.hypot(A[0]-$[0],A[1]-$[1])<f)){var R=Y(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return s.wheelDelta=function(i){return arguments.length?(r=typeof i=="function"?i:nt(+i),s):r},s.filter=function(i){return arguments.length?(t=typeof i=="function"?i:nt(!!i),s):t},s.touchable=function(i){return arguments.length?(c=typeof i=="function"?i:nt(!!i),s):c},s.extent=function(i){return arguments.length?(e=typeof i=="function"?i:nt([[+i[0][0],+i[0][1]],[+i[1][0],+i[1][1]]]),s):e},s.scaleExtent=function(i){return arguments.length?(u[0]=+i[0],u[1]=+i[1],s):[u[0],u[1]]},s.translateExtent=function(i){return arguments.length?(h[0][0]=+i[0][0],h[1][0]=+i[1][0],h[0][1]=+i[0][1],h[1][1]=+i[1][1],s):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},s.constrain=function(i){return arguments.length?(n=i,s):n},s.duration=function(i){return arguments.length?(a=+i,s):a},s.interpolate=function(i){return arguments.length?(y=i,s):y},s.on=function(){var i=l.on.apply(l,arguments);return i===l?s:i},s.clickDistance=function(i){return arguments.length?(g=(i=+i)*i,s):Math.sqrt(g)},s.tapDistance=function(i){return arguments.length?(f=+i,s):f},s}class gt{constructor(e,n,r){this.linkContainer=e,this.stylesCallbacks=n,this.currDeph=0,this.outputIndex=0,this.all=[],this.instant=!0,this.init(r)}ticked(){this.sel.attr("x1",e=>{var n;return((n=e.source)==null?void 0:n.x)??0}).attr("y1",e=>{var n;return((n=e.source)==null?void 0:n.y)??0}).attr("x2",e=>{var n;return((n=e.target)==null?void 0:n.x)??0}).attr("y2",e=>{var n;return((n=e.target)==null?void 0:n.y)??0})}mouseover(e){this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.highlite(e)}mouseout(){this.reset()}init(e){this.sel=this.linkContainer.attr("stroke","#555").attr("stroke-width",1).selectAll("line").data(e).join("line"),this.createBackRefs()}createBackRefs(){this.sel.each(function(e){e.d3node=Y(this)})}highlite(e){this.reset(),this.all=[...new Set([...e.mainInputs,...e.mainOutputs])],this.outputIndex=e.mainInputs.size,this.instant?this.all.forEach(n=>this.styleSingle(n)):(this.all.forEach(n=>this.stylesCallbacks.defaultLink(n)),this.timeoutID=setInterval(this.nextStep,5))}reset(){this.currDeph=0,clearInterval(this.timeoutID)}nextStep(){var n;const e=(n=this.all)==null?void 0:n[this.currDeph];if(!e){clearInterval(this.timeoutID);return}this.styleSingle(e)}styleSingle(e){const n=+(this.currDeph>=this.outputIndex),r=this.stylesCallbacks[["inputLink","outputLink"][n]];r(e,this.currDeph),this.currDeph++}}class Be extends gt{constructor(...e){super(...e),this.init([])}mouseover(e){this.init([...e.mainInputs,...e.mainOutputs]),this.highlite(e)}mouseout(){}}class Re extends gt{ticked(){this.sel.attr("d",e=>{const n=Math.hypot(e.target.x??0-(e.source.x??0),e.target.y??0-(e.source.y??0));return`
        M${e.source.x},${e.source.y}
        A${n},${n} 0 0,1 ${e.target.x},${e.target.y}
        `})}init(e){this.sel=this.linkContainer.attr("fill","none").selectAll("path").data(e).join("path").attr("stroke-width",1).attr("stroke","#555"),this.createBackRefs()}}function je(t,e,n){var L,j;e.selectAll("*").remove();const r=e.append("g"),c=t.filter(k=>k.source!=="placeholder"),u=20,h=Math.floor(c.length/9),a=h-u,y=((L=e.node())==null?void 0:L.getBoundingClientRect().width)??400,l=((j=e.node())==null?void 0:j.getBoundingClientRect().height)??200,x=k=>{const w=c.map(m=>m[k]),i=Math.min(...w),M=Math.max(1,...w);return m=>(m-i)/M},A=x("complexity"),d=x("usability"),p=k=>k**.5,N=k=>p(p(k)),g=k=>p(A(k.complexity)),f=k=>p(d(k.usability)),s=k=>y/2+g(k)*a*20-f(k)*a*20,_=k=>{const w=(g(k)+f(k))/2*h+u,i=Math.max(u,Math.min(h,w));return isNaN(i)?10:i},I=r.append("g").selectAll("g").data(c).join(o,v);function o(k){return v(k.append("g").style("cursor",w=>w.isGhost?null:"pointer").attr("opacity",w=>w.isGhost?.1:null).call(w=>w.append("circle")).call(w=>w.append("image")))}function v(k){return k.select("circle").attr("r",_).attr("stroke-width",w=>f(w)*10+1).attr("stroke",w=>w.popularity>0?"#f90":"#fff").attr("fill",w=>w.inputsAmount===0?"rgba(67, 113, 165, 0.3)":w.outputsAmount===0?"rgba(0, 145, 7, 0.4)":"#111"),k.select("image").attr("x",w=>-_(w)*.9).attr("y",w=>-_(w)*.9).attr("height",w=>_(w)*2*.9).attr("width",w=>_(w)*2*.9).attr("xlink:href",w=>w.href).attr("image-rendering","pixelated"),k}I.each(function(k){k.d3node=Y(this)});const z=Le().scaleExtent([.01,10]).on("zoom",k=>{var w;r.attr("transform",k.transform),(w=n.zoom)==null||w.call(n,k)});e.call(z),I.on("click",(k,w)=>{var i;(i=n.click)==null||i.call(n,w,!1)}).on("contextmenu",(k,w)=>{var i;k.preventDefault(),(i=n.click)==null||i.call(n,w,!0)}).on("mouseover",(k,w)=>{var i;(i=n.mouseover)==null||i.call(n,w,k)}).on("mouseout",(k,w)=>{var i;return(i=n.mouseout)==null?void 0:i.call(n,w,k)}).call(Ft().on("start",E).on("drag",D).on("end",B));function E(k,w){var i;k.sourceEvent.stopPropagation(),k.active||(i=n.dragstarted)==null||i.call(n,w,k),w.fx=w.x,w.fy=w.y}function D(k,w){var i,M;(i=n.isGhost)!=null&&i.call(n,w,k)||((M=n.dragged)==null||M.call(n,w,k),w.fx=k.x,w.fy=k.y)}function B(k,w){var i;k.active||(i=n.dragended)==null||i.call(n,w,k),w.fx=null,w.fy=null}return{container:r,nodes:I,fNonlinear:p,fComp:g,fUsab:f,fX:s,fStroke:N,fSize:_,vizWidth:y,vizHeight:l,diffSize:a,graphNodes:c}}let K;function be(t,e,n={}){let r;const c={...n,dragstarted(v){var z;K==null||K.alphaTarget(.3).restart(),(z=n.dragstarted)==null||z.call(n,v)},dragended(v){var z;K==null||K.alphaTarget(0),(z=n.dragended)==null||z.call(n,v)},mouseover(v){var z;r.mouseover(v),r.ticked(),(z=n.mouseover)==null||z.call(n,v)},mouseout(v){var z;r.mouseout(),r.ticked(),(z=n.mouseout)==null||z.call(n,v)}},u=je(e,t,c),{fX:h,fSize:a,fUsab:y,vizHeight:l,diffSize:x,fStroke:A,graphNodes:d}=u,p=u.container.insert("g",":first-child").attr("class","linksLayer");K==null||K.on("tick",null).stop();const N={showLinks:d.length<500,showCurvedLinks:d.length<100,useReuse:d.length>500},g=[],f=v=>d.includes(v.source)&&d.includes(v.target)&&g.push(v);for(const v of d)v.mainInputs.forEach(f);K=ke(d).force("charge",Ne().strength(-2e3)).force("x",Te(h).strength(1)).force("y",Ae(l/2).strength(v=>y(v)+1)).force("collision",me().radius(a).strength(.75)).force("link",de(g).distance(x/2).strength(1)).on("tick",o);function s(v,z,E){var D;(D=v.d3node)==null||D.attr("stroke-width",A(E)*3/(z+1)+1)}const _={defaultLink:v=>{var z;(z=v.d3node)==null||z.attr("stroke-width",1).attr("stroke","#555")},inputLink:(v,z)=>{var E;s(v,z,v.weight),(E=v.d3node)==null||E.attr("stroke","#7f7")},outputLink:(v,z)=>{var E;s(v,z,1/v.weight),(E=v.d3node)==null||E.attr("stroke","#38f")}},I=N.showLinks?N.showCurvedLinks?Re:gt:Be;r=new I(p,_,g);function o(){r==null||r.ticked(),u.nodes.attr("transform",v=>`translate(${v.x},${v.y})`)}o()}const Pe={class:"relative"},Ge={key:0,class:"fixed"},Ve=Rt("svg",{id:"viz",class:"w-full h-full"},null,-1),Fe=It({__name:"graph",setup(t){const e=Et(),n=St(e).pickedItems;let r=Dt();Ct(c),$t(n,c);function c(){n.value&&be(Y("#viz"),n.value,{mouseover:u=>r.value=u,click:(u,h)=>h?e.pileFrom(u):e.pileTo(u)})}return(u,h)=>{var l,x;const a=bt,y=jt;return ut(),pt("div",Pe,[r.value?(ut(),pt("div",Ge,[Lt(a,{item:r.value},null,8,["item"]),(x=(l=r.value)==null?void 0:l.bestRecipe())!=null&&x[0]?(ut(),Bt(y,{key:0,recipes:[r.value.bestRecipe()[0]]},null,8,["recipes"])):dt("",!0)])):dt("",!0),Ve])}}});export{Fe as default};
