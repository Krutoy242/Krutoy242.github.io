import{_ as an}from"./ItemDetailed-9d538e2b.js";import{a9 as un,aa as L,ab as G,ac as V,ad as sn,ae as cn,af as ln,V as Z,_ as b,a0 as z,ag as fn,a1 as B,ah as mn,ai as hn,aj as pn,ak as dn,al as gn,o as A,c as C,a as R,t as vn,am as q,X as N,an as nn,ao as Mn,W as _n,F as T,f as X,e as O}from"./index-60b93b6e.js";import"./GearedNumber-b026ee84.js";function E(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function wn(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function en(n){let e,o,t;n.length!==2?(e=E,o=(i,s)=>E(n(i),s),t=(i,s)=>n(i)-s):(e=n===E||n===wn?n:yn,o=n,t=n);function r(i,s,l=0,m=i.length){if(l<m){if(e(s,s)!==0)return m;do{const f=l+m>>>1;o(i[f],s)<0?l=f+1:m=f}while(l<m)}return l}function a(i,s,l=0,m=i.length){if(l<m){if(e(s,s)!==0)return m;do{const f=l+m>>>1;o(i[f],s)<=0?l=f+1:m=f}while(l<m)}return l}function u(i,s,l=0,m=i.length){const f=r(i,s,l,m-1);return f>l&&t(i[f-1],s)>-t(i[f],s)?f-1:f}return{left:r,center:u,right:a}}function yn(){return 0}function kn(n){return n===null?NaN:+n}const Nn=en(E),$n=Nn.right;en(kn).center;const An=$n;var U=Math.sqrt(50),H=Math.sqrt(10),P=Math.sqrt(2);function W(n,e,o){var t,r=-1,a,u,i;if(e=+e,n=+n,o=+o,n===e&&o>0)return[n];if((t=e<n)&&(a=n,n=e,e=a),(i=xn(n,e,o))===0||!isFinite(i))return[];if(i>0){let s=Math.round(n/i),l=Math.round(e/i);for(s*i<n&&++s,l*i>e&&--l,u=new Array(a=l-s+1);++r<a;)u[r]=(s+r)*i}else{i=-i;let s=Math.round(n*i),l=Math.round(e*i);for(s/i<n&&++s,l/i>e&&--l,u=new Array(a=l-s+1);++r<a;)u[r]=(s+r)/i}return t&&u.reverse(),u}function xn(n,e,o){var t=(e-n)/Math.max(0,o),r=Math.floor(Math.log(t)/Math.LN10),a=t/Math.pow(10,r);return r>=0?(a>=U?10:a>=H?5:a>=P?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=U?10:a>=H?5:a>=P?2:1)}function Bn(n,e){e||(e=[]);var o=n?Math.min(e.length,n.length):0,t=e.slice(),r;return function(a){for(r=0;r<o;++r)t[r]=n[r]*(1-a)+e[r]*a;return t}}function Rn(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Sn(n,e){var o=e?e.length:0,t=n?Math.min(o,n.length):0,r=new Array(t),a=new Array(o),u;for(u=0;u<t;++u)r[u]=F(n[u],e[u]);for(;u<o;++u)a[u]=e[u];return function(i){for(u=0;u<t;++u)a[u]=r[u](i);return a}}function Cn(n,e){var o=new Date;return n=+n,e=+e,function(t){return o.setTime(n*(1-t)+e*t),o}}function En(n,e){var o={},t={},r;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in n?o[r]=F(n[r],e[r]):t[r]=e[r];return function(a){for(r in o)t[r]=o[r](a);return t}}function F(n,e){var o=typeof e,t;return e==null||o==="boolean"?un(e):(o==="number"?L:o==="string"?(t=G(e))?(e=t,V):sn:e instanceof G?V:e instanceof Date?Cn:Rn(e)?Bn:Array.isArray(e)?Sn:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?En:L)(n,e)}function In(n,e){return n=+n,e=+e,function(o){return Math.round(n*(1-o)+e*o)}}function Ln(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function zn(n){return function(){return n}}function jn(n){return+n}var J=[0,1];function S(n){return n}function j(n,e){return(e-=n=+n)?function(o){return(o-n)/e}:zn(isNaN(e)?NaN:.5)}function Fn(n,e){var o;return n>e&&(o=n,n=e,e=o),function(t){return Math.max(n,Math.min(e,t))}}function Dn(n,e,o){var t=n[0],r=n[1],a=e[0],u=e[1];return r<t?(t=j(r,t),a=o(u,a)):(t=j(t,r),a=o(a,u)),function(i){return a(t(i))}}function Gn(n,e,o){var t=Math.min(n.length,e.length)-1,r=new Array(t),a=new Array(t),u=-1;for(n[t]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++u<t;)r[u]=j(n[u],n[u+1]),a[u]=o(e[u],e[u+1]);return function(i){var s=An(n,i,1,t)-1;return a[s](r[s](i))}}function Vn(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function qn(){var n=J,e=J,o=F,t,r,a,u=S,i,s,l;function m(){var c=Math.min(n.length,e.length);return u!==S&&(u=Fn(n[0],n[c-1])),i=c>2?Gn:Dn,s=l=null,f}function f(c){return c==null||isNaN(c=+c)?a:(s||(s=i(n.map(t),e,o)))(t(u(c)))}return f.invert=function(c){return u(r((l||(l=i(e,n.map(t),L)))(c)))},f.domain=function(c){return arguments.length?(n=Array.from(c,jn),m()):n.slice()},f.range=function(c){return arguments.length?(e=Array.from(c),m()):e.slice()},f.rangeRound=function(c){return e=Array.from(c),o=In,m()},f.clamp=function(c){return arguments.length?(u=c?!0:S,m()):u!==S},f.interpolate=function(c){return arguments.length?(o=c,m()):o},f.unknown=function(c){return arguments.length?(a=c,f):a},function(c,v){return t=c,r=v,m()}}function Tn(n,e){n=n.slice();var o=0,t=n.length-1,r=n[o],a=n[t],u;return a<r&&(u=o,o=t,t=u,u=r,r=a,a=u),n[o]=e.floor(r),n[t]=e.ceil(a),n}function K(n){return Math.log(n)}function Q(n){return Math.exp(n)}function Xn(n){return-Math.log(-n)}function On(n){return-Math.exp(-n)}function Un(n){return isFinite(n)?+("1e"+n):n<0?0:n}function Hn(n){return n===10?Un:n===Math.E?Math.exp:e=>Math.pow(n,e)}function Pn(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function Y(n){return(e,o)=>-n(-e,o)}function Wn(n){const e=n(K,Q),o=e.domain;let t=10,r,a;function u(){return r=Pn(t),a=Hn(t),o()[0]<0?(r=Y(r),a=Y(a),n(Xn,On)):n(K,Q),e}return e.base=function(i){return arguments.length?(t=+i,u()):t},e.domain=function(i){return arguments.length?(o(i),u()):o()},e.ticks=i=>{const s=o();let l=s[0],m=s[s.length-1];const f=m<l;f&&([l,m]=[m,l]);let c=r(l),v=r(m),g,M;const $=i==null?10:+i;let w=[];if(!(t%1)&&v-c<$){if(c=Math.floor(c),v=Math.ceil(v),l>0){for(;c<=v;++c)for(g=1;g<t;++g)if(M=c<0?g/a(-c):g*a(c),!(M<l)){if(M>m)break;w.push(M)}}else for(;c<=v;++c)for(g=t-1;g>=1;--g)if(M=c>0?g/a(-c):g*a(c),!(M<l)){if(M>m)break;w.push(M)}w.length*2<$&&(w=W(l,m,$))}else w=W(c,v,Math.min(v-c,$)).map(a);return f?w.reverse():w},e.tickFormat=(i,s)=>{if(i==null&&(i=10),s==null&&(s=t===10?"s":","),typeof s!="function"&&(!(t%1)&&(s=cn(s)).precision==null&&(s.trim=!0),s=ln(s)),i===1/0)return s;const l=Math.max(1,t*i/e.ticks().length);return m=>{let f=m/a(Math.round(r(m)));return f*t<t-.5&&(f*=t),f<=l?s(m):""}},e.nice=()=>o(Tn(o(),{floor:i=>a(Math.floor(r(i))),ceil:i=>a(Math.ceil(r(i)))})),e}function tn(){const n=Wn(qn()).domain([1,10]);return n.copy=()=>Vn(n,tn()).base(n.base()),Ln.apply(n,arguments),n}const Jn=["color"],Kn={class:"absolute"},Qn=Z({__name:"ModBar",props:{name:{},items:{},offset:{}},emits:["showitems","selectrecipes"],setup(n,{emit:e}){const o=n,{selectRecipes:t}=b(),r=z(()=>v(o.items)),a=z(()=>fn(o.name)),u=B(),i=B();let s=B(),l=B();const f=tn().domain([.1,1e3]).range([0,1e3]).base(2),c=h=>f(Math.max(0,h)+.1);function v(h){const p=h.map(k=>k.complexity),d=c(Math.min(...p)),_=c(Math.max(...p))-d,y=h.map(k=>({item:k,pos:c(k.complexity)-d,width:Math.max(3,c(k.usability)/50),hue:1/(1+Math.log(k.popularity+1))}));return{from:d-c(o.offset),width:Math.max(100,_),items:y}}mn(()=>{hn(()=>{var p;const h=(p=i.value)==null?void 0:p.getContext("2d");h&&(u.value=h),g(),window.addEventListener("resize",g)})}),pn(()=>window.removeEventListener("resize",g)),dn(()=>g());function g(){var d,_;const h=i.value;if(!h)return;const p=(_=(d=h==null?void 0:h.parentNode)==null?void 0:d.parentNode)==null?void 0:_.getBoundingClientRect();h.width=p.width-2,h.height=p.height-2,M()}function M(){var p;const h=((p=i.value)==null?void 0:p.height)??1;r.value.items.forEach(async d=>{if(!u.value)return;const _=d.pos-d.width|0,y=d.pos+d.width|0,x=u.value.createLinearGradient(_,0,y,0);$(x,d),u.value.globalCompositeOperation="screen",u.value.fillStyle=x,u.value.fillRect(_,0,y-_,h)})}function $(h,p){let d=0;const _=.1,y=1,x=1,k=.25,I=`hsla(${44*p.hue%255}, ${100*x|0}%, ${100*k|0}%,`;for(h.addColorStop(.5,`${I} ${1*y})`);d<.5;){const D=(d*2)**.3/2;h.addColorStop(D,`${I} ${d*2*y})`),h.addColorStop(1-D,`${I} ${d*2*y})`),d+=_}}function w(h){return r.value?nn(r.value.items).map(p=>[Math.abs(h-p.pos),p]).sortBy(0).filter(([p,d])=>p<d.width).map(([,p])=>p.item).slice(0,10).value():[]}gn(s,()=>e("showitems",s.value));function rn(h){s.value=w(h.offsetX),l.value=s.value.map(p=>p.mainRecipe).filter(p=>!!p)}function on(h){l.value.length&&t(l.value)}return(h,p)=>{var d;return A(),C("div",{style:q({"margin-left":`${N(r).from}px`,width:`${N(r).width}px`,cursor:`${(d=l.value)!=null&&d.length?"pointer":"default"}`}),color:`hsla(${N(a)}, 60%, 40%, 0.1)`,class:"bar border-1 border-round-sm border-primary-900",onMousemove:rn,onClick:on},[R("div",Kn,[R("canvas",{ref_key:"canvas",ref:i},null,512)]),R("span",{style:q({color:`hsl(${N(a)}, 60%, 40%)`}),class:"mx-2"},vn(h.name),5)],44,Jn)}}});const Yn=Mn(Qn,[["__scopeId","data-v-d143a76a"]]),Zn={class:"m-0 relative"},bn={class:"absolute"},ne={class:"fixed"},oe=Z({__name:"history",setup(n){const e=b().pickedItems,o=z(()=>e?u(e):void 0),t=_n(0),r=B(),a=["placeholder"];function u(i){let s=Number.MAX_SAFE_INTEGER;const l=nn(i).groupBy("source").entries().filter(([m])=>!a.includes(m)).sortBy(([,m])=>{const f=Math.min(...m.map(c=>c.complexity));return s=Math.min(s,f),f}).value();return t.value=s,l}return(i,s)=>{const l=Yn,m=an;return A(),C("div",Zn,[R("div",bn,[(A(!0),C(T,null,X(N(o),([f,c],v)=>(A(),O(l,{key:v,name:f,items:c,offset:N(t),onShowitems:g=>r.value=g},null,8,["name","items","offset","onShowitems"]))),128))]),R("div",ne,[(A(!0),C(T,null,X(N(r),f=>(A(),O(m,{key:f.id,item:f},null,8,["item"]))),128))])])}}});export{oe as default};
